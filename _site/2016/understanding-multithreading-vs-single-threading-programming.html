<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title> Understanding multithreading vs single threading programming · heiswayi nrird •••</title><meta name="description" content=" Full example code for Windows Console application to demonstrate the multithreading programming in .NET C#. "/><meta name="keywords" content="multithreading, single threading, sample source code, demonstration, threadpool, task, backgroundworker, windows console application"><meta name="author" content="Heiswayi Nrird"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:type" content="article"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="multithreading, single threading, sample source code, demonstration, threadpool, task, backgroundworker, windows console application"><meta property="article:published_time" content="2016-05-05 00:00:00 +0800"><meta property="og:url" content="https://heiswayi.nrird.com/2016/understanding-multithreading-vs-single-threading-programming"><meta property="og:title" content=" Understanding multithreading vs single threading programming · heiswayi nrird ••• "><meta property="og:image" content="https://heiswayi.nrird.com/assets/logo.png"><meta property="og:description" content=" Full example code for Windows Console application to demonstrate the multithreading programming in .NET C#. "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:title" content=" Understanding multithreading vs single threading programming · heiswayi nrird ••• "><meta name="twitter:description" content=" Full example code for Windows Console application to demonstrate the multithreading programming in .NET C#. "><meta name="twitter:image:src" content="https://heiswayi.nrird.com/assets/logo.png"><meta itemprop="name" content=" Understanding multithreading vs single threading programming · heiswayi nrird ••• "><meta itemprop="description" content=" Full example code for Windows Console application to demonstrate the multithreading programming in .NET C#. "><meta itemprop="image" content="https://heiswayi.nrird.com/assets/logo.png"><link rel="canonical" href="https://heiswayi.nrird.com/2016/understanding-multithreading-vs-single-threading-programming"><link rel="alternate" type="application/rss+xml" title="RSS" href="https://heiswayi.nrird.com/feed.xml"><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="><link rel="stylesheet" href="https://heiswayi.nrird.com/assets/css/main.css?20180603"> <script src="https://heiswayi.nrird.com/assets/js/modernizr.custom.js"></script> <!--[if lt IE 9]> <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script> <script src="https://heiswayi.nrird.com/assets/js/rem.min.js"></script> <![endif]--> <a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"> <canvas id="canvas" style="width:100%;height:100%;max-height:230px;position:absolute;z-index:1;opacity:0.5"></canvas><div class="container"><h2 class="masthead-title"> <a href="https://heiswayi.nrird.com" title="heiswayi nrird •••" class="title">heiswayi nrird <span class="dot-red">•</span><span class="dot-yellow">•</span><span class="dot-green">•</span></a> <small>Between coding and random stuffs </small></h2><div class="footer-social-links"> <a href="http://heiswayi.github.io/feed.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a> <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a> <!--<a href="https://www.facebook.com/heiswayi.nrird" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>--> <!--<a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>--> <a href="http://heiswayi.github.io/my-repos/" title="GitHub Repositories" target="_blank"><i class="fa fa-github-alt"></i></a> <a href="http://heiswayi.github.io/my-gists/" title="GitHub Gists" target="_blank"><i class="fa fa-code"></i></a> <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a> <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a> <a href="http://jsfiddle.net/user/heiswayi/" title="JSFiddle" target="_blank"><i class="fa fa-jsfiddle"></i></a></div><div class="nav"><ul class="top-menu"><li><a href="https://heiswayi.nrird.com/" title="Home"><i class="fa fa-home"></i></a><li><a href="https://heiswayi.nrird.com/about">About</a> <!--<li><a href="/resume">Resume <i class="fa fa-external-link-square"></i></a>--><li><a href="https://heiswayi.nrird.com/projects" class="bg-red"><i class="fa fa-space-shuttle" aria-hidden="true"></i> Projects</a><li><a href="https://heiswayi.nrird.com/tagged">Tags</a><li><a href="https://heiswayi.github.io/photography">Photography <i class="fa fa-external-link-square"></i></a><li><a href="https://heiswayi.nrird.com/reminder">Reminder</a></ul></div></div></div><div id="content" class="container content"><div class="post"><div class="post-top-meta"> <!--<div class="edit-this-page"><a href="https://github.com/heiswayi/heiswayi.github.io/blob/master/_posts/2016/2016-05-05-understanding-multithreading-vs-single-threading-programming.md">Edit this page</a></div>--><div class="post-date">May 05, 2016</div><h1 class="post-title">Understanding multithreading vs single threading programming</h1></div><p>Multithreading is a widespread programming and execution model that allows multiple threads to exist within the context of one process. They share the process’s resources, but they are able to execute independently while the single threading is the processing of one command at a time.<p>The purpose of threading is to allow computer to do more than one thing at a time. In a single core computer, multithreading won’t give much advantages for overall speed. But for computer with multiple processor cores (which is so common these days), multithreading can take advantage of additional cores to perform separate instructions at the same time or by splitting the tasks between the cores.<p>Below is the full example source code of Windows Console application written in C# that will demonstrate multithreading programming versus single threading programming. You may copy and paste the source code into your Visual Studio to have a try. The demonstration covers four multithreading options; <code class="highlighter-rouge">Thread()</code>, <code class="highlighter-rouge">ThreadPool.QueueUserWorkItem()</code>, <code class="highlighter-rouge">Task()</code> and <code class="highlighter-rouge">BackgroundWorker()</code>.<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MultithreadingVsSingleThreading</span>
<span class="p">{</span>
    <span class="k">internal</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">Fields</span>

        <span class="k">private</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">selectedMode</span><span class="p">;</span>

        <span class="c1">// The number of threads to be spawned.</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">threadCount</span> <span class="p">=</span> <span class="m">1000</span><span class="p">;</span>

        <span class="c1">// The total number of spins the actual work is carried out repeatedly.</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">totalCount</span> <span class="p">=</span> <span class="m">100000</span><span class="p">;</span>

        <span class="err">#</span><span class="n">endregion</span> <span class="n">Fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">Methods</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Title</span> <span class="p">=</span> <span class="s">"Multithreading vs Single Threading Example"</span><span class="p">;</span>
            <span class="n">start</span><span class="p">:</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Select which mode to run:-"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"  (1) Multithreading"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"  (2) Single Threading"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"  (3) Threadpool"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"  (4) Task"</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"  (5) BackgroundWorker"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">input</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
                <span class="k">goto</span> <span class="n">start</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">||</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="p">&gt;=</span> <span class="m">6</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
                <span class="k">goto</span> <span class="n">start</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">selectedMode</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Thread</span><span class="p">.</span><span class="n">CurrentThread</span><span class="p">.</span><span class="n">Priority</span> <span class="p">=</span> <span class="n">ThreadPriority</span><span class="p">.</span><span class="n">Highest</span><span class="p">;</span>
            <span class="n">Stopwatch</span> <span class="n">watch</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Stopwatch</span><span class="p">();</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
            <span class="n">watch</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

            <span class="k">try</span>
            <span class="p">{</span>
                <span class="nf">HandleMode</span><span class="p">(</span><span class="n">selectedMode</span><span class="p">);</span>

                <span class="n">watch</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Work complete!"</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Time elapsed: {0}"</span><span class="p">,</span> <span class="n">watch</span><span class="p">.</span><span class="n">Elapsed</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">NewLine</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">ForegroundColor</span> <span class="p">=</span> <span class="n">ConsoleColor</span><span class="p">.</span><span class="n">Red</span><span class="p">;</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Press Enter key to test again or Esc to quit"</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">ResetColor</span><span class="p">();</span>
                <span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">Key</span> <span class="p">==</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Enter</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
                    <span class="k">goto</span> <span class="n">start</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">Key</span> <span class="p">==</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Escape</span><span class="p">)</span> <span class="n">Environment</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Performs the task based on user defined option.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="mode"&gt;&lt;/param&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">HandleMode</span><span class="p">(</span><span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="m">1</span><span class="p">:</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Using Thread() | No. of threads = {0}"</span><span class="p">,</span> <span class="n">threadCount</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Initialize work..."</span><span class="p">);</span>
                    <span class="nf">RunThreadMode</span><span class="p">();</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">2</span><span class="p">:</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Using this Main() thread, directly call ComplexWork({0})"</span><span class="p">,</span> <span class="n">totalCount</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Initialize work..."</span><span class="p">);</span>
                    <span class="nf">ComplexWork</span><span class="p">(</span><span class="n">totalCount</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">3</span><span class="p">:</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Using ThreadPool.QueueUserWorkItem() | No. of threads = {0}"</span><span class="p">,</span> <span class="n">threadCount</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Initialize work..."</span><span class="p">);</span>
                    <span class="nf">RunInThreadPool</span><span class="p">();</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">4</span><span class="p">:</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Using Task() | No. of threads = {0}"</span><span class="p">,</span> <span class="n">threadCount</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Initialize work..."</span><span class="p">);</span>
                    <span class="nf">RunTaskMode</span><span class="p">();</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="m">5</span><span class="p">:</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Using BackgroundWorker() | No. of threads = {0}"</span><span class="p">,</span> <span class="n">threadCount</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Initialize work..."</span><span class="p">);</span>
                    <span class="nf">RunInBackgroundWorker</span><span class="p">();</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">Work</span> <span class="n">Task</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Performs CPU intensive task.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="n"&gt;&lt;/param&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ComplexWork</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="nf">Fac</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Calculates the factorial of a number.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="n"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="kt">double</span> <span class="nf">Fac</span><span class="p">(</span><span class="kt">double</span> <span class="n">n</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="p">&gt;</span> <span class="m">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">n</span> <span class="p">*</span> <span class="nf">Fac</span><span class="p">(</span><span class="n">n</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="m">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">endregion</span> <span class="n">Work</span> <span class="n">Task</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Spawns new threads based on the thread count and starts the activity.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunThreadMode</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Thread</span><span class="p">[]</span> <span class="n">t</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="p">[</span><span class="n">threadCount</span><span class="p">];</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">threadCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Thread</span><span class="p">(()</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="nf">ComplexWork</span><span class="p">(</span><span class="n">totalCount</span> <span class="p">/</span> <span class="n">threadCount</span><span class="p">);</span>
                <span class="p">});</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Priority</span> <span class="p">=</span> <span class="n">ThreadPriority</span><span class="p">.</span><span class="n">Highest</span><span class="p">;</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">Start</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="c1">// Waits for all the threads to finish.</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ct</span> <span class="k">in</span> <span class="n">t</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ct</span><span class="p">.</span><span class="nf">Join</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Executes the task in a thread pooling context.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunInThreadPool</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">CountdownEvent</span> <span class="n">signaler</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CountdownEvent</span><span class="p">(</span><span class="n">threadCount</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">threadCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">ThreadPool</span><span class="p">.</span><span class="nf">QueueUserWorkItem</span><span class="p">((</span><span class="n">x</span><span class="p">)</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                        <span class="nf">ComplexWork</span><span class="p">(</span><span class="n">totalCount</span> <span class="p">/</span> <span class="n">threadCount</span><span class="p">);</span>
                        <span class="n">signaler</span><span class="p">.</span><span class="nf">Signal</span><span class="p">();</span>
                    <span class="p">});</span>
                <span class="p">}</span>
                <span class="n">signaler</span><span class="p">.</span><span class="nf">Wait</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Creates a new task based on the TPL library.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunTaskMode</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Task</span><span class="p">[]</span> <span class="n">taskList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Task</span><span class="p">[</span><span class="n">threadCount</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">threadCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">taskList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Task</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="nf">ComplexWork</span><span class="p">(</span><span class="n">totalCount</span> <span class="p">/</span> <span class="n">threadCount</span><span class="p">);</span>
                <span class="p">}));</span>
                <span class="n">taskList</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">Start</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">Task</span><span class="p">.</span><span class="nf">WaitAll</span><span class="p">(</span><span class="n">taskList</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Starts BackgroundWorker to perform the same action.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RunInBackgroundWorker</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">BackgroundWorker</span><span class="p">[]</span> <span class="n">backgroundWorkerList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BackgroundWorker</span><span class="p">[</span><span class="n">threadCount</span><span class="p">];</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">CountdownEvent</span> <span class="n">signaler</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CountdownEvent</span><span class="p">(</span><span class="n">threadCount</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">threadCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">backgroundWorkerList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BackgroundWorker</span><span class="p">();</span>
                    <span class="n">backgroundWorkerList</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">DoWork</span> <span class="p">+=</span> <span class="k">delegate</span> <span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DoWorkEventArgs</span> <span class="n">e</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="nf">ComplexWork</span><span class="p">(</span><span class="n">totalCount</span> <span class="p">/</span> <span class="n">threadCount</span><span class="p">);</span>
                        <span class="n">signaler</span><span class="p">.</span><span class="nf">Signal</span><span class="p">();</span>
                    <span class="p">};</span>
                    <span class="n">backgroundWorkerList</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">RunWorkerAsync</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="n">signaler</span><span class="p">.</span><span class="nf">Wait</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">endregion</span> <span class="n">Methods</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="screenshots">Screenshots</h3><p><img src="http://i.imgur.com/q19Eigj.png" alt="Multithreading vs Single Threading Example #1" /><p><em>Figure 1 (above): Showing few options of multithreadings.</em><p><img src="http://i.imgur.com/3YQTqCA.png" alt="Multithreading vs Single Threading Example #2" /><p><em>Figure 2 (above): Example of multithreading using <code class="highlighter-rouge">ThreadPool.QueueUserWorkItem()</code>.</em><h3 id="notes-on-multithreading-classes">Notes on multithreading classes</h3><ul><li>The <code class="highlighter-rouge">Thread</code> class is used for creating and manipulating a <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms684841%28v=vs.85%29.aspx">thread</a> in Windows.<li>A <code class="highlighter-rouge">Task</code> represents asynchronous operation and is part of the <a href="http://msdn.microsoft.com/en-us/library/dd460717%28v=vs.110%29.aspx">Task Parallel Library</a>, a set of APIs for running tasks asynchronously and in parallel.<li>The <code class="highlighter-rouge">ThreadPool</code> class manages a group of threads in which tasks are added to a queue and automatically started when threads are created.<li>The <code class="highlighter-rouge">BackgroundWorker</code> class executes an operation on a separate thread.</ul><h3 id="demonstration-results-based-on-my-pc">Demonstration results based on my PC</h3><p>Please note that, while I’m running this demonstration, my PC has several stuffs that are running such as multiple Google Chrome browser tabs left opened, 2 instances of Visual Studio 2015 software, Atom editor, etc.<p><strong>Computer info:</strong><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Processor: Intel(R) Core(TM) i3-4130 CPU @ 3.40GHz (2 cores, 4 threads)
RAM: 12 GB DDR3
GPU: AMD Radeon R7 200 Series
</code></pre></div></div><p><strong>Demonstration results:</strong><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Multithreading
Using Thread() | No. of threads = 1000
Initialize work...
Work complete!
Time elapsed: 00:00:01.6529574

// Single Threading
Using this Main() thread, directly call ComplexWork(100000)
Initialize work...
Work complete!
Time elapsed: 00:00:04.6129301

// ThreadPool
Using ThreadPool.QueueUserWorkItem() | No. of threads = 1000
Initialize work...
Work complete!
Time elapsed: 00:00:01.6173233

// Task
Using Task() | No. of threads = 1000
Initialize work...
Work complete!
Time elapsed: 00:00:01.6230018

// BackgroundWorker
Using BackgroundWorker() | No. of threads = 1000
Initialize work...
Work complete!
Time elapsed: 00:00:01.6416939
</code></pre></div></div><p>Based on the results above (using my PC), multithreading programming provides about <strong>4x faster</strong> compared to single threading.<div class="tagged"> <a href="https://heiswayi.nrird.com/tagged#csharp"><i class="fa fa-hashtag muted" aria-hidden="true"></i>CSharp</a> <a href="https://heiswayi.nrird.com/tagged#multithreading"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Multithreading</a> <a href="https://heiswayi.nrird.com/tagged#console-application"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Console Application</a></div><div id="disqus" style="margin-top:2em"><div id="disqus_thread"></div><script> var disqus_config = function() { this.page.url = "https://heiswayi.nrird.com/2016/understanding-multithreading-vs-single-threading-programming"; this.page.identifier = "/2016/understanding-multithreading-vs-single-threading-programming"; }; (function() { var d = document, s = d.createElement('script'); s.src = '//hnbloggithub.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="footer"><div class="copyright"><i class="fa fa-copyright"></i> 2015 - 2018 Heiswayi Nrird // <a href="https://heiswayi.nrird.com/cookie-policy">Cookie Policy</a> // <a href="https://heiswayi.github.io/feed.xml">RSS</a></div></div><script> // Line numbering for code block (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-58296043-7', 'auto'); ga('send', 'pageview'); </script>
