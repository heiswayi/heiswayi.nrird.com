<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title> PHP - Encryption, Decryption and Password Hashing · heiswayi nrird •••</title><meta name="description" content=" If you need custom PHP function to secure your confidential information or to hash user password in unbreakable manner, these PHP code snippets may help and ... "/><meta name="keywords" content="php encryption function, php decryption function, secure password hashing using php"><meta name="author" content="Heiswayi Nrird"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:type" content="article"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="php encryption function, php decryption function, secure password hashing using php"><meta property="article:published_time" content="2015-08-17 00:00:00 +0800"><meta property="og:url" content="https://heiswayi.nrird.com/2015/php-encryption-decryption-and-password-hashing"><meta property="og:title" content=" PHP - Encryption, Decryption and Password Hashing · heiswayi nrird ••• "><meta property="og:image" content="https://heiswayi.nrird.com/assets/logo.png"><meta property="og:description" content=" If you need custom PHP function to secure your confidential information or to hash user password in unbreakable manner, these PHP code snippets may help and ... "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:title" content=" PHP - Encryption, Decryption and Password Hashing · heiswayi nrird ••• "><meta name="twitter:description" content=" If you need custom PHP function to secure your confidential information or to hash user password in unbreakable manner, these PHP code snippets may help and ... "><meta name="twitter:image:src" content="https://heiswayi.nrird.com/assets/logo.png"><meta itemprop="name" content=" PHP - Encryption, Decryption and Password Hashing · heiswayi nrird ••• "><meta itemprop="description" content=" If you need custom PHP function to secure your confidential information or to hash user password in unbreakable manner, these PHP code snippets may help and ... "><meta itemprop="image" content="https://heiswayi.nrird.com/assets/logo.png"><link rel="canonical" href="https://heiswayi.nrird.com/2015/php-encryption-decryption-and-password-hashing"><link rel="alternate" type="application/rss+xml" title="RSS" href="https://heiswayi.nrird.com/feed.xml"><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="><link rel="stylesheet" href="https://heiswayi.nrird.com/assets/css/main.css?20180603"> <script src="https://heiswayi.nrird.com/assets/js/modernizr.custom.js"></script> <!--[if lt IE 9]> <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script> <script src="https://heiswayi.nrird.com/assets/js/rem.min.js"></script> <![endif]--> <a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"> <canvas id="canvas" style="width:100%;height:100%;max-height:230px;position:absolute;z-index:1;opacity:0.5"></canvas><div class="container"><h2 class="masthead-title"> <a href="https://heiswayi.nrird.com" title="heiswayi nrird •••" class="title">heiswayi nrird <span class="dot-red">•</span><span class="dot-yellow">•</span><span class="dot-green">•</span></a> <small>Between coding and random stuffs </small></h2><div class="footer-social-links"> <a href="http://heiswayi.github.io/feed.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a> <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a> <!--<a href="https://www.facebook.com/heiswayi.nrird" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>--> <!--<a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>--> <a href="http://heiswayi.github.io/my-repos/" title="GitHub Repositories" target="_blank"><i class="fa fa-github-alt"></i></a> <a href="http://heiswayi.github.io/my-gists/" title="GitHub Gists" target="_blank"><i class="fa fa-code"></i></a> <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a> <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a> <a href="http://jsfiddle.net/user/heiswayi/" title="JSFiddle" target="_blank"><i class="fa fa-jsfiddle"></i></a></div><div class="nav"><ul class="top-menu"><li><a href="https://heiswayi.nrird.com/" title="Home"><i class="fa fa-home"></i></a><li><a href="https://heiswayi.nrird.com/about">About</a> <!--<li><a href="/resume">Resume <i class="fa fa-external-link-square"></i></a>--><li><a href="https://heiswayi.nrird.com/projects" class="bg-red"><i class="fa fa-space-shuttle" aria-hidden="true"></i> Projects</a><li><a href="https://heiswayi.nrird.com/tagged">Tags</a><li><a href="https://heiswayi.github.io/photography">Photography <i class="fa fa-external-link-square"></i></a><li><a href="https://heiswayi.nrird.com/reminder">Reminder</a></ul></div></div></div><div id="content" class="container content"><div class="post"><div class="post-top-meta"> <!--<div class="edit-this-page"><a href="https://github.com/heiswayi/heiswayi.github.io/blob/master/_posts/2015/2015-08-17-php-encryption-decryption-and-password-hashing.md">Edit this page</a></div>--><div class="post-date">August 17, 2015</div><h1 class="post-title">PHP - Encryption, Decryption and Password Hashing</h1></div><p>It is a software developer’s responsibility to write a software that is safe for its user. Any sensitive content or confidential information that does not need to be public or searchable, that kind of data practically must not be kept in a plain text. If you are writing a custom PHP application and if you need custom function that can encrypt and decrypt any sensitive string, you may use these code snippets. These are the common custom functions I have been using when developing web application or building a PHP website to ensure any sensitive data is not easily been disclosed, including custom function for user password hashing.<h3 id="data-encryption">Data encryption</h3><p>This is to encrypt any data string. You need to provide a password because you gonna need it when you want to decrypt back the encrypted string.<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">Encrypt</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span>
<span class="p">{</span>

    <span class="nv">$salt</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">mt_rand</span><span class="p">(),</span> <span class="kc">true</span><span class="p">),</span> <span class="mi">8</span><span class="p">);</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nv">$iv</span>  <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span> <span class="o">.</span> <span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="nv">$ct</span> <span class="o">=</span> <span class="nb">mcrypt_encrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>

    <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="s1">'Salted__'</span> <span class="o">.</span> <span class="nv">$salt</span> <span class="o">.</span> <span class="nv">$ct</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><p><strong>Example:</strong><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">Encrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'Welcome to Flippancy 25'</span><span class="p">);</span>
<span class="c1">// Output: U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6
</span><span class="cp">?&gt;</span>
</code></pre></div></div><p>Please note that, every time I execute this <code class="highlighter-rouge">Encrypt()</code> function, by using the <strong>same password</strong> and <strong>same data string</strong>, the encrypted string (output) is always changed as <code class="highlighter-rouge">mt_rand()</code> function is used for generating the <em>salt</em>.<p>Here are the example outputs of the encrypted string after I executed it for 3 times:-<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Output 1: U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6
// Output 2: U2FsdGVkX1/3zxJCcE8p89t67nJNp8blNkezNxTVn4IDFQLM755K2+OSfFHewDLI
// Output 3: U2FsdGVkX18OQ8puUN8BBi+d6vAjEzDTZqM2WaKQD1atOykkYl9MY7NQM1DqI4Kw
</code></pre></div></div><p>Hence, even the encrypted string is changed each time I executed the encrypt function for the same input data, but it still can be decrypted to get back the original data string.<h3 id="data-decryption">Data decryption</h3><p>This is to decrypt any encrypted string. You need to provide the right password that is used for the encryption.<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">Decrypt</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span>
<span class="p">{</span>

    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="nv">$salt</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
    <span class="nv">$ct</span>   <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nv">$iv</span>  <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span> <span class="o">.</span> <span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="nv">$pt</span> <span class="o">=</span> <span class="nb">mcrypt_decrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$ct</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$pt</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><p><strong>Example:</strong><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX1/3zxJCcE8p89t67nJNp8blNkezNxTVn4IDFQLM755K2+OSfFHewDLI'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX18OQ8puUN8BBi+d6vAjEzDTZqM2WaKQD1atOykkYl9MY7NQM1DqI4Kw'</span><span class="p">);</span>
<span class="c1">// All of three above will output the same decrypted data: Welcome to Flippancy 25
</span><span class="cp">?&gt;</span>
</code></pre></div></div><p>Please note that, for each encryption and decryption, they requires the <strong>same password</strong> to work. Else, you can’t get back the original data string.<h3 id="practical-use-of-data-encryption-and-decryption">Practical use of data encryption and decryption</h3><p><strong>Encryption</strong> means we want to hide something, rather than in the plain view. <strong>Decryption</strong> means we have the ability to get back the original data (in the plain view) that we encrypted. Basically this will be useful to work with user confidential information such as social security number, phone number, bank account number, credit card information, etc., but NOT FOR USER PASSWORD.<h3 id="securing-user-password-by-using-the-hashing-algorithm">Securing user password by using the hashing algorithm</h3><p>Other than data encryption and decryption, password hashing is the most important security factor in developing application that needs user access. The best implementation in password hashing is to use <strong>one-way hashing technique</strong> which means it is no longer be able to be decrypted (irreversible). Unlike the encryptions, they are usually formulated to be able to be decrypted. However, in password hashing method we can do “encrypt” it and at the end we must hash it. You may want to check the built-in functionality <a href="http://php.net/manual/en/function.password-hash.php">password_hash</a> or <a href="http://php.net/manual/en/function.crypt.php">crypt</a> for PHP one-way hashing algorithms.<p>Most of the time, in some of my projects if I need custom password hashing, I use this function to hash the user password:<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">hashPassword</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$salt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$hash_password</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">str_rot13</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">str_rot13</span><span class="p">(</span><span class="nv">$salt</span> <span class="o">.</span> <span class="nv">$password</span><span class="p">)))));</span>
    <span class="k">return</span> <span class="nv">$hash_password</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><p><strong>Example:</strong><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">hashPassword</span><span class="p">(</span><span class="s1">'myPa55w0rd'</span><span class="p">,</span> <span class="s1">'Flipp@ncy25'</span><span class="p">);</span>
<span class="c1">// Output: 815890bb72e10a75a52087513a931afb6641a5d8d105365fa6f389f038dd81b45290a44cf94bb61e7741e073c6f4d59a16e9896bd197cc320f84f3a4d27cfb50
</span><span class="cp">?&gt;</span>
</code></pre></div></div><p>Those are how I do to keep the user data secured and most importantly despite of whatever methods you’re using, security is always the top priority mindset. If you are keen to learn more about password hashing, I recommend you to read <a href="https://crackstation.net/hashing-security.htm">this article</a>. It is a very good article talking about salted password hashing.<div class="tagged"> <a href="https://heiswayi.nrird.com/tagged#php"><i class="fa fa-hashtag muted" aria-hidden="true"></i>PHP</a> <a href="https://heiswayi.nrird.com/tagged#encryption"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Encryption</a> <a href="https://heiswayi.nrird.com/tagged#decryption"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Decryption</a> <a href="https://heiswayi.nrird.com/tagged#password-hashing"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Password Hashing</a></div><div id="disqus" style="margin-top:2em"><div id="disqus_thread"></div><script> var disqus_config = function() { this.page.url = "https://heiswayi.nrird.com/2015/php-encryption-decryption-and-password-hashing"; this.page.identifier = "/2015/php-encryption-decryption-and-password-hashing"; }; (function() { var d = document, s = d.createElement('script'); s.src = '//hnbloggithub.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="footer"><div class="copyright"><i class="fa fa-copyright"></i> 2015 - 2018 Heiswayi Nrird // <a href="https://heiswayi.nrird.com/cookie-policy">Cookie Policy</a> // <a href="https://heiswayi.github.io/feed.xml">RSS</a></div></div><script> // Line numbering for code block (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-58296043-7', 'auto'); ga('send', 'pageview'); </script>
