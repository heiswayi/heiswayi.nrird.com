<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Expires" content="30"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title> Get started with Inno Setup · Heiswayi Nrird</title><meta name="description" content=" Inno Setup is a free script-driven installation system software for creating Windows app installer that surpasses many commercial installers in feature set a... "><meta name="keywords" content="inno setup, windows installer, creating windows app installer"><meta name="author" content="Heiswayi Nrird"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:url" content="http://localhost:4000/get-started-with-inno-setup"><meta property="og:type" content="website"><meta property="og:title" content=" Get started with Inno Setup · Heiswayi Nrird "><meta property="og:description" content=" Inno Setup is a free script-driven installation system software for creating Windows app installer that surpasses many commercial installers in feature set a... "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:image" content="http://localhost:4000/assets/logo.gif"><meta property="og:locale" content="en_US"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="inno setup, windows installer, creating windows app installer"><meta property="article:published_time" content="2018-05-23 00:00:00 +0800"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:creator" content="@heiswayi"><meta name="twitter:url" content="http://localhost:4000/get-started-with-inno-setup"><meta name="twitter:title" content=" Get started with Inno Setup · Heiswayi Nrird "><meta name="twitter:description" content=" Inno Setup is a free script-driven installation system software for creating Windows app installer that surpasses many commercial installers in feature set a... "><meta name="twitter:image" content="http://localhost:4000/assets/logo.gif"><meta itemprop="name" content=" Get started with Inno Setup · Heiswayi Nrird "><meta itemprop="description" content=" Inno Setup is a free script-driven installation system software for creating Windows app installer that surpasses many commercial installers in feature set a... "><meta itemprop="image" content="http://localhost:4000/assets/logo.gif"><link rel="canonical" href="http://localhost:4000/get-started-with-inno-setup"><link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/feed.xml"><link rel="shortcut icon" href="http://localhost:4000/assets/icons/favicon.ico"><link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4000/assets/icons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4000/assets/icons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/icons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/assets/icons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/icons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4000/assets/icons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/icons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4000/assets/icons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/icons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="http://localhost:4000/assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="http://localhost:4000/assets/icons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/icons/favicon-16x16.png"><link rel="manifest" href="http://localhost:4000/assets/icons/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="http://localhost:4000/assets/icons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="http://localhost:4000/assets/css/main.css?2020.170113"> <script type="text/javascript">;window.Modernizr=function(a,b,c){function x(a){j.cssText=a}function y(a,b){return x(prefixes.join(a+";")+(b||""))}function z(a,b){return typeof a===b}function A(a,b){return!!~(""+a).indexOf(b)}function B(a,b){for(var d in a){var e=a[d];if(!A(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function C(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:z(f,"function")?f.bind(d||b):f}return!1}function D(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+n.join(d+" ")+d).split(" ");return z(b,"string")||z(b,"undefined")?B(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),C(e,b,c))}var d="2.6.2",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v={}.hasOwnProperty,w;!z(v,"undefined")&&!z(v.call,"undefined")?w=function(a,b){return v.call(a,b)}:w=function(a,b){return b in a&&z(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e}),p.cssanimations=function(){return D("animationName")};for(var E in p)w(p,E)&&(u=E.toLowerCase(),e[u]=p[E](),s.push((e[u]?"":"no-")+u));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)w(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},x(""),i=k=null,function(a,b){function k(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function l(){var a=r.elements;return typeof a=="string"?a.split(" "):a}function m(a){var b=i[a[g]];return b||(b={},h++,a[g]=h,i[h]=b),b}function n(a,c,f){c||(c=b);if(j)return c.createElement(a);f||(f=m(c));var g;return f.cache[a]?g=f.cache[a].cloneNode():e.test(a)?g=(f.cache[a]=f.createElem(a)).cloneNode():g=f.createElem(a),g.canHaveChildren&&!d.test(a)?f.frag.appendChild(g):g}function o(a,c){a||(a=b);if(j)return a.createDocumentFragment();c=c||m(a);var d=c.frag.cloneNode(),e=0,f=l(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function p(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return r.shivMethods?n(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+l().join().replace(/\w+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(r,b.frag)}function q(a){a||(a=b);var c=m(a);return r.shivCSS&&!f&&!c.hasCSS&&(c.hasCSS=!!k(a,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),j||p(a,c),a}var c=a.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,e=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f,g="_html5shiv",h=0,i={},j;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",f="hidden"in a,j=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){f=!0,j=!0}})();var r={elements:c.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:c.shivCSS!==!1,supportsUnknownElements:j,shivMethods:c.shivMethods!==!1,type:"default",shivDocument:q,createElement:n,createDocumentFragment:o};a.html5=r,q(b)}(this,b),e._version=d,e._domPrefixes=o,e._cssomPrefixes=n,e.testProp=function(a){return B([a])},e.testAllProps=D,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+s.join(" "):""),e}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};/*! lazysizes - v4.0.3 */ !function(a,b){var c=b(a,a.document);a.lazySizes=c,"object"==typeof module&&module.exports&&(module.exports=c)}(window,function(a,b){"use strict";if(b.getElementsByClassName){var c,d,e=b.documentElement,f=a.Date,g=a.HTMLPictureElement,h="addEventListener",i="getAttribute",j=a[h],k=a.setTimeout,l=a.requestAnimationFrame||k,m=a.requestIdleCallback,n=/^picture$/i,o=["load","error","lazyincluded","_lazyloaded"],p={},q=Array.prototype.forEach,r=function(a,b){return p[b]||(p[b]=new RegExp("(\\s|^)"+b+"(\\s|$)")),p[b].test(a[i]("class")||"")&&p[b]},s=function(a,b){r(a,b)||a.setAttribute("class",(a[i]("class")||"").trim()+" "+b)},t=function(a,b){var c;(c=r(a,b))&&a.setAttribute("class",(a[i]("class")||"").replace(c," "))},u=function(a,b,c){var d=c?h:"removeEventListener";c&&u(a,b),o.forEach(function(c){a[d](c,b)})},v=function(a,d,e,f,g){var h=b.createEvent("CustomEvent");return e||(e={}),e.instance=c,h.initCustomEvent(d,!f,!g,e),a.dispatchEvent(h),h},w=function(b,c){var e;!g&&(e=a.picturefill||d.pf)?e({reevaluate:!0,elements:[b]}):c&&c.src&&(b.src=c.src)},x=function(a,b){return(getComputedStyle(a,null)||{})[b]},y=function(a,b,c){for(c=c||a.offsetWidth;c<d.minSize&&b&&!a._lazysizesWidth;)c=b.offsetWidth,b=b.parentNode;return c},z=function(){var a,c,d=[],e=[],f=d,g=function(){var b=f;for(f=d.length?e:d,a=!0,c=!1;b.length;)b.shift()();a=!1},h=function(d,e){a&&!e?d.apply(this,arguments):(f.push(d),c||(c=!0,(b.hidden?k:l)(g)))};return h._lsFlush=g,h}(),A=function(a,b){return b?function(){z(a)}:function(){var b=this,c=arguments;z(function(){a.apply(b,c)})}},B=function(a){var b,c=0,e=d.throttleDelay,g=d.ricTimeout,h=function(){b=!1,c=f.now(),a()},i=m&&g>49?function(){m(h,{timeout:g}),g!==d.ricTimeout&&(g=d.ricTimeout)}:A(function(){k(h)},!0);return function(a){var d;(a=a===!0)&&(g=33),b||(b=!0,d=e-(f.now()-c),0>d&&(d=0),a||9>d?i():k(i,d))}},C=function(a){var b,c,d=99,e=function(){b=null,a()},g=function(){var a=f.now()-c;d>a?k(g,d-a):(m||e)(e)};return function(){c=f.now(),b||(b=k(g,d))}};!function(){var b,c={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};d=a.lazySizesConfig||a.lazysizesConfig||{};for(b in c)b in d||(d[b]=c[b]);a.lazySizesConfig=d,k(function(){d.init&&F()})}();var D=function(){var g,l,m,o,p,y,D,F,G,H,I,J,K,L,M=/^img$/i,N=/^iframe$/i,O="onscroll"in a&&!/glebot/.test(navigator.userAgent),P=0,Q=0,R=0,S=-1,T=function(a){R--,a&&a.target&&u(a.target,T),(!a||0>R||!a.target)&&(R=0)},U=function(a,c){var d,f=a,g="hidden"==x(b.body,"visibility")||"hidden"!=x(a,"visibility");for(F-=c,I+=c,G-=c,H+=c;g&&(f=f.offsetParent)&&f!=b.body&&f!=e;)g=(x(f,"opacity")||1)>0,g&&"visible"!=x(f,"overflow")&&(d=f.getBoundingClientRect(),g=H>d.left&&G<d.right&&I>d.top-1&&F<d.bottom+1);return g},V=function(){var a,f,h,j,k,m,n,p,q,r=c.elements;if((o=d.loadMode)&&8>R&&(a=r.length)){f=0,S++,null==K&&("expand"in d||(d.expand=e.clientHeight>500&&e.clientWidth>500?500:370),J=d.expand,K=J*d.expFactor),K>Q&&1>R&&S>2&&o>2&&!b.hidden?(Q=K,S=0):Q=o>1&&S>1&&6>R?J:P;for(;a>f;f++)if(r[f]&&!r[f]._lazyRace)if(O)if((p=r[f][i]("data-expand"))&&(m=1*p)||(m=Q),q!==m&&(y=innerWidth+m*L,D=innerHeight+m,n=-1*m,q=m),h=r[f].getBoundingClientRect(),(I=h.bottom)>=n&&(F=h.top)<=D&&(H=h.right)>=n*L&&(G=h.left)<=y&&(I||H||G||F)&&(d.loadHidden||"hidden"!=x(r[f],"visibility"))&&(l&&3>R&&!p&&(3>o||4>S)||U(r[f],m))){if(ba(r[f]),k=!0,R>9)break}else!k&&l&&!j&&4>R&&4>S&&o>2&&(g[0]||d.preloadAfterLoad)&&(g[0]||!p&&(I||H||G||F||"auto"!=r[f][i](d.sizesAttr)))&&(j=g[0]||r[f]);else ba(r[f]);j&&!k&&ba(j)}},W=B(V),X=function(a){s(a.target,d.loadedClass),t(a.target,d.loadingClass),u(a.target,Z),v(a.target,"lazyloaded")},Y=A(X),Z=function(a){Y({target:a.target})},$=function(a,b){try{a.contentWindow.location.replace(b)}catch(c){a.src=b}},_=function(a){var b,c=a[i](d.srcsetAttr);(b=d.customMedia[a[i]("data-media")||a[i]("media")])&&a.setAttribute("media",b),c&&a.setAttribute("srcset",c)},aa=A(function(a,b,c,e,f){var g,h,j,l,o,p;(o=v(a,"lazybeforeunveil",b)).defaultPrevented||(e&&(c?s(a,d.autosizesClass):a.setAttribute("sizes",e)),h=a[i](d.srcsetAttr),g=a[i](d.srcAttr),f&&(j=a.parentNode,l=j&&n.test(j.nodeName||"")),p=b.firesLoad||"src"in a&&(h||g||l),o={target:a},p&&(u(a,T,!0),clearTimeout(m),m=k(T,2500),s(a,d.loadingClass),u(a,Z,!0)),l&&q.call(j.getElementsByTagName("source"),_),h?a.setAttribute("srcset",h):g&&!l&&(N.test(a.nodeName)?$(a,g):a.src=g),f&&(h||l)&&w(a,{src:g})),a._lazyRace&&delete a._lazyRace,t(a,d.lazyClass),z(function(){(!p||a.complete&&a.naturalWidth>1)&&(p?T(o):R--,X(o))},!0)}),ba=function(a){var b,c=M.test(a.nodeName),e=c&&(a[i](d.sizesAttr)||a[i]("sizes")),f="auto"==e;(!f&&l||!c||!a[i]("src")&&!a.srcset||a.complete||r(a,d.errorClass)||!r(a,d.lazyClass))&&(b=v(a,"lazyunveilread").detail,f&&E.updateElem(a,!0,a.offsetWidth),a._lazyRace=!0,R++,aa(a,b,f,e,c))},ca=function(){if(!l){if(f.now()-p<999)return void k(ca,999);var a=C(function(){d.loadMode=3,W()});l=!0,d.loadMode=3,W(),j("scroll",function(){3==d.loadMode&&(d.loadMode=2),a()},!0)}};return{_:function(){p=f.now(),c.elements=b.getElementsByClassName(d.lazyClass),g=b.getElementsByClassName(d.lazyClass+" "+d.preloadClass),L=d.hFac,j("scroll",W,!0),j("resize",W,!0),a.MutationObserver?new MutationObserver(W).observe(e,{childList:!0,subtree:!0,attributes:!0}):(e[h]("DOMNodeInserted",W,!0),e[h]("DOMAttrModified",W,!0),setInterval(W,999)),j("hashchange",W,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(a){b[h](a,W,!0)}),/d$|^c/.test(b.readyState)?ca():(j("load",ca),b[h]("DOMContentLoaded",W),k(ca,2e4)),c.elements.length?(V(),z._lsFlush()):W()},checkElems:W,unveil:ba}}(),E=function(){var a,c=A(function(a,b,c,d){var e,f,g;if(a._lazysizesWidth=d,d+="px",a.setAttribute("sizes",d),n.test(b.nodeName||""))for(e=b.getElementsByTagName("source"),f=0,g=e.length;g>f;f++)e[f].setAttribute("sizes",d);c.detail.dataAttr||w(a,c.detail)}),e=function(a,b,d){var e,f=a.parentNode;f&&(d=y(a,f,d),e=v(a,"lazybeforesizes",{width:d,dataAttr:!!b}),e.defaultPrevented||(d=e.detail.width,d&&d!==a._lazysizesWidth&&c(a,f,e,d)))},f=function(){var b,c=a.length;if(c)for(b=0;c>b;b++)e(a[b])},g=C(f);return{_:function(){a=b.getElementsByClassName(d.autosizesClass),j("resize",g)},checkElems:g,updateElem:e}}(),F=function(){F.i||(F.i=!0,E._(),D._())};return c={cfg:d,autoSizer:E,loader:D,init:F,uP:w,aC:s,rC:t,hC:r,fire:v,gW:y,rAF:z}}});</script> <!--[if lt IE 9]> <script type="text/javascript">/** * @preserve HTML5 Shiv 3.7.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed */ !function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=t.elements;return"string"==typeof a?a.split(" "):a}function e(a,b){var c=t.elements;"string"!=typeof c&&(c=c.join(" ")),"string"!=typeof a&&(a=a.join(" ")),t.elements=c+" "+a,j(b)}function f(a){var b=s[a[q]];return b||(b={},r++,a[q]=r,s[r]=b),b}function g(a,c,d){if(c||(c=b),l)return c.createElement(a);d||(d=f(c));var e;return e=d.cache[a]?d.cache[a].cloneNode():p.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!e.canHaveChildren||o.test(a)||e.tagUrn?e:d.frag.appendChild(e)}function h(a,c){if(a||(a=b),l)return a.createDocumentFragment();c=c||f(a);for(var e=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)e.createElement(h[g]);return e}function i(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return t.shivMethods?g(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-:]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(t,b.frag)}function j(a){a||(a=b);var d=f(a);return!t.shivCSS||k||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),l||i(a,d),a}var k,l,m="3.7.2",n=a.html5||{},o=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,q="_html5shiv",r=0,s={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",k="hidden"in a,l=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){k=!0,l=!0}}();var t={elements:n.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:m,shivCSS:n.shivCSS!==!1,supportsUnknownElements:l,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:j,createElement:g,createDocumentFragment:h,addElements:e};a.html5=t,j(b)}(this,document); /*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */ /*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */ window.matchMedia=window.matchMedia||(function(e,f){var c,a=e.documentElement,b=a.firstElementChild||a.firstChild,d=e.createElement("body"),g=e.createElement("div");g.id="mq-test-1";g.style.cssText="position:absolute;top:-100em";d.style.background="none";d.appendChild(g);return function(h){g.innerHTML='&shy;<style media="'+h+'"> #mq-test-1 { width: 42px; }</style>';a.insertBefore(d,b);c=g.offsetWidth==42;a.removeChild(d);return{matches:c,media:h}}})(document); /*! Respond.js v1.1.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs */ (function(e){e.respond={};respond.update=function(){};respond.mediaQueriesSupported=e.matchMedia&&e.matchMedia("only all").matches;if(respond.mediaQueriesSupported){return}var w=e.document,s=w.documentElement,i=[],k=[],q=[],o={},h=30,f=w.getElementsByTagName("head")[0]||s,g=w.getElementsByTagName("base")[0],b=f.getElementsByTagName("link"),d=[],a=function(){var D=b,y=D.length,B=0,A,z,C,x;for(;B<y;B++){A=D[B],z=A.href,C=A.media,x=A.rel&&A.rel.toLowerCase()==="stylesheet";if(!!z&&x&&!o[z]){if(A.styleSheet&&A.styleSheet.rawCssText){m(A.styleSheet.rawCssText,z,C);o[z]=true}else{if((!/^([a-zA-Z:]*\/\/)/.test(z)&&!g)||z.replace(RegExp.$1,"").split("/")[0]===e.location.host){d.push({href:z,media:C})}}}}u()},u=function(){if(d.length){var x=d.shift();n(x.href,function(y){m(y,x.href,x.media);o[x.href]=true;u()})}},m=function(I,x,z){var G=I.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),J=G&&G.length||0,x=x.substring(0,x.lastIndexOf("/")),y=function(K){return K.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+x+"$2$3")},A=!J&&z,D=0,C,E,F,B,H;if(x.length){x+="/"}if(A){J=1}for(;D<J;D++){C=0;if(A){E=z;k.push(y(I))}else{E=G[D].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1;k.push(RegExp.$2&&y(RegExp.$2))}B=E.split(",");H=B.length;for(;C<H;C++){F=B[C];i.push({media:F.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:k.length-1,hasquery:F.indexOf("(")>-1,minw:F.match(/\(min\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:F.match(/\(max\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}}j()},l,r,v=function(){var z,A=w.createElement("div"),x=w.body,y=false;A.style.cssText="position:absolute;font-size:1em;width:1em";if(!x){x=y=w.createElement("body");x.style.background="none"}x.appendChild(A);s.insertBefore(x,s.firstChild);z=A.offsetWidth;if(y){s.removeChild(x)}else{x.removeChild(A)}z=p=parseFloat(z);return z},p,j=function(I){var x="clientWidth",B=s[x],H=w.compatMode==="CSS1Compat"&&B||w.body[x]||B,D={},G=b[b.length-1],z=(new Date()).getTime();if(I&&l&&z-l<h){clearTimeout(r);r=setTimeout(j,h);return}else{l=z}for(var E in i){var K=i[E],C=K.minw,J=K.maxw,A=C===null,L=J===null,y="em";if(!!C){C=parseFloat(C)*(C.indexOf(y)>-1?(p||v()):1)}if(!!J){J=parseFloat(J)*(J.indexOf(y)>-1?(p||v()):1)}if(!K.hasquery||(!A||!L)&&(A||H>=C)&&(L||H<=J)){if(!D[K.media]){D[K.media]=[]}D[K.media].push(k[K.rules])}}for(var E in q){if(q[E]&&q[E].parentNode===f){f.removeChild(q[E])}}for(var E in D){var M=w.createElement("style"),F=D[E].join("\n");M.type="text/css";M.media=E;f.insertBefore(M,G.nextSibling);if(M.styleSheet){M.styleSheet.cssText=F}else{M.appendChild(w.createTextNode(F))}q.push(M)}},n=function(x,z){var y=c();if(!y){return}y.open("GET",x,true);y.onreadystatechange=function(){if(y.readyState!=4||y.status!=200&&y.status!=304){return}z(y.responseText)};if(y.readyState==4){return}y.send(null)},c=(function(){var x=false;try{x=new XMLHttpRequest()}catch(y){x=new ActiveXObject("Microsoft.XMLHTTP")}return function(){return x}})();a();respond.update=a;function t(){j(true)}if(e.addEventListener){e.addEventListener("resize",t,false)}else{if(e.attachEvent){e.attachEvent("onresize",t)}}})(this); /** * Module: rem - v1.3.2 * Description: A polyfill to parse CSS links and rewrite pixel equivalents into head for non supporting browsers * Date Built: 2014-07-02 * Copyright (c) 2014 | Chuck Carpenter <chuck.carpenter@me.com>,Lucas Serven <lserven@gmail.com>; **/ !function(e){"use strict";var t=function(){var e=document.createElement("div");return e.style.cssText="font-size: 1rem;",/rem/.test(e.style.fontSize)},n=function(){for(var e=document.getElementsByTagName("link"),t=[],n=0;n<e.length;n++)"stylesheet"===e[n].rel.toLowerCase()&&null===e[n].getAttribute("data-norem")&&t.push(e[n].href);return t},r=function(){for(var e=0;e<h.length;e++)l(h[e],o)},o=function(e,t){if(p.push(e.responseText),v.push(t),v.length===h.length){for(var n=0;n<v.length;n++)a(p[n],v[n]);(h=m.slice(0)).length>0?(v=[],p=[],m=[],r()):i()}},a=function(e,t){for(var n,r=d(e).replace(/\/\*[\s\S]*?\*\//g,""),o=/[\w\d\s\-\/\\\[\]:,.'"*()<>+~%#^$_=|@]+\{[\w\d\s\-\/\\%#:!;,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!;,.'"*()]*\}/g,a=r.match(o),i=/\d*\.?\d+rem/g,s=r.match(i),c=/(.*\/)/,l=c.exec(t)[0],u=/@import (?:url\()?['"]?([^'\)"]*)['"]?\)?[^;]*/gm;null!==(n=u.exec(e));)m.push(0===n[1].indexOf("/")?n[1]:l+n[1]);null!==a&&0!==a.length&&(f=f.concat(a),g=g.concat(s))},i=function(){for(var e=/[\w\d\s\-\/\\%#:,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!,.'"*()]*[;}]/g,t=0;t<f.length;t++){u+=f[t].substr(0,f[t].indexOf("{")+1);for(var n=f[t].match(e),r=0;r<n.length;r++)u+=n[r],r===n.length-1&&"}"!==u[u.length-1]&&(u+="\n}")}s()},s=function(){for(var e=0;e<g.length;e++)y[e]=Math.round(parseFloat(g[e].substr(0,g[e].length-3)*w))+"px";c()},c=function(){for(var e=0;e<y.length;e++)y[e]&&(u=u.replace(g[e],y[e]));var t=document.createElement("style");t.setAttribute("type","text/css"),t.id="remReplace",document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=u:t.appendChild(document.createTextNode(u))},l=function(t,n){try{var r=e.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP")||new ActiveXObject("Msxml2.XMLHTTP"):new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4===r.readyState&&n(r,t)},r.send(null)}catch(o){if(e.XDomainRequest){var a=new XDomainRequest;a.open("get",t),a.onload=function(){n(a,t)},a.onerror=function(){return!1},a.send()}}},d=function(t){return e.matchMedia||e.msMatchMedia||(t=t.replace(/@media[\s\S]*?\}\s*\}/g,"")),t};if(!t()){var u="",h=n(),m=[],f=[],g=[],p=[],v=[],y=[],w="";w=function(){var e,t=document,n=t.documentElement,r=t.body||t.createElement("body"),o=!t.body,a=t.createElement("div"),i=r.style.fontSize;return o&&n.appendChild(r),a.style.cssText="width:1em; position:absolute; visibility:hidden; padding: 0;",r.style.fontSize="1em",r.appendChild(a),e=a.offsetWidth,o?n.removeChild(r):(r.removeChild(a),r.style.fontSize=i),e}(),r()}}(window);</script> <![endif]--><style> .post-date { color: #ddd; } .post-date:hover { color: #888; } .img-logo { display: block; margin-top: 2rem; } .nav { display: none; } @media print { pre .line-number, .hidden-on-print { display: none; } .post-date { color: #aaa; } }</style><a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"><div class="container"><div class="masthead-title"> <a href="http://localhost:4000/" title="Heiswayi Nrird" class="title"><img src="http://localhost:4000/assets/icons/android-icon-36x36.png" alt="Logo" class="img-logo"></a></div><div class="nav"> <a href="http://localhost:4000/">Home</a> <a href="http://localhost:4000/about">About</a> <a href="http://localhost:4000/projects">Projects</a> <a href="http://localhost:4000/photography">Photos</a></div></div></div><div id="content" class="container content"><hr class="hidden"> <span class="hidden">&nbsp;</span><div class="post"><div class="post-top-meta"> <!--<div class="post-date">May 23, 2018 — By Heiswayi Nrird</div>--><h1 class="post-title">Get started with Inno Setup</h1></div><article id="article"><h3 id="what-is-inno-setup">What is Inno Setup?</h3><p>Inno Setup is a <em>free</em> script-driven installation system software for creating Windows app installer. Inno Setup is <a href="https://github.com/jrsoftware/issrc">open source</a>, the best non-MSI alternative installer by Jordan Russel and Martijn Laan. It is first introduced in 1997, Inno Setup today rivals and even surpasses many commercial installers in feature set and stability. Visit <a href="http://www.jrsoftware.org/isinfo.php">Inno Setup official website</a> to learn more about it.<h3 id="get-started-with-inno-setup">Get started with Inno Setup</h3><p>In this post I would like to share the Inno Setup script that I have been using for creating one of my applications installer.<p>To get started, you can download and install Inno Setup from <a href="http://www.jrsoftware.org/isdl.php">the download page here</a>. <strong>Unicode version is recommended.</strong> If you need a better intuitive GUI software for Inno Setup, you can download and install <a href="https://www.kymoto.org/products/inno-script-studio"><strong>Inno Script Studio</strong></a>.<p>If you use <a href="https://code.visualstudio.com/">VS Code</a> or <a href="https://atom.io/">Atom</a> editor to edit <strong>Inno Setup scripts</strong>, you can install Inno Setup extension for the script syntax highlighting - <a href="https://marketplace.visualstudio.com/items?itemName=idleberg.innosetup">Inno Setup for Visual Studio Code</a> or <a href="https://atom.io/packages/language-innosetup">Inno Setup for Atom</a>.<h3 id="using-inno-setup-in-your-automated-build-system">Using Inno Setup in your automated build system</h3><p>If you have automated build system (CI/CD) set up that builds your app source code, if you use Inno Setup script to create the installer, you can simply integrate <strong>Inno Setup Compiler</strong> into your build system to compile the Inno Setup script file (<code class="highlighter-rouge">*.iss</code>). There is a file called <code class="highlighter-rouge">ISCC.exe</code> for the command-line compiler.<p>For example, you can add <code class="highlighter-rouge">C:\Program Files (x86)\Inno Setup 5</code> into the PATH environment, then you can simply use this command to compile your Inno Setup script:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iscc path\to\myinstaller.iss
</code></pre></div></div><p>To learn more on what command-line options are available, you can just type <code class="highlighter-rouge">iscc /?</code> from a command prompt.<h3 id="example-of-my-inno-setup-script">Example of my Inno Setup script</h3><figure> <a href="https://i.imgur.com/rodYZ00.png"> <noscript> <img src="https://i.imgur.com/rodYZ00.png" alt="Image: Installer welcome dialog" /> </noscript> <img src="data:image/gif;base64,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" data-src="https://i.imgur.com/rodYZ00.png" alt="Image: Installer welcome dialog" class="lazyload" /> </a><figcaption><span>Installer welcome dialog</span></figcaption></figure><p>The script is written based on the example of the app files structure below. You may need to modify the script to suit your app files structure. Any feature you don’t need, you can simply remove or comment it out. I always reuse this script as a starting point and make some modifications that suit the app files structure and requirements for my app installer.<p>Example of the app files structure:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.\
├── basic.iss
└── basic\
    ├── app\
    |   ├── Resources\
    |   |   ├── map.xml
    |   |   └── res.ini
    |   ├── ExifReader.exe
    |   ├── ICSharpCode.SharpZipLib.dll
    |   ├── MetadataExtractor.dll
    |   ├── Ookii.Dialogs.Wpf.dll
    |   └── XmpCore.dll
    ├── appconfig\
    |   └── config.ini
    ├── doc\
    |   ├── EULA.rtf
    |   ├── Readme.rtf
    |   └── Requirements.rtf
    └── res\
        ├── app.ico
        ├── TopBanner.bmp
        └── VerticalBanner.bmp
</code></pre></div></div><p>Example of the Inno Setup script:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>; Preprocessor variables
#define MyAppName "EXIF Reader"
#define MyAppVersion "0.0.1"
#define MyAppPublisher "Heiswayi Nrird"
#define MyAppURL "https://heiswayi.nrird.com/exifreader"
#define MyAppExeName "ExifReader.exe"
#define MyAppCopyright "Copyright (C) 2018 Heiswayi Nrird"
#define IncludeFramework true

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{41045341-CB76-446F-8180-6489D9474F1F}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
AppVerName={#MyAppName}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
AppCopyright={#MyAppCopyright}
; Default location of installation
DefaultDirName={pf}\{#MyAppPublisher}\{#MyAppName}
DefaultGroupName={#MyAppPublisher}\{#MyAppName}
; Installer name
OutputBaseFilename="ExifReaderSetup"
; Installer icon
SetupIconFile=.\basic\res\app.ico
Compression=lzma
SolidCompression=yes
LicenseFile=.\basic\doc\EULA.rtf
InfoBeforeFile=.\basic\doc\Requirements.rtf
InfoAfterFile=.\basic\doc\Readme.rtf
; Uninstaller icon
UninstallDisplayIcon={app}\{#MyAppExeName}
DisableWelcomePage=no
; Installer vertical banner, max resolution: 164x314 px
WizardImageFile=.\basic\res\VerticalBanner.bmp
; Installer top logo, max resolution: 55x58 px
; I'm not using this as I'm using top banner instead (see below), so I commented it out.
;WizardSmallImageFile=TopLogo.bmp
; Installer FileVersion
VersionInfoVersion=1.0.0.0
;CreateUninstallRegKey=no
PrivilegesRequired=admin
; Installer output is the same as source (.iss file)
OutputDir=.

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"

[Tasks]
Name: "desktopicon"; Description: "{cm:CreateDesktopIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked
Name: "quicklaunchicon"; Description: "{cm:CreateQuickLaunchIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked; OnlyBelowVersion: 0,6.1

[Files]
; NOTE: Don't use "Flags: ignoreversion" on any shared system files
Source: ".\basic\app\*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs
Source: ".\basic\doc\*"; DestDir: "{app}\Docs"; Flags: ignoreversion
; These files will not be removed during uninstallation
; {userdocs} = My Documents folder
Source: ".\basic\appconfig\*"; DestDir: "{userdocs}\{#MyAppName}"; Flags: ignoreversion uninsneveruninstall
; Customized top banner, max resolution: 499x58 px
Source: ".\basic\res\TopBanner.bmp"; Flags: dontcopy

[Icons]
Name: "{group}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"
Name: "{group}\{cm:UninstallProgram,{#MyAppName}}"; Filename: "{uninstallexe}"
Name: "{commondesktop}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: desktopicon
Name: "{userappdata}\Microsoft\Internet Explorer\Quick Launch\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: quicklaunchicon

[Run]
Filename: "{app}\{#MyAppExeName}"; Description: "{cm:LaunchProgram,{#StringChange(MyAppName, '&amp;', '&amp;&amp;')}}"; Flags: nowait postinstall skipifsilent

[Messages]
; Customized license agreement checkbox messages
LicenseAccepted=&amp;Agree
LicenseNotAccepted=&amp;Do Not Agree

[Code]
// I'm using horizontal top banner instead of logo
procedure InitializeWizard();
var
  BitmapImage: TBitmapImage;
begin
  ExtractTemporaryFile('TopBanner.bmp');
  BitmapImage := TBitmapImage.Create(WizardForm);
  BitmapImage.Parent := WizardForm.MainPanel;
  BitmapImage.Width := WizardForm.MainPanel.Width;
  BitmapImage.Height := WizardForm.MainPanel.Height;
  BitmapImage.Stretch := True;
  BitmapImage.AutoSize := False;
  BitmapImage.Bitmap.LoadFromFile(ExpandConstant('{tmp}\TopBanner.bmp'));

  WizardForm.WizardSmallBitmapImage.Visible := False;
  WizardForm.PageDescriptionLabel.Visible := True;
  WizardForm.PageNameLabel.Visible := True;

  WizardForm.PageDescriptionLabel.Color := TColor($E8E8E8);
  WizardForm.PageNameLabel.Color := TColor($E8E8E8);

  WizardForm.PageDescriptionLabel.Width :=
    WizardForm.PageDescriptionLabel.Width - ScaleX(60);
  WizardForm.PageNameLabel.Width :=
    WizardForm.PageNameLabel.Width - ScaleX(60);
end;
</code></pre></div></div><p>There are some common <strong>Flags</strong> under <code class="highlighter-rouge">[Files]</code> section used in the script above and here what they mean:<ul><li><code class="highlighter-rouge">ignoreversion</code> - replace existing files regardless of their version number<li><code class="highlighter-rouge">onlyifdoesntexist</code> - only install the file if it doesn’t already exist on the user’s system<li><code class="highlighter-rouge">recursesubdirs</code> - use this when you use wildcard for the <code class="highlighter-rouge">Source</code> as shown in the script above<li><code class="highlighter-rouge">createallsubdirs</code> - create all subdirectories, and must be combined with <code class="highlighter-rouge">recursesubdirs</code><li><code class="highlighter-rouge">uninsneveruninstall</code> - never remove the file during uninstallation<li><code class="highlighter-rouge">deleteafterinstall</code> - delete file once the installation is completed/aborted</ul><p>For other available flags, you can refer to <a href="http://www.jrsoftware.org/ishelp/index.php?topic=filessection">Inno Setup documentation here</a> for more details. It’s too robust for me to explain everything here.<h3 id="heres-how-you-can-implement-components-based-installation-in-your-installer">Here’s how you can implement components-based installation in your installer</h3><figure> <a href="https://i.imgur.com/BeKgNvo.png"> <noscript> <img src="https://i.imgur.com/BeKgNvo.png" alt="Image: Components-based installation dialog" /> </noscript> <img src="data:image/gif;base64,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" data-src="https://i.imgur.com/BeKgNvo.png" alt="Image: Components-based installation dialog" class="lazyload" /> </a><figcaption><span>Components-based installation dialog</span></figcaption></figure><p>If you want to design your app installer using components-based installation, you may need to modify the Inno Setup script and add two extra sections called <code class="highlighter-rouge">[Types]</code> and <code class="highlighter-rouge">[Components]</code>. Check the provided example script below which taken from <code class="highlighter-rouge">Components.iss</code> file that is located in <code class="highlighter-rouge">C:\Program Files (x86)\Inno Setup 5\Examples</code> folder once you have installed the Inno Setup software.<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program
DefaultGroupName=My Program
UninstallDisplayIcon={app}\MyProg.exe
OutputDir=userdocs:Inno Setup Examples Output

[Types]
Name: "full"; Description: "Full installation"
Name: "compact"; Description: "Compact installation"
Name: "custom"; Description: "Custom installation"; Flags: iscustom

[Components]
Name: "program"; Description: "Program Files"; Types: full compact custom; Flags: fixed
Name: "help"; Description: "Help File"; Types: full
Name: "readme"; Description: "Readme File"; Types: full
Name: "readme\en"; Description: "English"; Flags: exclusive
Name: "readme\de"; Description: "German"; Flags: exclusive

[Files]
Source: "MyProg.exe"; DestDir: "{app}"; Components: program
Source: "MyProg.chm"; DestDir: "{app}"; Components: help
Source: "Readme.txt"; DestDir: "{app}"; Components: readme\en; Flags: isreadme
Source: "Readme-German.txt"; DestName: "Liesmich.txt"; DestDir: "{app}"; Components: readme\de; Flags: isreadme

[Icons]
Name: "{group}\My Program"; Filename: "{app}\MyProg.exe"
</code></pre></div></div><p>The meanings of the <strong>Flags</strong> used in the script above:<ul><li><code class="highlighter-rouge">fixed</code> - usually used in the main program file where user cannot unselect that component<li><code class="highlighter-rouge">exclusive</code> - user only can select one of the exclusive components, mostly used for localized files</ul><h3 id="heres-how-you-can-create-prerequisites-for-your-installer">Here’s how you can create prerequisites for your installer</h3><h4 id="net-framework-as-the-primary-prerequisite">.NET Framework as the primary prerequisite</h4><p>If your app requires particular .NET Framework to be installed as part of the prerequisites, there are few ways you can do with Inno Setup script. You either can;-<ul><li>include or package together the offline installer of .NET Framework into your app installer, or<li>just check and if not installed, inform the user to download and install particular .NET Framework manually, and then abort your app installer.</ul><p>You can use the <a href="http://jrsoftware.org/ishelp/topic_scriptcheck.htm">Check</a> parameter to run check if particular .NET Framework is installed.<p>Inno Setup <a href="http://www.jrsoftware.org/ishelp/index.php?topic=scriptintro">scripting</a> is based on <a href="https://en.wikipedia.org/wiki/Pascal_(programming_language)">Pascal</a> programming language which adds lots of new possibilities to customize your Setup or Uninstall at run-time.<h4 id="include-net-framework-offline-installer-into-your-installer">Include .NET Framework offline installer into your installer</h4><p>Add a new <code class="highlighter-rouge">Source</code> under the <code class="highlighter-rouge">[Files]</code> section:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Files]
; .NET Framework v4.7.1 offline installer
Source: ".\basic\dependencies\NDP471-KB4033342-x86-x64-AllOS-ENU.exe"; DestDir: {tmp}; Flags: deleteafterinstall; AfterInstall: InstallFramework; Check: FrameworkIsNotInstalled
</code></pre></div></div><p>Add these two code under <code class="highlighter-rouge">[Code]</code> section:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Code</span><span class="p">]</span>
<span class="c1">// Check for installed .NET Framework 4.7.1 in the registry
// MSDN page: https://msdn.microsoft.com/en-us/library/hh925568.aspx
</span><span class="k">function</span> <span class="n">FrameworkIsNotInstalled</span><span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="k">var</span>
  <span class="n">readVal</span><span class="p">:</span> <span class="kt">cardinal</span><span class="p">;</span>
  <span class="n">success</span><span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="k">begin</span>               
  <span class="n">success</span> <span class="p">:=</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="s">'SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full'</span><span class="p">,</span> <span class="s">'Release'</span><span class="p">,</span> <span class="n">readVal</span><span class="p">);</span>
  <span class="n">success</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="p">(</span><span class="n">readVal</span> <span class="p">&lt;</span> <span class="m">461308</span><span class="p">);</span>
  <span class="n">Result</span> <span class="p">:=</span> <span class="k">not</span> <span class="n">success</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c1">// Create progress dialog for installing .NET Framework 4.7.1
</span><span class="k">procedure</span> <span class="n">InstallFramework</span><span class="p">;</span>
<span class="k">var</span>
    <span class="n">StatusText</span><span class="p">:</span> <span class="k">string</span><span class="p">;</span>
    <span class="n">ResultCode</span><span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="k">begin</span>
   <span class="n">StatusText</span> <span class="p">:=</span> <span class="n">WizardForm</span><span class="p">.</span><span class="n">StatusLabel</span><span class="p">.</span><span class="n">Caption</span><span class="p">;</span>
   <span class="n">WizardForm</span><span class="p">.</span><span class="n">StatusLabel</span><span class="p">.</span><span class="n">Caption</span> <span class="p">:=</span> <span class="s">'Installing .NET Framework 4.5.2. This might take a few minutes...'</span><span class="p">;</span>
   <span class="n">WizardForm</span><span class="p">.</span><span class="n">ProgressGauge</span><span class="p">.</span><span class="n">Style</span> <span class="p">:=</span> <span class="n">npbstMarquee</span><span class="p">;</span>

   <span class="k">try</span>
       <span class="n">Exec</span><span class="p">(</span><span class="n">ExpandConstant</span><span class="p">(</span><span class="s">'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'</span><span class="p">),</span> <span class="s">'/passive /norestart'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">SW_SHOW</span><span class="p">,</span> <span class="n">ewWaitUntilTerminated</span><span class="p">,</span> <span class="n">ResultCode</span><span class="p">)</span>
       <span class="k">if</span> <span class="n">ResultCode</span> <span class="p">&lt;&gt;</span> <span class="m">0</span> <span class="k">then</span>
       <span class="k">begin</span>
           <span class="n">MsgBox</span><span class="p">(</span><span class="s">'.NET installation failed with code: '</span> <span class="p">+</span> <span class="n">IntToStr</span><span class="p">(</span><span class="n">ResultCode</span><span class="p">)</span> <span class="p">+</span> <span class="s">'.'</span> <span class="p">+</span> <span class="p">#</span><span class="m">13</span><span class="p">#</span><span class="m">10</span> <span class="p">+</span> <span class="p">#</span><span class="m">13</span><span class="p">#</span><span class="m">10</span> <span class="p">+</span> <span class="s">'Setup will now terminate.'</span><span class="p">,</span> <span class="n">mbError</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
           <span class="n">DeleteFile</span><span class="p">(</span><span class="n">ExpandConstant</span><span class="p">(</span><span class="s">'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'</span><span class="p">));</span>
           <span class="n">Exterminate</span><span class="p">;</span>
       <span class="k">end</span>
       <span class="k">else</span>
       <span class="k">begin</span>
           <span class="n">WizardForm</span><span class="p">.</span><span class="n">StatusLabel</span><span class="p">.</span><span class="n">Caption</span> <span class="p">:=</span> <span class="n">StatusText</span><span class="p">;</span>
           <span class="n">WizardForm</span><span class="p">.</span><span class="n">ProgressGauge</span><span class="p">.</span><span class="n">Style</span> <span class="p">:=</span> <span class="n">npbstNormal</span><span class="p">;</span>
       <span class="k">end</span><span class="p">;</span>
   <span class="k">finally</span>
           <span class="n">DeleteFile</span><span class="p">(</span><span class="n">ExpandConstant</span><span class="p">(</span><span class="s">'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'</span><span class="p">));</span>
   <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">var</span>
    <span class="n">ForceClose</span><span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>

<span class="k">procedure</span> <span class="n">Exterminate</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="n">ForceClose</span><span class="p">:=</span> <span class="nb">True</span><span class="p">;</span>
    <span class="n">WizardForm</span><span class="p">.</span><span class="n">Close</span><span class="p">;</span>  
<span class="k">end</span><span class="p">;</span>

<span class="k">procedure</span> <span class="n">CancelButtonClick</span><span class="p">(</span><span class="n">CurPageID</span><span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span> <span class="k">var</span> <span class="n">Cancel</span><span class="p">,</span> <span class="n">Confirm</span><span class="p">:</span> <span class="kt">Boolean</span><span class="p">);</span>
<span class="k">begin</span>
    <span class="n">Confirm</span><span class="p">:=</span> <span class="k">not</span> <span class="n">ForceClose</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div></div><h4 id="implement-checking-and-inform-user-to-download-and-install-if-the-required-net-framework-is-not-installed">Implement checking and inform user to download and install if the required .NET Framework is not installed</h4><p>Another way is to check the required .NET Framework at the beginning of installation, if not installed, inform the user to download and install the required .NET Framework. Check the code below how to implement it. The code below is taken from <a href="http://www.kynosarges.de/DotNetVersion.html">http://www.kynosarges.de/DotNetVersion.html</a>.<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Code</span><span class="p">]</span>
<span class="k">function</span> <span class="n">IsDotNetDetected</span><span class="p">(</span><span class="n">version</span><span class="p">:</span> <span class="k">string</span><span class="p">;</span> <span class="n">service</span><span class="p">:</span> <span class="kt">cardinal</span><span class="p">):</span> <span class="kt">boolean</span><span class="p">;</span>
<span class="c1">// Indicates whether the specified version and service pack of the .NET Framework is installed.
//
// version -- Specify one of these strings for the required .NET Framework version:
//    'v1.1'          .NET Framework 1.1
//    'v2.0'          .NET Framework 2.0
//    'v3.0'          .NET Framework 3.0
//    'v3.5'          .NET Framework 3.5
//    'v4\Client'     .NET Framework 4.0 Client Profile
//    'v4\Full'       .NET Framework 4.0 Full Installation
//    'v4.5'          .NET Framework 4.5
//    'v4.5.1'        .NET Framework 4.5.1
//    'v4.5.2'        .NET Framework 4.5.2
//    'v4.6'          .NET Framework 4.6
//    'v4.6.1'        .NET Framework 4.6.1
//    'v4.6.2'        .NET Framework 4.6.2
//    'v4.7'          .NET Framework 4.7
//    'v4.7.1'        .NET Framework 4.7.1
//    'v4.7.2'        .NET Framework 4.7.2
//
// service -- Specify any non-negative integer for the required service pack level:
//    0               No service packs required
//    1, 2, etc.      Service pack 1, 2, etc. required
</span><span class="k">var</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">versionKey</span><span class="p">:</span> <span class="k">string</span><span class="p">;</span>
    <span class="n">install</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">serviceCount</span><span class="p">,</span> <span class="n">versionRelease</span><span class="p">:</span> <span class="kt">cardinal</span><span class="p">;</span>
    <span class="n">success</span><span class="p">:</span> <span class="kt">boolean</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="n">versionKey</span> <span class="p">:=</span> <span class="n">version</span><span class="p">;</span>
    <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span>

    <span class="c1">// .NET 1.1 and 2.0 embed release number in version key
</span>    <span class="k">if</span> <span class="n">version</span> <span class="p">=</span> <span class="s">'v1.1'</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">versionKey</span> <span class="p">:=</span> <span class="s">'v1.1.4322'</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">else</span> <span class="k">if</span> <span class="n">version</span> <span class="p">=</span> <span class="s">'v2.0'</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">versionKey</span> <span class="p">:=</span> <span class="s">'v2.0.50727'</span><span class="p">;</span>
    <span class="k">end</span>

    <span class="c1">// .NET 4.5 and newer install as update to .NET 4.0 Full
</span>    <span class="k">else</span> <span class="k">if</span> <span class="n">Pos</span><span class="p">(</span><span class="s">'v4.'</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span> <span class="p">=</span> <span class="m">1</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">versionKey</span> <span class="p">:=</span> <span class="s">'v4\Full'</span><span class="p">;</span>
        <span class="k">case</span> <span class="n">version</span> <span class="k">of</span>
          <span class="s">'v4.5'</span><span class="p">:</span>   <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">378389</span><span class="p">;</span>
          <span class="s">'v4.5.1'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">378675</span><span class="p">;</span> <span class="c1">// 378758 on Windows 8 and older
</span>          <span class="s">'v4.5.2'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">379893</span><span class="p">;</span>
          <span class="s">'v4.6'</span><span class="p">:</span>   <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">393295</span><span class="p">;</span> <span class="c1">// 393297 on Windows 8.1 and older
</span>          <span class="s">'v4.6.1'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">394254</span><span class="p">;</span> <span class="c1">// 394271 before Win10 November Update
</span>          <span class="s">'v4.6.2'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">394802</span><span class="p">;</span> <span class="c1">// 394806 before Win10 Anniversary Update
</span>          <span class="s">'v4.7'</span><span class="p">:</span>   <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">460798</span><span class="p">;</span> <span class="c1">// 460805 before Win10 Creators Update
</span>          <span class="s">'v4.7.1'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">461308</span><span class="p">;</span> <span class="c1">// 461310 before Win10 Fall Creators Update
</span>          <span class="s">'v4.7.2'</span><span class="p">:</span> <span class="n">versionRelease</span> <span class="p">:=</span> <span class="m">461808</span><span class="p">;</span> <span class="c1">// 461814 before Win10 April 2018 Update
</span>        <span class="k">end</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>

    <span class="c1">// installation key group for all .NET versions
</span>    <span class="n">key</span> <span class="p">:=</span> <span class="s">'SOFTWARE\Microsoft\NET Framework Setup\NDP\'</span> <span class="p">+</span> <span class="n">versionKey</span><span class="p">;</span>

    <span class="c1">// .NET 3.0 uses value InstallSuccess in subkey Setup
</span>    <span class="k">if</span> <span class="n">Pos</span><span class="p">(</span><span class="s">'v3.0'</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span> <span class="p">=</span> <span class="m">1</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">key</span> <span class="p">+</span> <span class="s">'\Setup'</span><span class="p">,</span> <span class="s">'InstallSuccess'</span><span class="p">,</span> <span class="n">install</span><span class="p">);</span>
    <span class="k">end</span> <span class="k">else</span> <span class="k">begin</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">'Install'</span><span class="p">,</span> <span class="n">install</span><span class="p">);</span>
    <span class="k">end</span><span class="p">;</span>

    <span class="c1">// .NET 4.0 and newer use value Servicing instead of SP
</span>    <span class="k">if</span> <span class="n">Pos</span><span class="p">(</span><span class="s">'v4'</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span> <span class="p">=</span> <span class="m">1</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">'Servicing'</span><span class="p">,</span> <span class="n">serviceCount</span><span class="p">);</span>
    <span class="k">end</span> <span class="k">else</span> <span class="k">begin</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">'SP'</span><span class="p">,</span> <span class="n">serviceCount</span><span class="p">);</span>
    <span class="k">end</span><span class="p">;</span>

    <span class="c1">// .NET 4.5 and newer use additional value Release
</span>    <span class="k">if</span> <span class="n">versionRelease</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="n">RegQueryDWordValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">'Release'</span><span class="p">,</span> <span class="n">release</span><span class="p">);</span>
        <span class="n">success</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="p">(</span><span class="n">release</span> <span class="p">&gt;=</span> <span class="n">versionRelease</span><span class="p">);</span>
    <span class="k">end</span><span class="p">;</span>

    <span class="n">result</span> <span class="p">:=</span> <span class="n">success</span> <span class="k">and</span> <span class="p">(</span><span class="n">install</span> <span class="p">=</span> <span class="m">1</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">serviceCount</span> <span class="p">&gt;=</span> <span class="n">service</span><span class="p">);</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">function</span> <span class="n">InitializeSetup</span><span class="p">():</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="k">if</span> <span class="k">not</span> <span class="n">IsDotNetDetected</span><span class="p">(</span><span class="s">'v4.7.1'</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">MsgBox</span><span class="p">(</span><span class="s">'EXIF Reader requires Microsoft .NET Framework 4.7.1.'</span><span class="p">#</span><span class="m">13</span><span class="p">#</span><span class="m">13</span>
            <span class="s">'Please use Windows Update to install this version,'</span><span class="p">#</span><span class="m">13</span>
            <span class="s">'and then re-run the EXIF Reader setup program.'</span><span class="p">,</span> <span class="n">mbInformation</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
        <span class="n">result</span> <span class="p">:=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">end</span> <span class="k">else</span>
        <span class="n">result</span> <span class="p">:=</span> <span class="nb">true</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div></div><h3 id="heres-how-you-can-prevent-the-installation-if-newer-version-already-installed">Here’s how you can prevent the installation if newer version already installed</h3><p>In case you want to prevent the installation of your app if newer version already installed in user PC, you can apply this code within <code class="highlighter-rouge">InitializeSetup</code> function, so your installer wouldn’t downgrade existing installation.<p>Add a custom message under <code class="highlighter-rouge">[CustomMessages]</code> section:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[CustomMessages]
english.NewerVersionExists=A newer version of {#AppName} is already installed.%n%nInstaller version: {#AppVersion}%nCurrent version:
</code></pre></div></div><p>Apply this code under <code class="highlighter-rouge">[Code]</code> section to check for existing installation version:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Code</span><span class="p">]</span>
<span class="c1">// Check for existing installation version
</span><span class="k">function</span> <span class="n">InitializeSetup</span><span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="k">var</span> <span class="n">Version</span><span class="p">:</span> <span class="k">String</span><span class="p">;</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="n">RegValueExists</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span><span class="s">'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#AppId}_is1'</span><span class="p">,</span> <span class="s">'DisplayVersion'</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">begin</span>
      <span class="n">RegQueryStringValue</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span><span class="s">'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#AppId}_is1'</span><span class="p">,</span> <span class="s">'DisplayVersion'</span><span class="p">,</span> <span class="n">Version</span><span class="p">);</span>
      <span class="k">if</span> <span class="n">Version</span> <span class="p">&gt;</span> <span class="s">'{#AppVersion}'</span> <span class="k">then</span>
        <span class="k">begin</span>
          <span class="n">MsgBox</span><span class="p">(</span><span class="n">ExpandConstant</span><span class="p">(</span><span class="s">'{cm:NewerVersionExists} '</span><span class="p">+</span><span class="n">Version</span><span class="p">),</span> <span class="n">mbInformation</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
          <span class="n">Result</span> <span class="p">:=</span> <span class="nb">False</span><span class="p">;</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="k">begin</span>
          <span class="n">Result</span> <span class="p">:=</span> <span class="nb">True</span><span class="p">;</span>
        <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="k">begin</span>
      <span class="n">Result</span> <span class="p">:=</span> <span class="nb">True</span><span class="p">;</span>
    <span class="k">end</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div></div><h3 id="heres-how-you-can-automatically-uninstall-previous-installed-version">Here’s how you can automatically uninstall previous installed version</h3><p>Based on the solution from <a href="https://stackoverflow.com/a/2099805">Craig McQueen at StackOverflow</a>, your installer can check if the user already installed your app and if found, your installer will grab the <code class="highlighter-rouge">UninstallString</code> from the registry and run the uninstallation command in silent mode.<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Code</span><span class="p">]</span>
<span class="k">function</span> <span class="n">GetUninstallString</span><span class="p">():</span> <span class="k">String</span><span class="p">;</span>
<span class="k">var</span>
  <span class="n">sUnInstPath</span><span class="p">:</span> <span class="k">String</span><span class="p">;</span>
  <span class="n">sUnInstallString</span><span class="p">:</span> <span class="k">String</span><span class="p">;</span>
<span class="k">begin</span>
  <span class="n">sUnInstPath</span> <span class="p">:=</span> <span class="n">ExpandConstant</span><span class="p">(</span><span class="s">'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#emit SetupSetting("AppId")}_is1'</span><span class="p">);</span>
  <span class="n">sUnInstallString</span> <span class="p">:=</span> <span class="s">''</span><span class="p">;</span>
  <span class="k">if</span> <span class="k">not</span> <span class="n">RegQueryStringValue</span><span class="p">(</span><span class="n">HKLM</span><span class="p">,</span> <span class="n">sUnInstPath</span><span class="p">,</span> <span class="s">'UninstallString'</span><span class="p">,</span> <span class="n">sUnInstallString</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">RegQueryStringValue</span><span class="p">(</span><span class="n">HKCU</span><span class="p">,</span> <span class="n">sUnInstPath</span><span class="p">,</span> <span class="s">'UninstallString'</span><span class="p">,</span> <span class="n">sUnInstallString</span><span class="p">);</span>
  <span class="n">Result</span> <span class="p">:=</span> <span class="n">sUnInstallString</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">function</span> <span class="n">IsUpgrade</span><span class="p">():</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="k">begin</span>
  <span class="n">Result</span> <span class="p">:=</span> <span class="p">(</span><span class="n">GetUninstallString</span><span class="p">()</span> <span class="p">&lt;&gt;</span> <span class="s">''</span><span class="p">);</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">function</span> <span class="n">UnInstallOldVersion</span><span class="p">():</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="k">var</span>
  <span class="n">sUnInstallString</span><span class="p">:</span> <span class="k">String</span><span class="p">;</span>
  <span class="n">iResultCode</span><span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="k">begin</span>
  <span class="c1">// Return Values:
</span>  <span class="c1">// 1 - uninstall string is empty
</span>  <span class="c1">// 2 - error executing the UnInstallString
</span>  <span class="c1">// 3 - successfully executed the UnInstallString
</span>
  <span class="c1">// default return value
</span>  <span class="n">Result</span> <span class="p">:=</span> <span class="m">0</span><span class="p">;</span>

  <span class="c1">// get the uninstall string of the old app
</span>  <span class="n">sUnInstallString</span> <span class="p">:=</span> <span class="n">GetUninstallString</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">sUnInstallString</span> <span class="p">&lt;&gt;</span> <span class="s">''</span> <span class="k">then</span> <span class="k">begin</span>
    <span class="n">sUnInstallString</span> <span class="p">:=</span> <span class="n">RemoveQuotes</span><span class="p">(</span><span class="n">sUnInstallString</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">Exec</span><span class="p">(</span><span class="n">sUnInstallString</span><span class="p">,</span> <span class="s">'/SILENT /NORESTART /SUPPRESSMSGBOXES'</span><span class="p">,</span><span class="s">''</span><span class="p">,</span> <span class="n">SW_HIDE</span><span class="p">,</span> <span class="n">ewWaitUntilTerminated</span><span class="p">,</span> <span class="n">iResultCode</span><span class="p">)</span> <span class="k">then</span>
      <span class="n">Result</span> <span class="p">:=</span> <span class="m">3</span>
    <span class="k">else</span>
      <span class="n">Result</span> <span class="p">:=</span> <span class="m">2</span><span class="p">;</span>
  <span class="k">end</span> <span class="k">else</span>
    <span class="n">Result</span> <span class="p">:=</span> <span class="m">1</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">procedure</span> <span class="n">CurStepChanged</span><span class="p">(</span><span class="n">CurStep</span><span class="p">:</span> <span class="n">TSetupStep</span><span class="p">);</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">CurStep</span><span class="p">=</span><span class="n">ssInstall</span><span class="p">)</span> <span class="k">then</span>
  <span class="k">begin</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">IsUpgrade</span><span class="p">())</span> <span class="k">then</span>
    <span class="k">begin</span>
      <span class="n">UnInstallOldVersion</span><span class="p">();</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div></div><h3 id="heres-how-you-can-kill-existing-running-services-before-re-install-or-upgrade">Here’s how you can kill existing running services before re-install (or upgrade)</h3><p>To kill existing running services, what you need to do is to apply <a href="https://www.kymoto.org/documentation/scriptstudio/index.html?common_beforeinstall.html">BeforeInstall</a> parameter at the service file you’re going to (re)install. Take a look on the example script below:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Files]
Source: ".\bin\Service1.exe"; DestDir: "{app}"; Flags: ignoreversion; BeforeInstall: TaskKill('Service1.exe')
Source: ".\bin\Service2.exe"; DestDir: "{app}"; Flags: ignoreversion; BeforeInstall: TaskKill('Service2.exe')

[Code]
procedure TaskKill(FileName: String);
var
  ResultCode: Integer;
begin
    Exec(ExpandConstant('taskkill.exe'), '/f /im ' + '"' + FileName + '"', '', SW_HIDE,
     ewWaitUntilTerminated, ResultCode);
end;
</code></pre></div></div><h3 id="heres-how-you-can-associate-a-program-with-an-extension-during-installation">Here’s how you can associate a program with an extension during installation</h3><p>Add a property as per below in <code class="highlighter-rouge">[Setup]</code> section:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Setup]
ChangesAssociations = yes
</code></pre></div></div><p>This will tell Windows Explorer to refresh its file associations information at the end of the installation, and similarly for the uninstallation. Then, add these following registry keys:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Registry]
; Associate file extension ".exif" to my app program
Root: HKCR; Subkey: ".exif"; ValueData: "{#MyAppName}"; Flags: uninsdeletevalue; ValueType: string; ValueName: ""
Root: HKCR; Subkey: "{#MyAppName}"; ValueData: "Program {#MyAppName}"; Flags: uninsdeletekey; ValueType: string; ValueName: ""
Root: HKCR; Subkey: "{#MyAppName}\DefaultIcon"; ValueData: "{app}\{#MyAppExeName},0"; ValueType: string; ValueName: ""
Root: HKCR; Subkey: "{#MyAppName}\shell\open\command"; ValueData: """{app}\{#MyAppExeName}"" ""%1"""; ValueType: string; ValueName: ""
</code></pre></div></div><h3 id="the-bottom-line">The bottom line</h3><p>If you don’t want to use MSI-based installer for your Windows app, but you want something that is good and free, then look for no other, Inno Setup is the best and easy to use. There are a lot of example scripts out there that can help you build a great installer for your app. This is my personal preference and I’m really recommended it!</article><div class="post-date post-bottom-meta">May 23, 2018 — By Heiswayi Nrird</div></div><hr class="hidden"></div></div><hr/><div class="footer"><div class="copyright"> <a href="http://localhost:4000/">Home</a> &middot; <a href="http://localhost:4000/about">About</a> &middot; <a href="http://localhost:4000/tags">Tags</a> &middot; <a href="http://localhost:4000/feed.xml">RSS</a> &middot; <a href="#top" class="back-to-top-anchor">Back to Top</a><br> &copy; 2020 Heiswayi Nrird<br> <span class="page-load"></span></div></div><script> window.addEventListener('load', () => { setTimeout(() => { const t = window.performance && performance.timing; const round2 = num => Math.round(num * 100) / 100; if (t) { const timingStats = document.querySelector('.page-load'); const loadTime = (t.loadEventEnd - t.navigationStart) / 1000; let timingStatsHTML = `This page loaded in ${round2(loadTime)} seconds.`; timingStats.innerHTML = timingStatsHTML; } }, 0); }); </script> <script> (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script>
