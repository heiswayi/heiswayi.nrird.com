<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Expires" content="30"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title> Commonly used PHP code snippets · heiswayi.nrird.com</title><meta name="description" content=" A compilation of some commonly used PHP code snippets that I have been using for years in my PHP projects. "><meta name="keywords" content="php, commonly use php functions, php code snippets, php projects, compilation of code snippets, helpful php functions"><meta name="author" content="Heiswayi Nrird"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:url" content="http://localhost:4000/commonly-used-php-code-snippets"><meta property="og:type" content="website"><meta property="og:title" content=" Commonly used PHP code snippets · heiswayi.nrird.com "><meta property="og:description" content=" A compilation of some commonly used PHP code snippets that I have been using for years in my PHP projects. "><meta property="og:site_name" content="heiswayi.nrird.com"><meta property="og:image" content="http://localhost:4000/assets/logo.gif"><meta property="og:locale" content="en_US"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="php, commonly use php functions, php code snippets, php projects, compilation of code snippets, helpful php functions"><meta property="article:published_time" content="2017-02-11 00:00:00 +0800"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:creator" content="@heiswayi"><meta name="twitter:url" content="http://localhost:4000/commonly-used-php-code-snippets"><meta name="twitter:title" content=" Commonly used PHP code snippets · heiswayi.nrird.com "><meta name="twitter:description" content=" A compilation of some commonly used PHP code snippets that I have been using for years in my PHP projects. "><meta name="twitter:image" content="http://localhost:4000/assets/logo.gif"><meta itemprop="name" content=" Commonly used PHP code snippets · heiswayi.nrird.com "><meta itemprop="description" content=" A compilation of some commonly used PHP code snippets that I have been using for years in my PHP projects. "><meta itemprop="image" content="http://localhost:4000/assets/logo.gif"><link rel="canonical" href="http://localhost:4000/commonly-used-php-code-snippets"><link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/feed.xml"><link rel="shortcut icon" href="http://localhost:4000/assets/icons/favicon.ico"><link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4000/assets/icons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4000/assets/icons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/icons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/assets/icons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/icons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4000/assets/icons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/icons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4000/assets/icons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/assets/icons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="http://localhost:4000/assets/icons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/assets/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="http://localhost:4000/assets/icons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/assets/icons/favicon-16x16.png"><link rel="manifest" href="http://localhost:4000/assets/icons/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="http://localhost:4000/assets/icons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="http://localhost:4000/assets/css/main.css?2019.12.1.010058"> <script type="text/javascript">;window.Modernizr=function(a,b,c){function x(a){j.cssText=a}function y(a,b){return x(prefixes.join(a+";")+(b||""))}function z(a,b){return typeof a===b}function A(a,b){return!!~(""+a).indexOf(b)}function B(a,b){for(var d in a){var e=a[d];if(!A(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function C(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:z(f,"function")?f.bind(d||b):f}return!1}function D(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+n.join(d+" ")+d).split(" ");return z(b,"string")||z(b,"undefined")?B(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),C(e,b,c))}var d="2.6.2",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v={}.hasOwnProperty,w;!z(v,"undefined")&&!z(v.call,"undefined")?w=function(a,b){return v.call(a,b)}:w=function(a,b){return b in a&&z(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e}),p.cssanimations=function(){return D("animationName")};for(var E in p)w(p,E)&&(u=E.toLowerCase(),e[u]=p[E](),s.push((e[u]?"":"no-")+u));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)w(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},x(""),i=k=null,function(a,b){function k(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function l(){var a=r.elements;return typeof a=="string"?a.split(" "):a}function m(a){var b=i[a[g]];return b||(b={},h++,a[g]=h,i[h]=b),b}function n(a,c,f){c||(c=b);if(j)return c.createElement(a);f||(f=m(c));var g;return f.cache[a]?g=f.cache[a].cloneNode():e.test(a)?g=(f.cache[a]=f.createElem(a)).cloneNode():g=f.createElem(a),g.canHaveChildren&&!d.test(a)?f.frag.appendChild(g):g}function o(a,c){a||(a=b);if(j)return a.createDocumentFragment();c=c||m(a);var d=c.frag.cloneNode(),e=0,f=l(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function p(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return r.shivMethods?n(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+l().join().replace(/\w+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(r,b.frag)}function q(a){a||(a=b);var c=m(a);return r.shivCSS&&!f&&!c.hasCSS&&(c.hasCSS=!!k(a,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),j||p(a,c),a}var c=a.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,e=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f,g="_html5shiv",h=0,i={},j;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",f="hidden"in a,j=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){f=!0,j=!0}})();var r={elements:c.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:c.shivCSS!==!1,supportsUnknownElements:j,shivMethods:c.shivMethods!==!1,type:"default",shivDocument:q,createElement:n,createDocumentFragment:o};a.html5=r,q(b)}(this,b),e._version=d,e._domPrefixes=o,e._cssomPrefixes=n,e.testProp=function(a){return B([a])},e.testAllProps=D,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+s.join(" "):""),e}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};/*! lazysizes - v4.0.3 */ !function(a,b){var c=b(a,a.document);a.lazySizes=c,"object"==typeof module&&module.exports&&(module.exports=c)}(window,function(a,b){"use strict";if(b.getElementsByClassName){var c,d,e=b.documentElement,f=a.Date,g=a.HTMLPictureElement,h="addEventListener",i="getAttribute",j=a[h],k=a.setTimeout,l=a.requestAnimationFrame||k,m=a.requestIdleCallback,n=/^picture$/i,o=["load","error","lazyincluded","_lazyloaded"],p={},q=Array.prototype.forEach,r=function(a,b){return p[b]||(p[b]=new RegExp("(\\s|^)"+b+"(\\s|$)")),p[b].test(a[i]("class")||"")&&p[b]},s=function(a,b){r(a,b)||a.setAttribute("class",(a[i]("class")||"").trim()+" "+b)},t=function(a,b){var c;(c=r(a,b))&&a.setAttribute("class",(a[i]("class")||"").replace(c," "))},u=function(a,b,c){var d=c?h:"removeEventListener";c&&u(a,b),o.forEach(function(c){a[d](c,b)})},v=function(a,d,e,f,g){var h=b.createEvent("CustomEvent");return e||(e={}),e.instance=c,h.initCustomEvent(d,!f,!g,e),a.dispatchEvent(h),h},w=function(b,c){var e;!g&&(e=a.picturefill||d.pf)?e({reevaluate:!0,elements:[b]}):c&&c.src&&(b.src=c.src)},x=function(a,b){return(getComputedStyle(a,null)||{})[b]},y=function(a,b,c){for(c=c||a.offsetWidth;c<d.minSize&&b&&!a._lazysizesWidth;)c=b.offsetWidth,b=b.parentNode;return c},z=function(){var a,c,d=[],e=[],f=d,g=function(){var b=f;for(f=d.length?e:d,a=!0,c=!1;b.length;)b.shift()();a=!1},h=function(d,e){a&&!e?d.apply(this,arguments):(f.push(d),c||(c=!0,(b.hidden?k:l)(g)))};return h._lsFlush=g,h}(),A=function(a,b){return b?function(){z(a)}:function(){var b=this,c=arguments;z(function(){a.apply(b,c)})}},B=function(a){var b,c=0,e=d.throttleDelay,g=d.ricTimeout,h=function(){b=!1,c=f.now(),a()},i=m&&g>49?function(){m(h,{timeout:g}),g!==d.ricTimeout&&(g=d.ricTimeout)}:A(function(){k(h)},!0);return function(a){var d;(a=a===!0)&&(g=33),b||(b=!0,d=e-(f.now()-c),0>d&&(d=0),a||9>d?i():k(i,d))}},C=function(a){var b,c,d=99,e=function(){b=null,a()},g=function(){var a=f.now()-c;d>a?k(g,d-a):(m||e)(e)};return function(){c=f.now(),b||(b=k(g,d))}};!function(){var b,c={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};d=a.lazySizesConfig||a.lazysizesConfig||{};for(b in c)b in d||(d[b]=c[b]);a.lazySizesConfig=d,k(function(){d.init&&F()})}();var D=function(){var g,l,m,o,p,y,D,F,G,H,I,J,K,L,M=/^img$/i,N=/^iframe$/i,O="onscroll"in a&&!/glebot/.test(navigator.userAgent),P=0,Q=0,R=0,S=-1,T=function(a){R--,a&&a.target&&u(a.target,T),(!a||0>R||!a.target)&&(R=0)},U=function(a,c){var d,f=a,g="hidden"==x(b.body,"visibility")||"hidden"!=x(a,"visibility");for(F-=c,I+=c,G-=c,H+=c;g&&(f=f.offsetParent)&&f!=b.body&&f!=e;)g=(x(f,"opacity")||1)>0,g&&"visible"!=x(f,"overflow")&&(d=f.getBoundingClientRect(),g=H>d.left&&G<d.right&&I>d.top-1&&F<d.bottom+1);return g},V=function(){var a,f,h,j,k,m,n,p,q,r=c.elements;if((o=d.loadMode)&&8>R&&(a=r.length)){f=0,S++,null==K&&("expand"in d||(d.expand=e.clientHeight>500&&e.clientWidth>500?500:370),J=d.expand,K=J*d.expFactor),K>Q&&1>R&&S>2&&o>2&&!b.hidden?(Q=K,S=0):Q=o>1&&S>1&&6>R?J:P;for(;a>f;f++)if(r[f]&&!r[f]._lazyRace)if(O)if((p=r[f][i]("data-expand"))&&(m=1*p)||(m=Q),q!==m&&(y=innerWidth+m*L,D=innerHeight+m,n=-1*m,q=m),h=r[f].getBoundingClientRect(),(I=h.bottom)>=n&&(F=h.top)<=D&&(H=h.right)>=n*L&&(G=h.left)<=y&&(I||H||G||F)&&(d.loadHidden||"hidden"!=x(r[f],"visibility"))&&(l&&3>R&&!p&&(3>o||4>S)||U(r[f],m))){if(ba(r[f]),k=!0,R>9)break}else!k&&l&&!j&&4>R&&4>S&&o>2&&(g[0]||d.preloadAfterLoad)&&(g[0]||!p&&(I||H||G||F||"auto"!=r[f][i](d.sizesAttr)))&&(j=g[0]||r[f]);else ba(r[f]);j&&!k&&ba(j)}},W=B(V),X=function(a){s(a.target,d.loadedClass),t(a.target,d.loadingClass),u(a.target,Z),v(a.target,"lazyloaded")},Y=A(X),Z=function(a){Y({target:a.target})},$=function(a,b){try{a.contentWindow.location.replace(b)}catch(c){a.src=b}},_=function(a){var b,c=a[i](d.srcsetAttr);(b=d.customMedia[a[i]("data-media")||a[i]("media")])&&a.setAttribute("media",b),c&&a.setAttribute("srcset",c)},aa=A(function(a,b,c,e,f){var g,h,j,l,o,p;(o=v(a,"lazybeforeunveil",b)).defaultPrevented||(e&&(c?s(a,d.autosizesClass):a.setAttribute("sizes",e)),h=a[i](d.srcsetAttr),g=a[i](d.srcAttr),f&&(j=a.parentNode,l=j&&n.test(j.nodeName||"")),p=b.firesLoad||"src"in a&&(h||g||l),o={target:a},p&&(u(a,T,!0),clearTimeout(m),m=k(T,2500),s(a,d.loadingClass),u(a,Z,!0)),l&&q.call(j.getElementsByTagName("source"),_),h?a.setAttribute("srcset",h):g&&!l&&(N.test(a.nodeName)?$(a,g):a.src=g),f&&(h||l)&&w(a,{src:g})),a._lazyRace&&delete a._lazyRace,t(a,d.lazyClass),z(function(){(!p||a.complete&&a.naturalWidth>1)&&(p?T(o):R--,X(o))},!0)}),ba=function(a){var b,c=M.test(a.nodeName),e=c&&(a[i](d.sizesAttr)||a[i]("sizes")),f="auto"==e;(!f&&l||!c||!a[i]("src")&&!a.srcset||a.complete||r(a,d.errorClass)||!r(a,d.lazyClass))&&(b=v(a,"lazyunveilread").detail,f&&E.updateElem(a,!0,a.offsetWidth),a._lazyRace=!0,R++,aa(a,b,f,e,c))},ca=function(){if(!l){if(f.now()-p<999)return void k(ca,999);var a=C(function(){d.loadMode=3,W()});l=!0,d.loadMode=3,W(),j("scroll",function(){3==d.loadMode&&(d.loadMode=2),a()},!0)}};return{_:function(){p=f.now(),c.elements=b.getElementsByClassName(d.lazyClass),g=b.getElementsByClassName(d.lazyClass+" "+d.preloadClass),L=d.hFac,j("scroll",W,!0),j("resize",W,!0),a.MutationObserver?new MutationObserver(W).observe(e,{childList:!0,subtree:!0,attributes:!0}):(e[h]("DOMNodeInserted",W,!0),e[h]("DOMAttrModified",W,!0),setInterval(W,999)),j("hashchange",W,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(a){b[h](a,W,!0)}),/d$|^c/.test(b.readyState)?ca():(j("load",ca),b[h]("DOMContentLoaded",W),k(ca,2e4)),c.elements.length?(V(),z._lsFlush()):W()},checkElems:W,unveil:ba}}(),E=function(){var a,c=A(function(a,b,c,d){var e,f,g;if(a._lazysizesWidth=d,d+="px",a.setAttribute("sizes",d),n.test(b.nodeName||""))for(e=b.getElementsByTagName("source"),f=0,g=e.length;g>f;f++)e[f].setAttribute("sizes",d);c.detail.dataAttr||w(a,c.detail)}),e=function(a,b,d){var e,f=a.parentNode;f&&(d=y(a,f,d),e=v(a,"lazybeforesizes",{width:d,dataAttr:!!b}),e.defaultPrevented||(d=e.detail.width,d&&d!==a._lazysizesWidth&&c(a,f,e,d)))},f=function(){var b,c=a.length;if(c)for(b=0;c>b;b++)e(a[b])},g=C(f);return{_:function(){a=b.getElementsByClassName(d.autosizesClass),j("resize",g)},checkElems:g,updateElem:e}}(),F=function(){F.i||(F.i=!0,E._(),D._())};return c={cfg:d,autoSizer:E,loader:D,init:F,uP:w,aC:s,rC:t,hC:r,fire:v,gW:y,rAF:z}}});</script> <!--[if lt IE 9]> <script type="text/javascript">/** * @preserve HTML5 Shiv 3.7.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed */ !function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=t.elements;return"string"==typeof a?a.split(" "):a}function e(a,b){var c=t.elements;"string"!=typeof c&&(c=c.join(" ")),"string"!=typeof a&&(a=a.join(" ")),t.elements=c+" "+a,j(b)}function f(a){var b=s[a[q]];return b||(b={},r++,a[q]=r,s[r]=b),b}function g(a,c,d){if(c||(c=b),l)return c.createElement(a);d||(d=f(c));var e;return e=d.cache[a]?d.cache[a].cloneNode():p.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!e.canHaveChildren||o.test(a)||e.tagUrn?e:d.frag.appendChild(e)}function h(a,c){if(a||(a=b),l)return a.createDocumentFragment();c=c||f(a);for(var e=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)e.createElement(h[g]);return e}function i(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return t.shivMethods?g(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-:]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(t,b.frag)}function j(a){a||(a=b);var d=f(a);return!t.shivCSS||k||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),l||i(a,d),a}var k,l,m="3.7.2",n=a.html5||{},o=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,q="_html5shiv",r=0,s={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",k="hidden"in a,l=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){k=!0,l=!0}}();var t={elements:n.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:m,shivCSS:n.shivCSS!==!1,supportsUnknownElements:l,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:j,createElement:g,createDocumentFragment:h,addElements:e};a.html5=t,j(b)}(this,document); /*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */ /*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */ window.matchMedia=window.matchMedia||(function(e,f){var c,a=e.documentElement,b=a.firstElementChild||a.firstChild,d=e.createElement("body"),g=e.createElement("div");g.id="mq-test-1";g.style.cssText="position:absolute;top:-100em";d.style.background="none";d.appendChild(g);return function(h){g.innerHTML='&shy;<style media="'+h+'"> #mq-test-1 { width: 42px; }</style>';a.insertBefore(d,b);c=g.offsetWidth==42;a.removeChild(d);return{matches:c,media:h}}})(document); /*! Respond.js v1.1.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs */ (function(e){e.respond={};respond.update=function(){};respond.mediaQueriesSupported=e.matchMedia&&e.matchMedia("only all").matches;if(respond.mediaQueriesSupported){return}var w=e.document,s=w.documentElement,i=[],k=[],q=[],o={},h=30,f=w.getElementsByTagName("head")[0]||s,g=w.getElementsByTagName("base")[0],b=f.getElementsByTagName("link"),d=[],a=function(){var D=b,y=D.length,B=0,A,z,C,x;for(;B<y;B++){A=D[B],z=A.href,C=A.media,x=A.rel&&A.rel.toLowerCase()==="stylesheet";if(!!z&&x&&!o[z]){if(A.styleSheet&&A.styleSheet.rawCssText){m(A.styleSheet.rawCssText,z,C);o[z]=true}else{if((!/^([a-zA-Z:]*\/\/)/.test(z)&&!g)||z.replace(RegExp.$1,"").split("/")[0]===e.location.host){d.push({href:z,media:C})}}}}u()},u=function(){if(d.length){var x=d.shift();n(x.href,function(y){m(y,x.href,x.media);o[x.href]=true;u()})}},m=function(I,x,z){var G=I.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),J=G&&G.length||0,x=x.substring(0,x.lastIndexOf("/")),y=function(K){return K.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+x+"$2$3")},A=!J&&z,D=0,C,E,F,B,H;if(x.length){x+="/"}if(A){J=1}for(;D<J;D++){C=0;if(A){E=z;k.push(y(I))}else{E=G[D].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1;k.push(RegExp.$2&&y(RegExp.$2))}B=E.split(",");H=B.length;for(;C<H;C++){F=B[C];i.push({media:F.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:k.length-1,hasquery:F.indexOf("(")>-1,minw:F.match(/\(min\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:F.match(/\(max\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}}j()},l,r,v=function(){var z,A=w.createElement("div"),x=w.body,y=false;A.style.cssText="position:absolute;font-size:1em;width:1em";if(!x){x=y=w.createElement("body");x.style.background="none"}x.appendChild(A);s.insertBefore(x,s.firstChild);z=A.offsetWidth;if(y){s.removeChild(x)}else{x.removeChild(A)}z=p=parseFloat(z);return z},p,j=function(I){var x="clientWidth",B=s[x],H=w.compatMode==="CSS1Compat"&&B||w.body[x]||B,D={},G=b[b.length-1],z=(new Date()).getTime();if(I&&l&&z-l<h){clearTimeout(r);r=setTimeout(j,h);return}else{l=z}for(var E in i){var K=i[E],C=K.minw,J=K.maxw,A=C===null,L=J===null,y="em";if(!!C){C=parseFloat(C)*(C.indexOf(y)>-1?(p||v()):1)}if(!!J){J=parseFloat(J)*(J.indexOf(y)>-1?(p||v()):1)}if(!K.hasquery||(!A||!L)&&(A||H>=C)&&(L||H<=J)){if(!D[K.media]){D[K.media]=[]}D[K.media].push(k[K.rules])}}for(var E in q){if(q[E]&&q[E].parentNode===f){f.removeChild(q[E])}}for(var E in D){var M=w.createElement("style"),F=D[E].join("\n");M.type="text/css";M.media=E;f.insertBefore(M,G.nextSibling);if(M.styleSheet){M.styleSheet.cssText=F}else{M.appendChild(w.createTextNode(F))}q.push(M)}},n=function(x,z){var y=c();if(!y){return}y.open("GET",x,true);y.onreadystatechange=function(){if(y.readyState!=4||y.status!=200&&y.status!=304){return}z(y.responseText)};if(y.readyState==4){return}y.send(null)},c=(function(){var x=false;try{x=new XMLHttpRequest()}catch(y){x=new ActiveXObject("Microsoft.XMLHTTP")}return function(){return x}})();a();respond.update=a;function t(){j(true)}if(e.addEventListener){e.addEventListener("resize",t,false)}else{if(e.attachEvent){e.attachEvent("onresize",t)}}})(this); /** * Module: rem - v1.3.2 * Description: A polyfill to parse CSS links and rewrite pixel equivalents into head for non supporting browsers * Date Built: 2014-07-02 * Copyright (c) 2014 | Chuck Carpenter <chuck.carpenter@me.com>,Lucas Serven <lserven@gmail.com>; **/ !function(e){"use strict";var t=function(){var e=document.createElement("div");return e.style.cssText="font-size: 1rem;",/rem/.test(e.style.fontSize)},n=function(){for(var e=document.getElementsByTagName("link"),t=[],n=0;n<e.length;n++)"stylesheet"===e[n].rel.toLowerCase()&&null===e[n].getAttribute("data-norem")&&t.push(e[n].href);return t},r=function(){for(var e=0;e<h.length;e++)l(h[e],o)},o=function(e,t){if(p.push(e.responseText),v.push(t),v.length===h.length){for(var n=0;n<v.length;n++)a(p[n],v[n]);(h=m.slice(0)).length>0?(v=[],p=[],m=[],r()):i()}},a=function(e,t){for(var n,r=d(e).replace(/\/\*[\s\S]*?\*\//g,""),o=/[\w\d\s\-\/\\\[\]:,.'"*()<>+~%#^$_=|@]+\{[\w\d\s\-\/\\%#:!;,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!;,.'"*()]*\}/g,a=r.match(o),i=/\d*\.?\d+rem/g,s=r.match(i),c=/(.*\/)/,l=c.exec(t)[0],u=/@import (?:url\()?['"]?([^'\)"]*)['"]?\)?[^;]*/gm;null!==(n=u.exec(e));)m.push(0===n[1].indexOf("/")?n[1]:l+n[1]);null!==a&&0!==a.length&&(f=f.concat(a),g=g.concat(s))},i=function(){for(var e=/[\w\d\s\-\/\\%#:,.'"*()]+\d*\.?\d+rem[\w\d\s\-\/\\%#:!,.'"*()]*[;}]/g,t=0;t<f.length;t++){u+=f[t].substr(0,f[t].indexOf("{")+1);for(var n=f[t].match(e),r=0;r<n.length;r++)u+=n[r],r===n.length-1&&"}"!==u[u.length-1]&&(u+="\n}")}s()},s=function(){for(var e=0;e<g.length;e++)y[e]=Math.round(parseFloat(g[e].substr(0,g[e].length-3)*w))+"px";c()},c=function(){for(var e=0;e<y.length;e++)y[e]&&(u=u.replace(g[e],y[e]));var t=document.createElement("style");t.setAttribute("type","text/css"),t.id="remReplace",document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=u:t.appendChild(document.createTextNode(u))},l=function(t,n){try{var r=e.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP")||new ActiveXObject("Msxml2.XMLHTTP"):new XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(){4===r.readyState&&n(r,t)},r.send(null)}catch(o){if(e.XDomainRequest){var a=new XDomainRequest;a.open("get",t),a.onload=function(){n(a,t)},a.onerror=function(){return!1},a.send()}}},d=function(t){return e.matchMedia||e.msMatchMedia||(t=t.replace(/@media[\s\S]*?\}\s*\}/g,"")),t};if(!t()){var u="",h=n(),m=[],f=[],g=[],p=[],v=[],y=[],w="";w=function(){var e,t=document,n=t.documentElement,r=t.body||t.createElement("body"),o=!t.body,a=t.createElement("div"),i=r.style.fontSize;return o&&n.appendChild(r),a.style.cssText="width:1em; position:absolute; visibility:hidden; padding: 0;",r.style.fontSize="1em",r.appendChild(a),e=a.offsetWidth,o?n.removeChild(r):(r.removeChild(a),r.style.fontSize=i),e}(),r()}}(window);</script> <![endif]--><style> .post-date { color: #ddd; } .post-date:hover { color: #888; } .img-logo { display: block; margin-top: 2rem; } .nav { display: none; } @media print { pre .line-number, .hidden-on-print { display: none; } .post-date { color: #aaa; } }</style><a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"><div class="container"><h2 class="masthead-title"> <!-- <a href="http://localhost:4000" title="heiswayi.nrird.com" class="title">hn••• <span class="dot-red" aria-hidden="true">•</span><span class="dot-yellow" aria-hidden="true">•</span><span class="dot-green" aria-hidden="true">•</span></a> --> <a href="http://localhost:4000/" title="heiswayi nrird's personal blog" class="title"><img src="http://localhost:4000/assets/icons/android-icon-36x36.png" alt="Logo" class="img-logo"></a> <!--<span class="hidden">&nbsp;—&nbsp;</span>--></h2><div class="nav"><ul class="top-menu"><li> <a href="http://localhost:4000/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden">Home</span></a><li> <a href="http://localhost:4000/about">About</a><li> <a href="http://localhost:4000/projects">Projects</a><li> <a href="http://localhost:4000/photography">Photos</a></ul><select name="nav" onchange="location = this.value;" class="classic-menu"> <option>Navigate to... <option value="http://localhost:4000/">Home <option value="http://localhost:4000/about">About <option value="http://localhost:4000/projects">Projects <option value="http://localhost:4000/photography">Photograpy </select></div></div></div><div id="content" class="container content"><hr class="hidden"> <span class="hidden">&nbsp;</span><div class="post"><div class="post-top-meta"> <!--<div class="post-date">February 11, 2017 — By Heiswayi Nrird</div>--><h1 class="post-title">Commonly used PHP code snippets</h1></div><article id="article"><p>Few years ago, I have been actively developing some web apps in PHP. Within those years, I have been using these custom-made PHP functions for most of my projects. Well, until today, some of them I still found it useful when I’m writing PHP apps.<h3 id="hash-user-password">Hash user password</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">hashUserPassword</span><span class="p">(</span><span class="nv">$salt</span><span class="p">,</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">str_rot13</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">str_rot13</span><span class="p">(</span><span class="nv">$salt</span> <span class="o">.</span> <span class="nv">$password</span><span class="p">)))));</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="working-with-string-input-in-secure-manner">Working with string input in secure manner</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// HTML encode string</span>
<span class="k">function</span> <span class="nf">htmlEncodeString</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nx">ENT_QUOTES</span><span class="p">,</span> <span class="s1">'UTF-8'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Trim whitespace including non-breaking space.</span>
<span class="k">function</span> <span class="nf">trimString</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$charlist</span> <span class="o">=</span> <span class="s2">" </span><span class="se">\t\n\r\0\x0B\xC2\xA0</span><span class="s2">"</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">utf8_trim</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$charlist</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Convert \r\n and \r to \n</span>
<span class="k">function</span> <span class="nf">linebreakString</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">,</span>
        <span class="s2">"</span><span class="se">\r</span><span class="s2">"</span>
    <span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Only accepts alphanumeric and underscore characters.</span>
<span class="k">function</span> <span class="nf">isValidUsername</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^[a-zA-Z0-9_]+$/'</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Only accepts alphanumeric, underscore, dash, dot and whitespace characters.</span>
<span class="k">function</span> <span class="nf">isStandardCharacters</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^[a-zA-Z0-9_\-\.\s]+$/'</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Save string input from textarea for address with new line format.</span>
<span class="k">function</span> <span class="nf">address</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nb">rtrim</span><span class="p">(</span><span class="nv">$str</span><span class="p">)));</span>
<span class="p">}</span>

<span class="c1">// Normalize string.</span>
<span class="k">function</span> <span class="nf">normalize</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nb">rtrim</span><span class="p">(</span><span class="nv">$str</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// Sanitize string.</span>
<span class="k">function</span> <span class="nf">sanitize</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nb">rtrim</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$string</span><span class="p">)));</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="get-user-gravatar-photo">Get user Gravatar photo</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">getGravatar</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nv">$default</span> <span class="o">=</span> <span class="s1">'retro'</span><span class="p">,</span> <span class="nv">$size</span> <span class="o">=</span> <span class="s1">'50'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"http://www.gravatar.com/avatar/"</span> <span class="o">.</span> <span class="nb">md5</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$email</span><span class="p">)))</span> <span class="o">.</span> <span class="s2">"?d="</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$default</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&amp;s="</span> <span class="o">.</span> <span class="nv">$size</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="get-visitor-ip-address">Get visitor IP address</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">getIp</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$ipaddress</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_CLIENT_IP'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$ipaddress</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_CLIENT_IP'</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_X_FORWARDED_FOR'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$ipaddress</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_X_FORWARDED_FOR'</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$ipaddress</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$ipaddress</span> <span class="o">=</span> <span class="s1">'UNKNOWN'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$ipaddress</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="get-current-page-uri">Get current page URI</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">getCurrentPageUrl</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$s</span>        <span class="o">=</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"HTTPS"</span><span class="p">])</span> <span class="o">?</span> <span class="s1">''</span> <span class="o">:</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"HTTPS"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"on"</span><span class="p">)</span> <span class="o">?</span> <span class="s2">"s"</span> <span class="o">:</span> <span class="s2">""</span><span class="p">;</span>
    <span class="nv">$protocol</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"SERVER_PROTOCOL"</span><span class="p">]),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strpos</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"SERVER_PROTOCOL"</span><span class="p">]),</span> <span class="s2">"/"</span><span class="p">))</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">;</span>
    <span class="nv">$port</span>     <span class="o">=</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"SERVER_PORT"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"80"</span><span class="p">)</span> <span class="o">?</span> <span class="s2">""</span> <span class="o">:</span> <span class="p">(</span><span class="s2">":"</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">"SERVER_PORT"</span><span class="p">]);</span>
    <span class="k">return</span> <span class="nv">$protocol</span> <span class="o">.</span> <span class="s2">"://"</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'SERVER_NAME'</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$port</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REQUEST_URI'</span><span class="p">];</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="convert-timestamp-to-time-ago-style">Convert timestamp to time-ago style</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">timeAgo</span><span class="p">(</span><span class="nv">$timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$timestamp</span>    <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$timestamp</span><span class="p">;</span>
    <span class="nv">$current_time</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>
    <span class="nv">$diff</span>         <span class="o">=</span> <span class="nv">$current_time</span> <span class="o">-</span> <span class="nv">$timestamp</span><span class="p">;</span>
    <span class="nv">$intervals</span>    <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'year'</span> <span class="o">=&gt;</span> <span class="mi">31556926</span><span class="p">,</span>
        <span class="s1">'month'</span> <span class="o">=&gt;</span> <span class="mi">2629744</span><span class="p">,</span>
        <span class="s1">'week'</span> <span class="o">=&gt;</span> <span class="mi">604800</span><span class="p">,</span>
        <span class="s1">'day'</span> <span class="o">=&gt;</span> <span class="mi">86400</span><span class="p">,</span>
        <span class="s1">'hour'</span> <span class="o">=&gt;</span> <span class="mi">3600</span><span class="p">,</span>
        <span class="s1">'minute'</span> <span class="o">=&gt;</span> <span class="mi">60</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'just now'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' second ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' seconds ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="mi">60</span> <span class="o">&amp;&amp;</span> <span class="nv">$diff</span> <span class="o">&lt;</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'hour'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'minute'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' minute ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' minutes ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'hour'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$diff</span> <span class="o">&lt;</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'day'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'hour'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' hour ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' hours ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'day'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$diff</span> <span class="o">&lt;</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'week'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'day'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' day ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' days ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'week'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$diff</span> <span class="o">&lt;</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'month'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'week'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' week ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' weeks ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'month'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$diff</span> <span class="o">&lt;</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'year'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'month'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' month ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' months ago'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$diff</span> <span class="o">&gt;=</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'year'</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$diff</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="nv">$diff</span> <span class="o">/</span> <span class="nv">$intervals</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$diff</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' year ago'</span> <span class="o">:</span> <span class="nv">$diff</span> <span class="o">.</span> <span class="s1">' years ago'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="create-clickable-hyperlink-html-anchor-for-url-mention-and-hashtag">Create clickable hyperlink (HTML anchor) for URL, @mention and #hashtag</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// Make URL, #mention, #hashtag clickable.</span>
<span class="k">function</span> <span class="nf">makeClickable</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$output</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">'/(?i)\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()&lt;&gt;]+|\(([^\s()&lt;&gt;]+|(\([^\s()&lt;&gt;]+\)))*\))+(?:\(([^\s()&lt;&gt;]+|(\([^\s()&lt;&gt;]+\)))*\)|[^\s`!()\[\]{};:\'".,&lt;&gt;?«»“”‘’]))/'</span><span class="p">,</span>
        <span class="s1">'/(^|[^a-z0-9_])@([a-z0-9_]+)/i'</span><span class="p">,</span>
        <span class="s1">'/(^|[^a-z0-9_])#([a-z0-9_]+)/i'</span>
    <span class="p">),</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'&lt;a href="$1" target="_blank" rel="nofollow"&gt;$1&lt;/a&gt;'</span><span class="p">,</span>
        <span class="s1">' &lt;a href="profile.php?user=$2" target="_blank" rel="nofollow"&gt;@$2&lt;/a&gt;'</span><span class="p">,</span>
        <span class="s1">' &lt;a href="hashtag.php?tag=$2" target="_blank" rel="nofollow"&gt;#$2&lt;/a&gt;'</span>
    <span class="p">),</span> <span class="nv">$input</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="bb-code-style---emoticons-conversion">BB code style - emoticons conversion</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// (.*?) is a search pattern, will match with emoticon image filename.</span>
<span class="k">function</span> <span class="nf">bbCode</span><span class="p">(</span><span class="nv">$var</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$search</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'/\[\:s(.*?)\:\]/is'</span><span class="p">,</span>
        <span class="s1">'/\[\:t(.*?)\:\]/is'</span><span class="p">,</span>
        <span class="s1">'/\[\:o(.*?)\:\]/is'</span><span class="p">,</span>
        <span class="s1">'/\[\:c(.*?)\:\]/is'</span>
    <span class="p">);</span>

    <span class="nv">$replace</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'&lt;img src="img/smileys/s$1.png"&gt;'</span><span class="p">,</span>
        <span class="s1">'&lt;img src="img/tuzkiclub/t$1.gif"&gt;'</span><span class="p">,</span>
        <span class="s1">'&lt;img src="img/onionclub/o$1.gif"&gt;'</span><span class="p">,</span>
        <span class="s1">'&lt;img src="img/cutes/c$1.gif"&gt;'</span>
    <span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="nv">$search</span><span class="p">,</span> <span class="nv">$replace</span><span class="p">,</span> <span class="nv">$var</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="generate-or-get-random-key-alphanumerics">Generate or get random key (alphanumerics)</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// $len is a length of the random key.</span>
<span class="k">function</span> <span class="nf">getRandomKey</span><span class="p">(</span><span class="nv">$len</span><span class="p">,</span> <span class="nv">$readable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$hash</span><span class="p">)</span>
        <span class="nv">$key</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">sha1</span><span class="p">(</span><span class="nb">uniqid</span><span class="p">(</span><span class="nb">rand</span><span class="p">(),</span> <span class="kc">true</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$len</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$readable</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span>
            <span class="nv">$key</span> <span class="o">.=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$chars</span><span class="p">,</span> <span class="p">(</span><span class="nb">mt_rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">)),</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span>
            <span class="nv">$key</span> <span class="o">.=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">mt_rand</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">126</span><span class="p">));</span>

    <span class="k">return</span> <span class="nv">$key</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="truncate-a-long-text">Truncate a long text</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// $length = 0 will retain the original text length.</span>
<span class="k">function</span> <span class="nf">truncateLongText</span><span class="p">(</span><span class="nv">$text</span><span class="p">,</span> <span class="nv">$length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$length</span><span class="p">);</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strrpos</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="s1">' '</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nv">$length</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strrpos</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="s1">' '</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="nv">$text</span> <span class="o">=</span> <span class="nv">$tmp</span> <span class="o">.</span> <span class="s1">'...'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$text</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="generate-or-get-random-password">Generate or get random password</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">generateRandomPassword</span><span class="p">(</span><span class="nv">$length</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="nv">$strength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$vowels</span>     <span class="o">=</span> <span class="s1">'aeuy'</span><span class="p">;</span>
    <span class="nv">$consonants</span> <span class="o">=</span> <span class="s1">'bdghjmnpqrstvz'</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$strength</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$consonants</span> <span class="o">.=</span> <span class="s1">'BDGHJLMNPQRSTVWXZ'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$strength</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$vowels</span> <span class="o">.=</span> <span class="s2">"AEUY"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$strength</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$consonants</span> <span class="o">.=</span> <span class="s1">'23456789'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$strength</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$vowels</span> <span class="o">.=</span> <span class="s1">'@#$%'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$password</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nv">$alt</span>      <span class="o">=</span> <span class="nb">time</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$alt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$password</span> <span class="o">.=</span> <span class="nv">$consonants</span><span class="p">[(</span><span class="nb">rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$consonants</span><span class="p">))];</span>
            <span class="nv">$alt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$password</span> <span class="o">.=</span> <span class="nv">$vowels</span><span class="p">[(</span><span class="nb">rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$vowels</span><span class="p">))];</span>
            <span class="nv">$alt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$password</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="auto-link">Auto-link</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">autolink</span><span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$strip_tags</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$strip_tags</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$message</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Convert all URLs to clickable links</span>
    <span class="nv">$message</span>     <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">'#([s|^])(www)#i'</span><span class="p">,</span> <span class="s1">'$1http://$2'</span><span class="p">,</span> <span class="nv">$message</span><span class="p">);</span>
    <span class="nv">$pattern</span>     <span class="o">=</span> <span class="s1">'#((http|https|ftp|telnet|news|gopher|file|wais)://[^s]+)#i'</span><span class="p">;</span>
    <span class="nv">$replacement</span> <span class="o">=</span> <span class="s1">'&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;'</span><span class="p">;</span>
    <span class="nv">$message</span>     <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span> <span class="nv">$replacement</span><span class="p">,</span> <span class="nv">$message</span><span class="p">);</span>

    <span class="c1">// Convert all email matches to appropriate HTML links</span>
    <span class="nv">$pattern</span> <span class="o">=</span> <span class="s1">'#([0-9a-z]([-_.]?[0-9a-z])*@[0-9a-z]([-.]?[0-9a-z])*\.'</span><span class="p">;</span>
    <span class="nv">$pattern</span> <span class="o">.=</span> <span class="s1">'[a-wyz][a-z](fo|g|l|m|mes|o|op|pa|ro|seum|t|u|v|z)?)#i'</span><span class="p">;</span>
    <span class="nv">$replacement</span> <span class="o">=</span> <span class="s1">'&lt;a href="mailto:\1"&gt;\1&lt;/a&gt;'</span><span class="p">;</span>
    <span class="nv">$message</span>     <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span> <span class="nv">$replacement</span><span class="p">,</span> <span class="nv">$message</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$message</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="check-if-the-url-is-a-valid-url">Check if the URL is a valid URL</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">isValidUrl</span><span class="p">(</span><span class="nv">$url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$regex</span> <span class="o">=</span> <span class="s2">"((https?|ftp)\:\/\/)?"</span><span class="p">;</span> <span class="c1">// Scheme</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"([a-z0-9+!*(),;?&amp;=</span><span class="se">\$</span><span class="s2">_.-]+(\:[a-z0-9+!*(),;?&amp;=</span><span class="se">\$</span><span class="s2">_.-]+)?@)?"</span><span class="p">;</span> <span class="c1">// User and Pass</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"([a-z0-9-.]*)\.([a-z]</span><span class="si">{</span><span class="nv">2,3</span><span class="si">}</span><span class="s2">)"</span><span class="p">;</span> <span class="c1">// Host or IP</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"(\:[0-9]</span><span class="si">{</span><span class="nv">2,5</span><span class="si">}</span><span class="s2">)?"</span><span class="p">;</span> <span class="c1">// Port</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"(\/([a-z0-9+</span><span class="se">\$</span><span class="s2">_-]\.?)+)*\/?"</span><span class="p">;</span> <span class="c1">// Path</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"(\?[a-z+&amp;</span><span class="se">\$</span><span class="s2">_.-][a-z0-9;:@&amp;%=+\/</span><span class="se">\$</span><span class="s2">_.-]*)?"</span><span class="p">;</span> <span class="c1">// GET Query</span>
    <span class="nv">$regex</span> <span class="o">.=</span> <span class="s2">"(#[a-z_.-][a-z0-9+</span><span class="se">\$</span><span class="s2">_.-]*)?"</span><span class="p">;</span> <span class="c1">// Anchor</span>
    <span class="k">return</span> <span class="nb">preg_match</span><span class="p">(</span><span class="s2">"/^</span><span class="nv">$regex</span><span class="s2">$/"</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div><h3 id="simple-string-encryption-and-decryption">Simple string encryption and decryption</h3><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// Encrypt a plain string.</span>
<span class="k">function</span> <span class="nf">encryptString</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">mcrypt_encrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_256</span><span class="p">,</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span><span class="p">),</span> <span class="nv">$string</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nb">md5</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span><span class="p">))));</span>
<span class="p">}</span>

<span class="c1">// Decrypt an encrypted string.</span>
<span class="k">function</span> <span class="nf">decryptString</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nb">mcrypt_decrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_256</span><span class="p">,</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span><span class="p">),</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$string</span><span class="p">),</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nb">md5</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span><span class="p">))),</span> <span class="s2">"</span><span class="se">\0</span><span class="s2">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div></article><div class="post-date post-bottom-meta">February 11, 2017 — By Heiswayi Nrird</div></div><hr class="hidden"></div></div><hr/><div class="footer"><div class="copyright"> <i class="fa fa-anchor" aria-hidden="true"></i> <a href="http://localhost:4000/">Home</a> &middot; <a href="http://localhost:4000/about">About</a> &middot; <a href="http://localhost:4000/tags">Tags</a> &middot; <a href="http://localhost:4000/feed.xml">RSS</a> &middot; <a href="#top">Back to Top</a><br> <i class="fa fa-copyright" title="Copyright"></i> 2020 Heiswayi Nrird<br> <span class="page-load"></span></div></div><script> window.addEventListener('load', () => { setTimeout(() => { const t = window.performance && performance.timing; const round2 = num => Math.round(num * 100) / 100; if (t) { const timingStats = document.querySelector('.page-load'); const loadTime = (t.loadEventEnd - t.navigationStart) / 1000; let timingStatsHTML = `This page loaded in ${round2(loadTime)} seconds.`; timingStats.innerHTML = timingStatsHTML; } }, 0); }); </script> <script> (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script>
