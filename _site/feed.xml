<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>heiswayi nrird •••</title>
    <description>Between coding and random stuffs</description>
    <link>https://heiswayi.nrird.com/</link>
    <atom:link href="https://heiswayi.nrird.com/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 06 Jun 2018 21:00:13 +0800</pubDate>
    <lastBuildDate>Wed, 06 Jun 2018 21:00:13 +0800</lastBuildDate>
    <generator>Jekyll v3.6.2</generator>
    
      <item>
        <title>Dynamically modify the content of a file using InstallShield deferred custom action</title>
        <description>&lt;h3 id=&quot;the-problem&quot;&gt;The problem&lt;/h3&gt;

&lt;p&gt;I have a metadata file that contains the installation path of my application and this metadata file is installed by my application installer in different location than my application files. The purpose of this metadata file is it would be used by other application to display my application info and also to know the install location of my application. The problem is that the installation path is hard-coded (default path) in that metadata file, and when the user changed the install location to a different path during the installation time, the installation path is now mismatched with the one in the metadata file. Thus, this has caused the other application cannot recognize the present of my application. My application installer is created using InstallShield 2016 Basic MSI project.&lt;/p&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The solution&lt;/h3&gt;

&lt;p&gt;To resolve this problem, I need to apply a deferred custom action. The reasons to use the deferred custom action because I need to make a change to the system and only deferred custom actions can be run in elevated context.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1. Create New Set Property custom action (type 51)&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Custom action name: &lt;code class=&quot;highlighter-rouge&quot;&gt;CA_PopulateCustomActionData&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Property Name: &lt;code class=&quot;highlighter-rouge&quot;&gt;CA_UpdateMetadataFile&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Property Value: &lt;code class=&quot;highlighter-rouge&quot;&gt;[INSTALLDIR]&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Install Exec Sequence: &lt;code class=&quot;highlighter-rouge&quot;&gt;After ScheduleReboot&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Install Exec Condition: &lt;code class=&quot;highlighter-rouge&quot;&gt;NOT REMOVE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The purpose of this type-51 custom action is to pass other property value to &lt;code class=&quot;highlighter-rouge&quot;&gt;CustomActionData&lt;/code&gt; property since the deferred custom actions can only access to these built-in Windows Installer properties; &lt;code class=&quot;highlighter-rouge&quot;&gt;CustomActionData&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ProductCode&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;UserSID&lt;/code&gt;. That is the limitations of the deferred custom actions.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2. Create New InstallScript custom action as a deferred custom action&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Custom action name: &lt;code class=&quot;highlighter-rouge&quot;&gt;CA_UpdateMetadataFile&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Function Name: &lt;code class=&quot;highlighter-rouge&quot;&gt;MODIFY_METADATA&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;In-Script Execution: &lt;code class=&quot;highlighter-rouge&quot;&gt;Deferred Execution&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Install Exec Sequence: &lt;code class=&quot;highlighter-rouge&quot;&gt;After CA_PopulateCustomActionData&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Install Exec Condition: &lt;code class=&quot;highlighter-rouge&quot;&gt;NOT REMOVE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Below are the InstallScript that I used to associate with my deferred custom action above in my &lt;code class=&quot;highlighter-rouge&quot;&gt;Setup.rul&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ifx.h&quot;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;isrt.h&quot;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;iswi.h&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;prototype&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;FindAndReplace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//Global Variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrcDirFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RplcString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NUMBER&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchLen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;FindAndReplace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrcDirFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RplcString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;szString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;secPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;NUMBER&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nReturn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subPos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;begin&lt;/span&gt;
	&lt;span class=&quot;nf&quot;&gt;Disable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STATUSEX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//stop displaying the progress bar&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;ShowObjWizardPages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NEXT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//WARNING this may throw a user interface&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SrchLen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;StrLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//length of search string&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//pre-set file line number to 0&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;Din&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
		&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FileGrep&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrcDirFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RESTART&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//subPos is the number where the first char of search string was found&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;subPos&lt;/span&gt;	&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;StrFind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//firstPart is the string upto search string but not including searchString&lt;/span&gt;
			&lt;span class=&quot;nf&quot;&gt;StrSub&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;firstPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subPos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//secPart is the string after search string&lt;/span&gt;
			&lt;span class=&quot;nf&quot;&gt;StrSub&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;secPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subPos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrchLen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//new string is firstPart followed by replace string followed by secPart&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;TextSub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SUBBED&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RplcString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;szString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;firstPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;SUBBED&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;secPart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;TextSub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Substitute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;szString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//write line replacing original  &lt;/span&gt;
			&lt;span class=&quot;nf&quot;&gt;FileInsertLine&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrcDirFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;szString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REPLACE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//the code below examines the line written back for any other occurences&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//systematically searching and re-writting back to file&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//search first line again for search string&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FileGrep&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SrcDirFileName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SrchString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;svReturnLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RESTART&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;then&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Din&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//another occurence found&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;//increment line number and start all over again&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nvLineNumber&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;endwhile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//while loop exited when END_OF_FILE reached  &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prototype&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;MODIFY_METADATA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HWND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;MODIFY_METADATA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hMSI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;NUMBER&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPathBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;begin&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;installDirPathBuffer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;MsiGetProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hMSI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;CustomActionData&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPathBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ERROR_SUCCESS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;then&lt;/span&gt;
		&lt;span class=&quot;nf&quot;&gt;StrReplace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;installDirPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\\&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\\\\&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SYSINFO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bIsWow64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;then&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FILE_EXISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;PATH_TO_METADATA_FILE&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;then&lt;/span&gt;
			&lt;span class=&quot;nf&quot;&gt;FindAndReplace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;PATH_TO_METADATA_FILE&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;STRING_TO_FIND&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Is&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FILE_EXISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;PATH_TO_METADATA_FILE&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;then&lt;/span&gt;
			&lt;span class=&quot;nf&quot;&gt;FindAndReplace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;PATH_TO_METADATA_FILE&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;STRING_TO_FIND&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;installDirPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hopefully this would help others who lost.&lt;/p&gt;
</description>
        <pubDate>Tue, 05 Jun 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/dynamically-modify-content-of-file-using-installshield-deferred-custom-action</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/dynamically-modify-content-of-file-using-installshield-deferred-custom-action</guid>
        
        <category>InstallShield</category>
        
        <category>Basic MSI</category>
        
        <category>InstallScript</category>
        
        
      </item>
    
      <item>
        <title>Creating a simpler MSI setup</title>
        <description>&lt;p&gt;In my previous blog post “&lt;a href=&quot;https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset&quot;&gt;Create a basic MSI installer using WiX Toolset&lt;/a&gt;”, I shared how I create a &lt;em&gt;basic&lt;/em&gt; MSI installer for my app, however the WiX project that I shared, the example of the WiX code is &lt;strong&gt;a little bit of exaggerating&lt;/strong&gt;. This is because I need to add some extra features and also some customizations to the setup dialogs. Well, if &lt;strong&gt;file copy&lt;/strong&gt; is the only thing you need, perhaps this article can guide you through in creating a simpler MSI setup. This tutorial is based on &lt;a href=&quot;http://wixtoolset.org/releases/v3.11.1/stable&quot;&gt;WiX Toolset Compiler 3.11.1.2318&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;getting-started&quot;&gt;Getting started&lt;/h3&gt;

&lt;p&gt;To get started, you will need a &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/product.html&quot;&gt;Product&lt;/a&gt; element and this is the main structure of your WiX code:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- We'll include some preprocessor variables here --&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Anything goes here will define the design of our setup --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s add some preprocessor variables and our &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; attributes:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductName = &quot;ExampleApp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductVersion = &quot;1.0.0&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductCode = &quot;*&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyUpgradeCode = &quot;DA3EEBC7-5812-4380-BDAE-1605417230CB&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ManufacturerName = &quot;Heiswayi Nrird&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductDescription = &quot;Simplest MSI setup&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductCopyright = &quot;(c) 2018 $(var.ManufacturerName)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MainProgramFileFullname = &quot;ExampleApp.exe&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut = &quot;9ACF08F5-CFF4-43C1-84F9-418ADAAD772D&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut64 = &quot;CEA4CD03-0819-4A30-903A-22E09B254F04&quot; ?&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductCode)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;
             &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1033&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Anything goes here will define the design of our setup --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now let’s define our MSI setup &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Package&amp;gt;&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;MediaTemplate&amp;gt;&lt;/code&gt; into our &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductName = &quot;ExampleApp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductVersion = &quot;1.0.0&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductCode = &quot;*&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyUpgradeCode = &quot;DA3EEBC7-5812-4380-BDAE-1605417230CB&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ManufacturerName = &quot;Heiswayi Nrird&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductDescription = &quot;Simplest MSI setup&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductCopyright = &quot;(c) 2018 $(var.ManufacturerName)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MainProgramFileFullname = &quot;ExampleApp.exe&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut = &quot;9ACF08F5-CFF4-43C1-84F9-418ADAAD772D&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut64 = &quot;CEA4CD03-0819-4A30-903A-22E09B254F04&quot; ?&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductCode)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;
             &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1033&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Package&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;InstallScope=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;perMachine&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Comments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductCopyright)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;MediaTemplate&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;EmbedCab=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;implementing-a-major-upgrade-in-your-setup&quot;&gt;Implementing a Major Upgrade in your Setup&lt;/h3&gt;

&lt;p&gt;When creating an &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt;-based installer, you are strongly encouraged to include logic that supports &lt;a href=&quot;http://msdn.microsoft.com/library/aa369786.aspx&quot;&gt;Windows Installer major upgrades&lt;/a&gt;. Major upgrades are the most common form of updates for &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt;’s, and including support in your initial &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; release gives you flexibility in the future. Without including support for major upgrades you risk greatly complicating your distribution story if you ever need to release updates later on.&lt;/p&gt;

&lt;p&gt;The steps you need to do:-&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;You will need to set &lt;code class=&quot;highlighter-rouge&quot;&gt;Id=&quot;*&quot;&lt;/code&gt; (auto-generate) and define &lt;code class=&quot;highlighter-rouge&quot;&gt;UpgradeCode=&quot;&amp;lt;GUID&amp;gt;&quot;&lt;/code&gt; in your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; attributes.&lt;/li&gt;
  &lt;li&gt;Add &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/upgrade.html&quot;&gt;Upgrade&lt;/a&gt; element into your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; element.&lt;/li&gt;
  &lt;li&gt;Then, schedule the removal of older version in &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/installexecutesequence.html&quot;&gt;InstallExecuteSequence&lt;/a&gt; element.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- List of preprocessor variables --&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductCode)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;
             &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1033&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Package&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;InstallScope=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;perMachine&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Comments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductCopyright)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;MediaTemplate&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;EmbedCab=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- //Implement a Major Upgrade --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Upgrade&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Minimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;OnlyDetect=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DOWNGRADE_DETECTED&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Maximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMaximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;MigrateFeatures=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UPGRADE_DETECTED&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Upgrade&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallExecuteSequence&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveExistingProducts&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallInitialize&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallExecuteSequence&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A later version of [ProductName] is already installed. Setup will now exit.&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;NOT DOWNGRADE_DETECTED&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;installing-program-files-and-creating-shortcuts&quot;&gt;Installing program files and creating shortcuts&lt;/h3&gt;

&lt;p&gt;There are few things we need to do here for installing our files and shortcuts:-&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;We need to create a target directory using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/directory.html&quot;&gt;Directory&lt;/a&gt; element.&lt;/li&gt;
  &lt;li&gt;We need to create a reference to a particular target directory using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/directoryref.html&quot;&gt;DirectoryRef&lt;/a&gt; element.&lt;/li&gt;
  &lt;li&gt;For each reference, we need to create one or more components using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/component.html&quot;&gt;Component&lt;/a&gt; elements.&lt;/li&gt;
  &lt;li&gt;We need to create one or more features using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/feature.html&quot;&gt;Feature&lt;/a&gt; element and associates particular components into a particular feature.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Source of file(s) to be installed:
--&amp;gt; &quot;&amp;lt;WIX_PROJECT_DIR&amp;gt;\bin\ExampleApp.exe&quot;

Installation target directory:
--&amp;gt; &quot;C:\Program Files (x86)\Heiswayi Nrird\ExampleApp&quot;

Application shortcuts to be created:
--&amp;gt; &quot;Start Menu\ExampleApp\ExampleApp&quot; (to launch ExampleApp.exe)
--&amp;gt; &quot;Start Menu\ExampleApp\Uninstall ExampleApp&quot; (to uninstall ExampleApp)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Target directories for our program files and our shortcuts&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TARGETDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SourceDir&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramFilesFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MyProgramFiles&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramMenuFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;A directory reference for our shortcuts&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Component(s) will be here --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: A directory reference for our program file(s) will be automatically generated using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/fragment.html&quot;&gt;Fragment&lt;/a&gt; element. Will be explained later.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Components for shortcuts&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We have two components for our shortcuts; one if Windows architecture is 32-bit, another one if 64-bit. The reason for this is the location of &lt;code class=&quot;highlighter-rouge&quot;&gt;msiexec.exe&lt;/code&gt; might be located in different system folder since we have a shortcut to uninstall our program using &lt;code class=&quot;highlighter-rouge&quot;&gt;msiexec.exe&lt;/code&gt;. Only one of these two components will be used and it’s based on &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/condition.html&quot;&gt;Condition&lt;/a&gt; element defined value in each component.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT64_comp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidProgramShortcut)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/span&gt;VersionNT64&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationStartMenuShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[APPLICATIONFOLDER]$(var.MainProgramFileFullname)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONROOTDIRECTORY&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UninstallAppShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Uninstall $(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[System64Folder]msiexec.exe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Arguments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/x [ProductCode]&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CleanUpShortCut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\$(var.ManufacturerName)\$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT_comp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidProgramShortcut)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/span&gt;NOT VersionNT64&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationStartMenuShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[APPLICATIONFOLDER]$(var.MainProgramFileFullname)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONROOTDIRECTORY&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UninstallAppShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Uninstall $(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[SystemFolder]msiexec.exe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Arguments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/x [ProductCode]&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CleanUpShortCut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\$(var.ManufacturerName)\$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: Components for our program file(s) will be automatically generated using &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/fragment.html&quot;&gt;Fragment&lt;/a&gt; element. Will be explained later.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Features for our program files and our shortcuts&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramFeature&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Program Files&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentGroupRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ShortcutFeature&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shortcuts&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT64_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;generating-component-for-each-file-to-be-installed-automatically&quot;&gt;Generating component for each file to be installed automatically&lt;/h3&gt;

&lt;p&gt;Instead of manually creating one-by-one the component for each of our program files, we can use &lt;code class=&quot;highlighter-rouge&quot;&gt;heat.exe&lt;/code&gt; tool along with &lt;code class=&quot;highlighter-rouge&quot;&gt;candle.exe&lt;/code&gt; tool from WiX toolset to automatically harvest our program files and creates each component automatically.&lt;/p&gt;

&lt;p&gt;Example commands:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;eat.exe&quot;&lt;/span&gt; dir &lt;span class=&quot;s2&quot;&gt;&quot;bin&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cg&lt;/span&gt; APPLICATIONFOLDER_comp &lt;span class=&quot;nt&quot;&gt;-gg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-scom&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sreg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sfrag&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-srd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dr&lt;/span&gt; APPLICATIONFOLDER &lt;span class=&quot;nt&quot;&gt;-var&lt;/span&gt; var.ProjectDir &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dProjectDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;in&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Those commands above will generate two files; &lt;code class=&quot;highlighter-rouge&quot;&gt;Product.Files.wxs&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;_Product.Files.wixobj&lt;/code&gt;. Here is the content of &lt;code class=&quot;highlighter-rouge&quot;&gt;Product.Files.wxs&lt;/code&gt; file:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Fragment&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cmp40DD4A73DF828C932073F22AA254E961&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;{746B1D16-E4BD-421B-BEAA-1F290EBB4276}&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;File&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;fil3BA6726ABBBBF1BB587CA7587F5F7FA8&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Source=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProjectDir)\ExampleApp.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Fragment&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Fragment&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentGroup&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER_comp&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cmp40DD4A73DF828C932073F22AA254E961&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/ComponentGroup&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Fragment&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;using-built-in-wixui-dialog-sets&quot;&gt;Using built-in WixUI dialog sets&lt;/h3&gt;

&lt;p&gt;Since we have &lt;strong&gt;two features&lt;/strong&gt; defined, and we want to let the user to choose which feature they want to install, so the simplest and best suited dialog set is &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/wixui/dialog_reference/WixUI_featuretree.html&quot;&gt;WixUI_FeatureTree&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- List of preprocessor variables --&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductCode)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;
             &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1033&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
             &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Package&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;InstallScope=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;perMachine&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; 
                 &lt;span class=&quot;na&quot;&gt;Comments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductCopyright)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;MediaTemplate&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;EmbedCab=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Implemention of Major Upgrade here --&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Installation of files and shortcuts here --&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;UIRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_FeatureTree&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Example screenshot:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/hut5Op0.png&quot; alt=&quot;Simpler MSI setup&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;installer-graphics-and-icon&quot;&gt;Installer graphics and icon&lt;/h3&gt;

&lt;p&gt;If you want to customize your MSI setup graphics instead of using the default reddish WiX graphics, you can add these two WiX variables under your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; element. Assuming all of your resource files are located under &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;WIX_PROJECT_DIR&amp;gt;\res&lt;/code&gt; folder. To get the dimension for &lt;code class=&quot;highlighter-rouge&quot;&gt;WixUIBannerBmp&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;WixUIDialogBmp&lt;/code&gt;, you can check  &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/wixui/wixui_customizations.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIBannerBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;res\banner.bmp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIDialogBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;res\dialog.bmp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here’s for the MSI setup icon, similarly it goes under your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; element:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;Icon&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;icon.ico&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;res\appIcon.ico&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ARPPRODUCTICON&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;icon.ico&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;license-file&quot;&gt;License file&lt;/h3&gt;

&lt;p&gt;When you use the built-in WixUI dialog set, you need to define your license file. Simply get your &lt;code class=&quot;highlighter-rouge&quot;&gt;License.rtf&lt;/code&gt; ready and add this under your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; element. Assuming your license file is located under &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;WIX_PROJECT_DIR&amp;gt;\doc&lt;/code&gt; folder.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUILicenseRtf&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;doc\License.rtf&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;detecting-a-required-minimum-version-of-net-framework-optional&quot;&gt;Detecting a required minimum version of .NET Framework (Optional)&lt;/h3&gt;

&lt;p&gt;If your program requires a certain minimum version of .NET Framework needs to be installed in order to work, you can include a detection using &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/code&gt; element to &lt;strong&gt;check and then inform the user&lt;/strong&gt; that they need a particular version of .NET Framework to be installed before they can install and use your program files. Let’s say your program requires .NET Framework 4.7.1, here what you need to do:&lt;/p&gt;

&lt;p&gt;First, you need to include a reference &lt;code class=&quot;highlighter-rouge&quot;&gt;xmlns:netfx=&quot;...&lt;/code&gt; into your WiX file:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt; 
     &lt;span class=&quot;na&quot;&gt;xmlns:netfx=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/NetFxExtension&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Your MSI setup design here --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then, include this &lt;strong&gt;Condition&lt;/strong&gt; under your &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Product&amp;gt;&lt;/code&gt; element:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;PropertyRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NETFRAMEWORK45&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[ProductName] requires .NET Framework 4.7.1. Please install the .NET Framework then run this installer again. Setup will now exit.&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[Installed OR (NETFRAMEWORK45 AND NETFRAMEWORK45 &amp;gt;= &quot;#461308&quot;)]]&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Please note that &lt;code class=&quot;highlighter-rouge&quot;&gt;#461308&lt;/code&gt; represents a .NET Framework version for 4.7.1. You can check &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed&quot;&gt;here&lt;/a&gt; for more details about .NET Framework versions.&lt;/p&gt;

&lt;p&gt;Example screenshot:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/7TpjFrq.png&quot; alt=&quot;Required .NET Framework 4.7.1 to be installed&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;commands-to-build-your-msi-setup&quot;&gt;Commands to build your MSI setup&lt;/h3&gt;

&lt;p&gt;I’m using a batch scripting and these are the commands I use to build my MSI setup output:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@echo off
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;projectDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in

&lt;/span&gt;rem Automatically harvest program files and create each component
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;eat.exe&quot;&lt;/span&gt; dir &lt;span class=&quot;s2&quot;&gt;&quot;bin&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cg&lt;/span&gt; APPLICATIONFOLDER_comp &lt;span class=&quot;nt&quot;&gt;-gg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-scom&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sreg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sfrag&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-srd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dr&lt;/span&gt; APPLICATIONFOLDER &lt;span class=&quot;nt&quot;&gt;-var&lt;/span&gt; var.ProjectDir &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dProjectDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%projectDir%&quot;&lt;/span&gt;

rem Compile and create mySetup.msi
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ight.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cultures&lt;/span&gt;:en-US &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUIExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;mySetup.msi&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Please note that if you’re &lt;strong&gt;using built-in WixUI dialog set&lt;/strong&gt;, you need to include &lt;code class=&quot;highlighter-rouge&quot;&gt;-cultures:en-US -ext WixUIExtension&lt;/code&gt; into your &lt;code class=&quot;highlighter-rouge&quot;&gt;light.exe&lt;/code&gt; commands as shown above. For &lt;strong&gt;.NET Framework detection&lt;/strong&gt;, you need to append &lt;code class=&quot;highlighter-rouge&quot;&gt;-ext WixNetFxExtension&lt;/code&gt; into the commands.&lt;/p&gt;

&lt;h3 id=&quot;full-complete-source-code&quot;&gt;Full complete source code&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Product.wxs&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:netfx=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/NetFxExtension&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductName = &quot;ExampleApp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductVersion = &quot;2.0.0&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyProductCode = &quot;*&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MyUpgradeCode = &quot;DA3EEBC7-5812-4380-BDAE-1605417230CB&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ManufacturerName = &quot;Heiswayi Nrird&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductDescription = &quot;Demo installer for WiX basics&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductCopyright = &quot;(c) 2018 $(var.ManufacturerName)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MainProgramFileFullname = &quot;ExampleApp.exe&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut = &quot;9ACF08F5-CFF4-43C1-84F9-418ADAAD772D&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProgramShortcut64 = &quot;CEA4CD03-0819-4A30-903A-22E09B254F04&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define LicenseEulaFile = &quot;License.rtf&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define BannerBmp = &quot;banner.bmp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define DialogBmp = &quot;dialog.bmp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define AppIcon = &quot;appIcon.ico&quot; ?&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductCode)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1033&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Package&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;InstallScope=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;perMachine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Comments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductCopyright)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;MediaTemplate&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;EmbedCab=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUILicenseRtf&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.LicenseEulaFile)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIBannerBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.BannerBmp)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIDialogBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.DialogBmp)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Icon&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;icon.ico&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppIcon)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ARPPRODUCTICON&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;icon.ico&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Upgrade&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyUpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Minimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;OnlyDetect=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DOWNGRADE_DETECTED&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Maximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMaximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;MigrateFeatures=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UPGRADE_DETECTED&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Upgrade&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallExecuteSequence&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveExistingProducts&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallInitialize&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallExecuteSequence&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A later version of [ProductName] is already installed. Setup will now exit.&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;NOT DOWNGRADE_DETECTED&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;PropertyRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NETFRAMEWORK45&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[ProductName] requires .NET Framework 4.7.1. Please install the .NET Framework then run this installer again. Setup will now exit.&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[Installed OR (NETFRAMEWORK45 AND NETFRAMEWORK45 &amp;gt;= &quot;#461308&quot;)]]&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TARGETDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SourceDir&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramFilesFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MyProgramFiles&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramMenuFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ManufacturerName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT64_comp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidProgramShortcut64)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/span&gt;VersionNT64&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationStartMenuShortcut64&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[APPLICATIONFOLDER]$(var.MainProgramFileFullname)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONROOTDIRECTORY&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UninstallAppShortcut64&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Uninstall $(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[System64Folder]msiexec.exe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Arguments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/x [ProductCode]&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CleanUpShortCut64&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\$(var.ManufacturerName)\$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT_comp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidProgramShortcut)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/span&gt;NOT VersionNT64&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationStartMenuShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[APPLICATIONFOLDER]$(var.MainProgramFileFullname)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONROOTDIRECTORY&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UninstallAppShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Uninstall $(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[SystemFolder]msiexec.exe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Arguments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/x [ProductCode]&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CleanUpShortCut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\$(var.ManufacturerName)\$(var.MyProductName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramFeature&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Program Files&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentGroupRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPLICATIONFOLDER_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ShortcutFeature&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shortcuts&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT64_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;APPSHORTCUT_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;UIRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_FeatureTree&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 02 Jun 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/creating-simpler-msi-setup</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/creating-simpler-msi-setup</guid>
        
        <category>WiX Toolset</category>
        
        <category>Windows Installer</category>
        
        <category>MSI</category>
        
        
      </item>
    
      <item>
        <title>Create MSI bootstrapper (setup.exe) using WiX Burn</title>
        <description>&lt;p&gt;In my previous blog post “&lt;a href=&quot;https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset&quot;&gt;Create a basic MSI installer using WiX Toolset&lt;/a&gt;”, I have shared about how I created a basic &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; installer using WiX toolset for my app deployment. And today, I’m going to share how I create a bootstrapper i.e. setup.exe using WiX to chain the installations that are packaged as &lt;code class=&quot;highlighter-rouge&quot;&gt;*.msi&lt;/code&gt;. One of the reasons you need a bootstrapper is because there is only one instance of &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; can be run at a time. Using a bootstrapper, you can install the required prerequisites for your app deployment, e.g. .NET Framework.&lt;/p&gt;

&lt;p&gt;Example of my bootstrapper UI
&lt;img src=&quot;https://i.imgur.com/G6mL3rE.png&quot; alt=&quot;Example of my bootstrapper UI&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;example-of-project-files-structure-for-creating-the-bootstrapper&quot;&gt;Example of project files structure for creating the bootstrapper&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;root&amp;gt;
├── bootstrapper_res\
|   ├── banner.png
|   ├── ClassicTheme.wxl
|   └── ClassicTheme.xml
├── prereq\
|   └── NDP471-KB4033344-Web.exe
├── Bootstrapper.wxs
├── MakeBootstrapper.bat
├── myAppSetup.msi
├── ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Folders:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bootstrapper_res&lt;/code&gt; - Contains graphic resource and theme files for my WiX bootstrapper UI&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;prereq&lt;/code&gt; - Contains necessary prerequisites to be bundled into my bootstrapper&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;WiX project files:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Bootstrapper.wxs&lt;/code&gt; - Main file for generating the bootstrapper (&lt;code class=&quot;highlighter-rouge&quot;&gt;*.exe&lt;/code&gt; file)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MakeBootstrapper.bat&lt;/code&gt; - Batch script to compile &lt;code class=&quot;highlighter-rouge&quot;&gt;Bootstrapper.wxs&lt;/code&gt; file&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;myAppSetup.msi&lt;/code&gt; - Example of &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; installer file for my app installation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;banner.png&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ClassicTheme.wxl&lt;/code&gt; &amp;amp; &lt;code class=&quot;highlighter-rouge&quot;&gt;ClassicTheme.xml&lt;/code&gt; - Modified theme for customizing the bootstrapper interface (&lt;a href=&quot;https://github.com/heiswayi/wix-msi/tree/master/exe-bootstrapper/bootstrapper_res&quot;&gt;Check this GitHub repo for the source code&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;bootstrapper-source-code&quot;&gt;Bootstrapper source code&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Bootstrapper.wxs&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;xmlns:bal=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/BalExtension&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;xmlns:util=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/UtilExtension&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Bundle&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MiniAppKiller Bundle&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(bind.packageVersion.MainPackage)&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Heiswayi Nrird&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56888B11-D5D0-4068-8E94-39E696DAD1D4&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;Copyright=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(C) 2018 Heiswayi Nrird&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;IconSourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;images/app.ico&quot;&lt;/span&gt; 
        &lt;span class=&quot;na&quot;&gt;AboutUrl=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://heiswayi.nrird.com&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Layout setup --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;BootstrapperApplicationRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixStandardBootstrapperApplication.HyperlinkLicense&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;bal:WixStandardBootstrapperApplication&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;LicenseUrl=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://heiswayi.nrird.com&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;LogoFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bootstrapper_res/banner.png&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;ThemeFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bootstrapper_res/ClassicTheme.xml&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;LocalizationFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bootstrapper_res/ClassicTheme.wxl&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;LicenseFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;app\Eula-en.rtf&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;SuppressOptionsUI=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/BootstrapperApplicationRef&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;util:RegistrySearch&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKLM&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Version&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Variable=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Net4FullVersion&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;util:RegistrySearch&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKLM&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Version&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Variable=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Net4x64FullVersion&quot;&lt;/span&gt; 
            &lt;span class=&quot;na&quot;&gt;Win64=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Chain&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;DisableSystemRestore=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;ExePackage&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Net471&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Microsoft .NET Framework 4.7.1 Web Installer&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Cache=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;PerMachine=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Permanent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Vital=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;InstallCommand=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/passive /norestart&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;prereq\NDP471-KB4033344-Web.exe&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;DetectCondition=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(Net4FullVersion = &amp;amp;quot;4.7.2558&amp;amp;quot;) AND (NOT VersionNT64 OR (Net4x64FullVersion = &amp;amp;quot;4.7.2558&amp;amp;quot;))&quot;&lt;/span&gt;
                &lt;span class=&quot;na&quot;&gt;InstallCondition=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(VersionNT &amp;gt;= v6.0 OR VersionNT64 &amp;gt;= v6.0) AND (NOT (Net4FullVersion = &amp;amp;quot;4.7.2558&amp;amp;quot; OR Net4x64FullVersion = &amp;amp;quot;4.7.2558&amp;amp;quot;))&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;RollbackBoundary&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;MsiPackage&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MainPackage&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;setup-1.0.msi&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;DisplayInternalUI=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; 
                &lt;span class=&quot;na&quot;&gt;Vital=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Chain&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Bundle&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more detailed on other available element properties, please take a look on &lt;a href=&quot;http://wixtoolset.org/documentation/manual/v3/xsd/wix/bundle.html&quot;&gt;WiX Bundle Element documentation here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;batch-script-for-compiling-the-wix-project&quot;&gt;Batch script for compiling the WiX project&lt;/h3&gt;

&lt;p&gt;These are the WiX toolset that I use in the script below:-&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;candle.exe&lt;/strong&gt; - To generate &lt;code class=&quot;highlighter-rouge&quot;&gt;*.wixobj&lt;/code&gt; file&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;light.exe&lt;/strong&gt; - To compile &lt;code class=&quot;highlighter-rouge&quot;&gt;*.wixobj&lt;/code&gt; and generate the bootstrapper file (&lt;code class=&quot;highlighter-rouge&quot;&gt;*.exe&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;MakeBootstrapper.bat&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@echo off

&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Bootstrapper.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Bootstrapper.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixBalExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ight.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Bootstrapper.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Bootstrapper.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixBalExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;more-screenshots-of-my-bootstrapper&quot;&gt;More screenshots of my bootstrapper&lt;/h3&gt;

&lt;p&gt;Installing the packages
&lt;img src=&quot;https://i.imgur.com/0dMOkiD.png&quot; alt=&quot;Installing the packages&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When user cancelled installation
&lt;img src=&quot;https://i.imgur.com/3Ou5t8d.png&quot; alt=&quot;When user cancelled installtion&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;extra-good-readings-and-references&quot;&gt;Extra good readings and references&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://makemsi-manual.dennisbareis.com/bootstrapper_exe_programs.htm&quot;&gt;Windows Installer Basics: Bootstrapper EXE Programs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.joyofsetup.com/tag/best-practices/&quot;&gt;Joy of Setup - Best Practices&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.symantec.com/connect/articles/understanding-difference-between-exe-and-msi&quot;&gt;Understanding the Difference Between .EXE and .MSI&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.ghacks.net/2009/03/23/msi-or-exe-setup/&quot;&gt;hould you run MSI or EXE Setup files?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;And a lot more… the rest are on Google in case you don’t know :P&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Tue, 29 May 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/create-msi-bootstrapper-using-wix-burn</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/create-msi-bootstrapper-using-wix-burn</guid>
        
        <category>WiX Toolset</category>
        
        <category>Windows Installer</category>
        
        <category>MSI</category>
        
        
      </item>
    
      <item>
        <title>Create a basic MSI installer using WiX Toolset</title>
        <description>&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/9RPzlsd.png&quot; alt=&quot;Welcome dialog&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I have been working with Windows-based installation development for some time, and for some software projects that required simple (read: file copy), deployment and no prerequisites installation, I preferred to create a basic &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; installer. And to do that, my first go-to tool is &lt;a href=&quot;http://wixtoolset.org/&quot;&gt;WiX Toolset&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Windows Installer XML (WiX) Toolset is a Microsoft open source project used to create the Office 2007 installer. WiX includes some advanced capabilities, but it has a steep learning curve even though the scripting language is XML-based. It took me some time to learn both technologies (WiX and Windows Installer itself), but it’s worth spending the time.&lt;/p&gt;

&lt;p&gt;There are some advantages working with WiX toolset for creating Windows app installer and here are some of them that I can highlight based on my personal experience, in case you are new to WiX toolset:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Source code in XML format, better clarity, easy to modify and debug.&lt;/li&gt;
  &lt;li&gt;Fresh clean &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; installer, no extra stuffs embedded, smaller file size.&lt;/li&gt;
  &lt;li&gt;Everything can be done using command-line, easy to integrated into CI build.&lt;/li&gt;
  &lt;li&gt;Easy to source-control and edit using any code editor.&lt;/li&gt;
  &lt;li&gt;Good community support and a lot of examples. (You get one here too!)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here I would like to share example of my WiX project. Hopefully it could help for those who are looking to get started with WiX toolset, or for those may need to see more examples of WiX-based projects for personal reference.&lt;/p&gt;

&lt;h3 id=&quot;example-of-my-wix-project-files-structure&quot;&gt;Example of my WiX project files structure&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;root&amp;gt;
├── app\
|   ├── config.ini
|   ├── Eula-en.rtf
|   ├── filters.txt
|   └── MiniAppKiller.exe
├── images\
|   ├── app.ico
|   ├── Dialog.bmp
|   └── TopBanner.bmp
├── MakeInstaller.bat
├── Product.Loc-en.wxl
├── Product.Var.wxi
└── Poduct.wxs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Folders:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt; - Contains my application files to be installed&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;images&lt;/code&gt; - Contains graphic resource for customizing the installer UI.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;WiX project files:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Product.wxs&lt;/code&gt; - Main file&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Product.Var.wxi&lt;/code&gt; - Variables file. Included automatically into the main file during compile time.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Product.Loc-en.wxl&lt;/code&gt; - Localization file for custom strings used in the main file&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MakeInstaller.bat&lt;/code&gt; - The batch script to compile WiX project files&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;preprocessor-variables-file&quot;&gt;Preprocessor variables file&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Product.Var.wxi&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Include&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- #### USER-DEFINED VARIABLES THAT DEFINED DURING BUILD #### --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define AppVersion=&quot;$(var.BUILD_VERSION)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Upgrade code HAS to be the same for all updates. Once you've chosen it, don't change it. --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define UpgradeCode=&quot;$(var.BUILD_GUID)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Project directory --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProjectDir=&quot;$(var.BUILD_PROJECTDIR)&quot; ?&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- #### USER-DEFINED VARIABLES #### --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Set to 1 if you want to enable major upgrade --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define EnableMajorUpgrade=&quot;1&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define AppExeName=&quot;MiniAppKiller.exe&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- App Info --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- The URL for Add/Remove Programs --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define InfoURL=&quot;https://heiswayi.nrird.com/&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- If your app supports both platform (x86 &amp;amp; x64), you have to create separate MSI. --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define Platform=&quot;x86&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- App Icon --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define AppIconSource=&quot;images\app.ico&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Other resources --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- TopBanner.bmp: 499x58 px --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ImageTopBannerSource=&quot;images\TopBanner.bmp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Dialog.bmp: 499x301 px; Graphical area: 165x301 px --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ImageDialogSource=&quot;images\Dialog.bmp&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- GUIDs --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidInstallLocation=&quot;3F638FF4-C84D-480F-83B8-31CCE0C10617&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidApplicationShortcut=&quot;433B5301-96B9-4FD4-BD86-2A54FB5B9570&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidApplicationShortcutDesktop=&quot;00EA4184-52A8-478D-8A89-47892454B0DD&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define GuidProductId=&quot;9996A526-5535-4DEB-BB56-B4D84BA96E38&quot; ?&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- #### DO NOT EDIT ANYTHING BELOW THIS LINE #### --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?if $(var.EnableMajorUpgrade) = 1 ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductId = &quot;*&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?else ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define ProductId = &quot;$(var.GuidProductId)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?endif ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?if $(var.Platform) = x64 ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define Win64 = &quot;yes&quot; ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define PlatformProgramFilesFolder = &quot;ProgramFiles64Folder&quot; ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MainExeSourcePath = &quot;$(var.ProjectDir)\$(var.AppExeName)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?else ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define Win64 = &quot;no&quot; ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define PlatformProgramFilesFolder = &quot;ProgramFilesFolder&quot; ?&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;cp&quot;&gt;&amp;lt;?define MainExeSourcePath = &quot;$(var.ProjectDir)\$(var.AppExeName)&quot; ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?endif ?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Include&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;BUILD_VERSION&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;BUILD_GUID&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;BUILD_PROJECTDIR&lt;/code&gt; are preprocessor variables that will be used in &lt;code class=&quot;highlighter-rouge&quot;&gt;MakeInstaller.bat&lt;/code&gt; file to compile the WiX files.&lt;/p&gt;

&lt;h3 id=&quot;main-wix-file&quot;&gt;Main WiX file&lt;/h3&gt;

&lt;p&gt;Below is the source code for my main WiX file to create a &lt;code class=&quot;highlighter-rouge&quot;&gt;.msi&lt;/code&gt; installer. In this file, I have combined the code for my installer UI which includes &lt;strong&gt;few custom dialogs&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Custom license agreement dialog&lt;/li&gt;
  &lt;li&gt;Custom upgrade dialog&lt;/li&gt;
  &lt;li&gt;Custom install dir dialog (for Desktop shortcut option checkbox)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/FPHfm08.png&quot; alt=&quot;Create Desktop shortcut option&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Following are the &lt;strong&gt;extra features other the defaults&lt;/strong&gt; that have been implemented into the source code:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Detect for minimum .NET Framework and OS version.&lt;/li&gt;
  &lt;li&gt;Detect if newer version is installed, and abort the installation.&lt;/li&gt;
  &lt;li&gt;Detect if older version is installed, show Upgrade Welcome Dialog, and skip License Agreement Dialog.&lt;/li&gt;
  &lt;li&gt;Prompt user to close if the application executable file is running during upgrade.&lt;/li&gt;
  &lt;li&gt;Create registry to memorize the installation directory path.&lt;/li&gt;
  &lt;li&gt;Create Start Menu and Desktop shortcut. Desktop shortcut is optional, user can choose to not create it.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Product.wxs&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Add xmlns:util namespace definition to be able to use stuff from WixUtilExtension.dll --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Wix&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:util=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/UtilExtension&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Include defined variables --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;&amp;lt;?include Product.Var.wxi ?&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- The upgrade code must never change as long as the product lives! --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Product IDs must be autogenerated (*) or else major upgrades will not work --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Product&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProductId)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Language=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.Language)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Manufacturer=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ManufacturerName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;UpgradeCode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.UpgradeCode)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Package IDs are valid for a single package version only - they are autogenerated by WiX --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Let's require Windows Installer 4.0 (included in Vista) --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- And ALWAYS install per machine!!! --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Package&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;*&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;InstallerVersion=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;400&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Compressed=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;InstallPrivileges=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;elevated&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;InstallScope=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;perMachine&quot;&lt;/span&gt;  &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Comments=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.Comments) $(var.AppVersion)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Define icons (ID should not be longer than 18 chars and must end with &quot;.exe&quot;) --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Icon&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;AppIcon.exe&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppIconSource)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- We do not have more than one medium (Floppy, CD, ...). Everything in one file. --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Media&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Cabinet=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;media1.cab&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;EmbedCab=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Upgrade settings --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Upgrade&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.UpgradeCode)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;OnlyDetect=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Minimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NEWER_VERSION_FOUND&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;UpgradeVersion&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Minimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0.0.0.0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMinimum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Maximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppVersion)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IncludeMaximum=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;OLDER_VERSION_FOUND&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Upgrade&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- License agreement text: dummy. Real text is set in WXS file --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;WixVariable Id=&quot;WixUILicenseRtf&quot; Value=&quot;dummy&quot; /&amp;gt;--&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- UI customization --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIBannerBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ImageTopBannerSource)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;WixVariable&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIDialogBmp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ImageDialogSource)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Binary&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;imageDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ImageDialogSource)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Set properties for Add/Remove Programs --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ARPPRODUCTICON&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;AppIcon.exe&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ARPHELPLINK&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.InfoURL)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Remove repair --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;Property Id=&quot;ARPNOREPAIR&quot; Value=&quot;yes&quot; Secure=&quot;yes&quot; /&amp;gt;--&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Remove modify --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;Property Id=&quot;ARPNOMODIFY&quot; Value=&quot;yes&quot; Secure=&quot;yes&quot; /&amp;gt;--&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WIXUI_INSTALLDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLDIR&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DialogBitmap&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;imageDialog&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Property&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Determine the directory of a previous installation (if one exists). If not INSTALLDIR stays empty --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLDIR&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistrySearch&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DetermineInstallLocation&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;raw&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKLM&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallLocation&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Property&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UpgradeDlgHasShown&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ADDDESKTOPSHORTCUT&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt; 

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Reference the global NETFRAMEWORK35 property to check if it exists --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;PropertyRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NETFRAMEWORK35&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;    
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- 
        Startup conditions that checks if .Net Framework 3.5 is installed or if 
        we're running the OS higher than Windows XP SP2.
        If not the installation is aborted.
        By doing the (Installed OR ...) property means that this condition will only 
        be evaluated if the app is being installed and not on uninstall or changing
        --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.DotNetFrameworkNeeded)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[Installed OR NETFRAMEWORK35]]&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Message=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.AppNotSupported)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[Installed OR ((VersionNT &amp;gt;= 501 AND ServicePackLevel &amp;gt;= 2) OR (VersionNT &amp;gt;= 502))]]&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Set up ARPINSTALLLOCATION property (http://blogs.technet.com/b/alexshev/archive/2008/02/09/from-msi-to-wix-part-2.aspx) --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CustomAction&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SetARPINSTALLLOCATION&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ARPINSTALLLOCATION&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[INSTALLDIR]&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Save the command line value INSTALLDIR and restore it later in the sequence or it will be overwritten by the value saved to the registry during an upgrade --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- http://robmensching.com/blog/posts/2010/5/2/the-wix-toolsets-remember-property-pattern/ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CustomAction&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SaveCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'CMDLINE_INSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[INSTALLDIR]'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Execute=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'firstSequence'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CustomAction&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SetFromCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'INSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'[CMDLINE_INSTALLDIR]'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Execute=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'firstSequence'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;CustomAction&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewerVersionFound&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Error=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.NewerVersionInstalled)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- UI Sequence --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallUISequence&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Check for newer versions with FindRelatedProducts and execute the custom action after it --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewerVersionFound&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FindRelatedProducts&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[NEWER_VERSION_FOUND]]&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Custom&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SaveCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Before=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'AppSearch'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SetFromCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'AppSearch'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;CMDLINE_INSTALLDIR&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Custom&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallUISequence&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Exec Sequence --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- This is the main installer sequence run when the product is actually installed --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallExecuteSequence&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Check for newer versions with FindRelatedProducts and execute the custom action after it --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewerVersionFound&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FindRelatedProducts&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[NEWER_VERSION_FOUND]]&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Custom&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Remove the previous versions of the product --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveExistingProducts&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallInitialize&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- WixCloseApplications is a built in custom action that uses util:CloseApplication below --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixCloseApplications&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Before=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallInitialize&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Determine the install location after the install path has been validated by the installer --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SetARPINSTALLLOCATION&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallValidate&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Custom&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SaveCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Before=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'AppSearch'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Custom&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'SetFromCmdLineValueINSTALLDIR'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;After=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'AppSearch'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;CMDLINE_INSTALLDIR&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Custom&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallExecuteSequence&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- This will ask the user to close the app if it's running while upgrading --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;util:CloseApplication&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CloseApp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;CloseMessage=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.CloseRunningApp)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ElevatedCloseMessage=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;RebootPrompt=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.AppExeName)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Outermost folder (kind of virtual). Fixed entry. --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TARGETDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SourceDir&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- We start building our directory structure here --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &quot;ProgramFilesFolder&quot; is a variable containing the absolute path. --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- For a list of folder variables, see: http://msdn.microsoft.com/en-us/library/aa372057%28VS.85%29.aspx --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.PlatformProgramFilesFolder)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- All folders from here on are relative to their parent. --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MyProgramFiles&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ManufacturerName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- INSTALLDIR is a property name. We need it later for the UI (to be able to change the install dir. --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Registry entries --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RegValInstallLocation_comp&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidInstallLocation)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Do NOT use the application's default registry key here, because THIS key will be removed on uninstall
                 (important when installing a newer version, because that is uninstall followed by install) --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryKey&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKLM&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallLocation&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[INSTALLDIR]&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;string&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/RegistryKey&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Shortcut folders --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgramMenuFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Directory&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DesktopFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Desktop&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Shortcut components --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidApplicationShortcut)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationStartMenuShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[INSTALLDIR]$(var.AppExeName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLFOLDER&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RemoveApplicationProgramsFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationProgramsFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;DirectoryRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DesktopFolder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Component&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutDesktop&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Guid=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.GuidApplicationShortcutDesktop)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Shortcut&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationDesktopShortcut&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ProductDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[INSTALLDIR]$(var.AppExeName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;WorkingDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLFOLDER&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RemoveFolder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RemoveDesktopFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Directory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DesktopFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;On=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uninstall&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;RegistryValue&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Root=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HKCU&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;installed&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;integer&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;KeyPath=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&amp;gt;&lt;/span&gt;ADDDESKTOPSHORTCUT&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Component&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/DirectoryRef&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Features define which parts of the application can be installed in a custom installation --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Complete&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.ApplicationName)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.FeatureCompleteDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Display=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;expand&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ConfigurableDirectory=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLDIR&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- A feature block for the main (GUI) program and all its dependencies --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MainProgram&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.FeatureMainProgramTitle)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Description=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.FeatureMainProgramDescription)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Level=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Installation folder: Generated automatically by heat.exe --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentGroupRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSTALLDIR_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Registry entries --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RegValInstallLocation_comp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Shortcuts --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcut&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;ComponentRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationShortcutDesktop&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Feature&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;UI&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MyWixUI&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;TextStyle&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Font_Normal&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;FaceName=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Tahoma&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Size=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;8&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;TextStyle&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Font_Bigger&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;FaceName=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Tahoma&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Size=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;12&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;TextStyle&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Font_Title&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;FaceName=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Tahoma&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Size=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;9&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Bold=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DefaultUIFont&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Font_Normal&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Mode&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InstallDir&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BrowseDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DiskCostDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ErrorDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FatalError&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FilesInUse&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MsiRMFilesInUse&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PrepareDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProgressDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ResumeDlg&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;DialogRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UserExit&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Dialog&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomLicenseAgreementDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;270&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.LicenseAgreementDlg_Title)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LicenseAcceptedCheckBox&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CheckBox&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;207&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;330&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;18&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;CheckBoxValue=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LicenseAccepted&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.LicenseAgreementDlgLicenseAcceptedCheckBox)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;180&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUIBack)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;236&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Default=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUINext)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnWaitDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WaitForCostingDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;CostingComplete = 1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;disable&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[LicenseAccepted &amp;lt;&amp;gt; &quot;1&quot;]]&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Condition&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;enable&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;LicenseAccepted = &quot;1&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Condition&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cancel&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;304&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Cancel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUICancel)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CancelDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BannerBitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Bitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;44&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;TabSkip=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.LicenseAgreementDlgBannerBitmap)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LicenseText&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ScrollableText&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;60&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;330&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;140&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Sunken=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;TabSkip=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- This is the original line --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;Text SourceFile=&quot;!(wix.WixUILicenseRtf=$(var.LicenseRtf))&quot; /&amp;gt;--&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- To enable EULA localization we change it to this: --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Text&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;SourceFile=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$(var.ProjectDir)\!(loc.LicenseRtf)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- In each of the localization files (wxl) put a line like this:
            &amp;lt;String Id=&quot;LicenseRtf&quot; Overridable=&quot;yes&quot;&amp;gt;EULA_en-us.rtf&amp;lt;/String&amp;gt;--&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Print&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;112&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUIPrint)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DoAction&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIPrintEula&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BannerLine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Line&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;44&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BottomLine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Line&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;234&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;25&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;23&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;340&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.LicenseAgreementDlgDescription)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Title&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;6&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.LicenseAgreementDlgTitle)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Dialog&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Dialog&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomUpgradeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;270&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.UpgradeWelcomeDlgTitle)&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoMinimize=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;180&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Disabled=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUIBack)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WelcomeDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;236&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Default=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUINext)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UpgradeDlgHasShown&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cancel&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;304&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Cancel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUICancel)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CancelDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Bitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Bitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;234&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;TabSkip=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[DialogBitmap]&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BottomLine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Line&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;234&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;374&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;135&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;70&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;220&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;30&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Text&amp;gt;&lt;/span&gt;!(loc.UpgradeWelcomeDlgMessage)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Text&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Title&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;135&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;220&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;60&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Text&amp;gt;&lt;/span&gt;{\WixUI_Font_Bigger}!(loc.UpgradeWelcomeDlgHeaderTitle)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Text&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Dialog&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Dialog&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;270&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlg_Title)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;236&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Default=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUINext)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;180&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUIBack)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cancel&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;304&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;243&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Cancel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.WixUICancel)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CancelDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Control&amp;gt;&lt;/span&gt;

                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;25&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;23&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;280&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlgDescription)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Title&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;6&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;15&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Transparent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlgTitle)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BannerBitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Bitmap&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;44&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;TabSkip=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;no&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlgBannerBitmap)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BannerLine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Line&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;44&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BottomLine&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Line&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;234&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;370&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FolderLabel&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Text&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;60&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;290&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;30&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;NoPrefix=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlgFolderLabel)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Folder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PathEdit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;100&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;320&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;18&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WIXUI_INSTALLDIR&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Indirect=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ChangeFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PushButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;120&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;56&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.InstallDirDlgChange)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;Control&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DesktopShortcutCheckBox&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CheckBox&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;X=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Y=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;160&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;290&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;17&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ADDDESKTOPSHORTCUT&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;CheckBoxValue=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Text=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!(loc.CreateDesktopShortcutCheckboxText)&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt; 
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Dialog&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WelcomeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomLicenseAgreementDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;NOT Installed&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;Publish Dialog=&quot;WelcomeDlg&quot; Control=&quot;Next&quot; Event=&quot;NewDialog&quot; Value=&quot;VerifyReadyDlg&quot;&amp;gt;(Installed AND PATCH) OR WIX_UPGRADE_DETECTED&amp;lt;/Publish&amp;gt;--&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WelcomeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomUpgradeDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;(Installed AND PATCH) OR OLDER_VERSION_FOUND&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomLicenseAgreementDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WelcomeDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomLicenseAgreementDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;LicenseAccepted = &quot;1&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomLicenseAgreementDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SetTargetPath&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[WIXUI_INSTALLDIR]&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DoAction&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIValidatePath&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;NOT WIXUI_DONTVALIDATEPATH&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InvalidDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[NOT WIXUI_DONTVALIDATEPATH AND WIXUI_INSTALLDIR_VALID&amp;lt;&amp;gt;&quot;1&quot;]]&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;4&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;WIXUI_DONTVALIDATEPATH OR WIXUI_INSTALLDIR_VALID=&quot;1&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ChangeFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;_BrowseProperty&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[WIXUI_INSTALLDIR]&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ChangeFolder&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BrowseDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BrowseDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;OK&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DoAction&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUIValidatePath&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;3&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BrowseDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;OK&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SpawnDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;InvalidDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;4&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;cp&quot;&gt;&amp;lt;![CDATA[WIXUI_INSTALLDIR_VALID&amp;lt;&amp;gt;&quot;1&quot;]]&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomInstallDirDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;NOT Installed&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceTypeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Installed&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CustomUpgradeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;UpgradeDlgHasShown = &quot;1&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;

            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceWelcomeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Next&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceTypeDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceTypeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RepairButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceTypeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RemoveButton&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VerifyReadyDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceTypeDlg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Back&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MaintenanceWelcomeDlg&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publish&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Dialog=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ExitDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Control=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Finish&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Event=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EndDialog&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Return&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Order=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;999&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publish&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/UI&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;UIRef&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WixUI_Common&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Product&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Wix&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Example of license agreement dialog
&lt;img src=&quot;https://i.imgur.com/sXeMVyS.png&quot; alt=&quot;License agreement dialog&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Example of upgrade welcome dialog when found existing version already installed
&lt;img src=&quot;https://i.imgur.com/WaHqBhg.png&quot; alt=&quot;Upgrade welcome dialog&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;localization-file&quot;&gt;Localization file&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Product.Loc-en.wxl&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;WixLocalization&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Culture=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en-us&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Codepage=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1252&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://schemas.microsoft.com/wix/2006/localization&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Language&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;1033&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Supported language and codepage codes can be found here: http://www.tramontana.co.hu/wix/lesson2.php#2.4 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ApplicationName&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;MiniAppKiller&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ManufacturerName&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Heiswayi Nrird&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ProductDescription&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Process killer&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Comments&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Installs MiniAppKiller&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LicenseRtf&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Overridable=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Eula-en.rtf&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;AppNotSupported&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;This application is is not supported on your current OS. Minimal OS supported is Windows XP SP2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DotNetFrameworkNeeded&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;.NET Framework 3.5 is required. Please install the .NET Framework then run this installer again.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NewerVersionInstalled&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;A newer version of !(loc.ApplicationName) is already installed.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CloseRunningApp&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;!(loc.ApplicationName) is running. You need to close it first!&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FeatureCompleteDescription&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;The complete package.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FeatureMainProgramDescription&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;The main version including all dependencies.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FeatureMainProgramTitle&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Main program&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;String Id=&quot;LicenseAgreementDlgLicenseAcceptedCheckBox&quot;&amp;gt;Agree&amp;lt;/String&amp;gt;--&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UpgradeWelcomeDlgTitle&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;!(loc.ApplicationName) Setup&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UpgradeWelcomeDlgHeaderTitle&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;A previous version of !(loc.ApplicationName) is detected&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;UpgradeWelcomeDlgMessage&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;The setup will perform an upgrade of !(loc.ApplicationName). Click Next to proceed with the upgrade or Cancel to exit the setup.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;String&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;Id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CreateDesktopShortcutCheckboxText&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Create a shortcut on Desktop&lt;span class=&quot;nt&quot;&gt;&amp;lt;/String&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/WixLocalization&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;batch-script-for-compiling-the-wix-project&quot;&gt;Batch script for compiling the WiX project&lt;/h3&gt;

&lt;p&gt;These are the WiX toolset that I use in the script below:-&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;heat.exe&lt;/strong&gt; - To automatically harvest my application files and generate a collection of &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Component&amp;gt;&lt;/code&gt; elements and &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;ComponentGroup&amp;gt;&lt;/code&gt; that will be used in &lt;em&gt;Product.wxs&lt;/em&gt; file under &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;Feature&amp;gt;&lt;/code&gt; element. Output from this tool is &lt;em&gt;Product.Files.wxs&lt;/em&gt; file.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;candle.exe&lt;/strong&gt; - To generate &lt;code class=&quot;highlighter-rouge&quot;&gt;*.wixobj&lt;/code&gt; file with some preprocessor variables.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;light.exe&lt;/strong&gt; - To compile &lt;code class=&quot;highlighter-rouge&quot;&gt;*.wixobj&lt;/code&gt; and localization file using WiX extensions and generate &lt;code class=&quot;highlighter-rouge&quot;&gt;*.msi&lt;/code&gt; file.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;MakeInstaller.bat&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@echo off

&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;projectDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

rem Automatically generated fragment file &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;application files
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;eat.exe&quot;&lt;/span&gt; dir &lt;span class=&quot;s2&quot;&gt;&quot;app&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cg&lt;/span&gt; INSTALLDIR_comp &lt;span class=&quot;nt&quot;&gt;-gg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-scom&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sreg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sfrag&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-srd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dr&lt;/span&gt; INSTALLDIR &lt;span class=&quot;nt&quot;&gt;-var&lt;/span&gt; var.ProjectDir &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Files.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dProjectDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%projectDir%&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&quot;&lt;/span&gt;

rem Create setup-1.0.msi
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_GUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2BEA883D-BB4C-4A70-B668-88AA54025F5A&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.0.0.0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_PROJECTDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%projectDir%&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ight.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-loc&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Loc-en.wxl&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cultures&lt;/span&gt;:en-US &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUIExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;setup-1.0.msi&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;

rem Create setup-1.1.msi
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_GUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2BEA883D-BB4C-4A70-B668-88AA54025F5A&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.1.0.0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_PROJECTDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%projectDir%&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ight.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-loc&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Loc-en.wxl&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cultures&lt;/span&gt;:en-US &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUIExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;setup-1.1.msi&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;

rem Create setup-2.0.msi
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;andle.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.wxs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_GUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2BEA883D-BB4C-4A70-B668-88AA54025F5A&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2.0.0.0&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-dBUILD_PROJECTDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%projectDir%&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;%WIX%bin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ight.exe&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.Files.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;_Product.wixobj&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-loc&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Product.Loc-en.wxl&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-cultures&lt;/span&gt;:en-US &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUtilExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixUIExtension &lt;span class=&quot;nt&quot;&gt;-ext&lt;/span&gt; WixNetFxExtension &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;setup-2.0.msi&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-nologo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here’s the final project files structure after I run &lt;code class=&quot;highlighter-rouge&quot;&gt;MakeInstaller.bat&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/2tFxHpB.png&quot; alt=&quot;Project files structure after compile&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Example of my MSI installer in action
&lt;img src=&quot;https://i.imgur.com/DZAhwKu.png&quot; alt=&quot;Installing action&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;wix-references&quot;&gt;WiX references&lt;/h3&gt;

&lt;p&gt;This project is done based on &lt;strong&gt;WiX v3.11&lt;/strong&gt; (&lt;a href=&quot;https://github.com/wixtoolset/wix3&quot;&gt;GitHub&lt;/a&gt;) at the time I’m writing this blog post. If you need to customize your installer UI or to support multiple localizations, you can refer to &lt;a href=&quot;https://github.com/wixtoolset/wix3/tree/develop/src/ext/UIExtension/wixlib&quot;&gt;this repository&lt;/a&gt; on GitHub for the source code references.&lt;/p&gt;
</description>
        <pubDate>Sun, 27 May 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset</guid>
        
        <category>WiX Toolset</category>
        
        <category>Windows Installer</category>
        
        <category>MSI</category>
        
        
      </item>
    
      <item>
        <title>Create a Windows app installer using Inno Setup</title>
        <description>&lt;p&gt;I have tried few other FREE installation software, and I found that &lt;a href=&quot;http://www.jrsoftware.org/isinfo.php&quot;&gt;Inno Setup&lt;/a&gt; is the best FREE &lt;a href=&quot;https://github.com/jrsoftware/issrc&quot;&gt;open source&lt;/a&gt; alternative, non-MSI and script-driven installation system software for creating Windows app installer that surpasses many commercial installers in feature set and stability. In this post I would like to share the Inno Setup script that I have been using for creating one of my applications installer.&lt;/p&gt;

&lt;p&gt;To get started, you can download and install Inno Setup from &lt;a href=&quot;http://www.jrsoftware.org/isdl.php&quot;&gt;here&lt;/a&gt;. Unicode version is recommended. If you need a better intuitive GUI software, you can download and install &lt;a href=&quot;https://www.kymoto.org/products/inno-script-studio&quot;&gt;&lt;strong&gt;Inno Script Studio&lt;/strong&gt;&lt;/a&gt; software. If you use &lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;VS Code&lt;/a&gt; or &lt;a href=&quot;https://atom.io/&quot;&gt;Atom&lt;/a&gt; editor to edit Inno Setup scripts, you can install Inno Setup extension for the script syntax highlighting; &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=idleberg.innosetup&quot;&gt;Inno Setup for Visual Studio Code&lt;/a&gt; or &lt;a href=&quot;https://atom.io/packages/language-innosetup&quot;&gt;Inno Setup for Atom&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Compile Inno Setup scripts using Inno Setup Compiler in your automated build system&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If you have automated build system set up that builds your app source code like CI/CD, you can simply integrate Inno Setup Compiler into your build system to compile Inno Setup script file (&lt;code class=&quot;highlighter-rouge&quot;&gt;*.iss&lt;/code&gt;). You need to use &lt;code class=&quot;highlighter-rouge&quot;&gt;ISCC.exe&lt;/code&gt; for the command-line compiler.&lt;/p&gt;

&lt;p&gt;Example: Just add &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Program Files (x86)\Inno Setup 5&lt;/code&gt; into the PATH environment, then you can simply use:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;iscc path\to\myinstaller.iss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more info on what command-line options are available, just run &lt;code class=&quot;highlighter-rouge&quot;&gt;iscc /?&lt;/code&gt; from a command prompt.&lt;/p&gt;

&lt;h3 id=&quot;example-of-inno-setup-script-for-my-app-installer&quot;&gt;Example of Inno Setup script for my app installer&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/rodYZ00.png&quot; alt=&quot;EXIF Reader installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The script is written based on the example of the app files structure below. If you use the script below, you may need to modify it to suit your app files structure. Any feature you don’t need, you can simply remove or comment it out. I always reuse this script as a starter and make some modifications that suit the app files structure and requirements to create a new app installer.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Example of app files structure:&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.\
├── basic.iss
└── basic\
    ├── app\
    |   ├── Resources\
    |   |   ├── map.xml
    |   |   └── res.ini
    |   ├── ExifReader.exe
    |   ├── ICSharpCode.SharpZipLib.dll
    |   ├── MetadataExtractor.dll
    |   ├── Ookii.Dialogs.Wpf.dll
    |   └── XmpCore.dll
    ├── appconfig\
    |   └── config.ini
    ├── doc\
    |   ├── EULA.rtf
    |   ├── Readme.rtf
    |   └── Requirements.rtf
    └── res\
        ├── app.ico
        ├── TopBanner.bmp
        └── VerticalBanner.bmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Example of script:&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;; Preprocessor variables
#define MyAppName &quot;EXIF Reader&quot;
#define MyAppVersion &quot;0.0.1&quot;
#define MyAppPublisher &quot;Heiswayi Nrird&quot;
#define MyAppURL &quot;https://heiswayi.nrird.com/exifreader&quot;
#define MyAppExeName &quot;ExifReader.exe&quot;
#define MyAppCopyright &quot;Copyright (C) 2018 Heiswayi Nrird&quot;
#define IncludeFramework true

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{41045341-CB76-446F-8180-6489D9474F1F}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
AppVerName={#MyAppName}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
AppCopyright={#MyAppCopyright}
; Default location of installation
DefaultDirName={pf}\{#MyAppPublisher}\{#MyAppName}
DefaultGroupName={#MyAppPublisher}\{#MyAppName}
; Installer name
OutputBaseFilename=&quot;ExifReaderSetup&quot;
; Installer icon
SetupIconFile=.\basic\res\app.ico
Compression=lzma
SolidCompression=yes
LicenseFile=.\basic\doc\EULA.rtf
InfoBeforeFile=.\basic\doc\Requirements.rtf
InfoAfterFile=.\basic\doc\Readme.rtf
; Uninstaller icon
UninstallDisplayIcon={app}\{#MyAppExeName}
DisableWelcomePage=no
; Installer vertical banner, max resolution: 164x314 px
WizardImageFile=.\basic\res\VerticalBanner.bmp
; Installer top logo, max resolution: 55x58 px
; I'm not using this as I'm using top banner instead (see below), so I commented it out.
;WizardSmallImageFile=TopLogo.bmp
; Installer FileVersion
VersionInfoVersion=1.0.0.0
;CreateUninstallRegKey=no
PrivilegesRequired=admin
; Installer output is the same as source (.iss file)
OutputDir=.

[Languages]
Name: &quot;english&quot;; MessagesFile: &quot;compiler:Default.isl&quot;

[Tasks]
Name: &quot;desktopicon&quot;; Description: &quot;{cm:CreateDesktopIcon}&quot;; GroupDescription: &quot;{cm:AdditionalIcons}&quot;; Flags: unchecked
Name: &quot;quicklaunchicon&quot;; Description: &quot;{cm:CreateQuickLaunchIcon}&quot;; GroupDescription: &quot;{cm:AdditionalIcons}&quot;; Flags: unchecked; OnlyBelowVersion: 0,6.1

[Files]
; NOTE: Don't use &quot;Flags: ignoreversion&quot; on any shared system files
Source: &quot;.\basic\app\*&quot;; DestDir: &quot;{app}&quot;; Flags: ignoreversion recursesubdirs createallsubdirs
Source: &quot;.\basic\doc\*&quot;; DestDir: &quot;{app}\Docs&quot;; Flags: ignoreversion
; These files will not be removed during uninstallation
; {userdocs} = My Documents folder
Source: &quot;.\basic\appconfig\*&quot;; DestDir: &quot;{userdocs}\{#MyAppName}&quot;; Flags: ignoreversion uninsneveruninstall
; Customized top banner, max resolution: 499x58 px
Source: &quot;.\basic\res\TopBanner.bmp&quot;; Flags: dontcopy

[Icons]
Name: &quot;{group}\{#MyAppName}&quot;; Filename: &quot;{app}\{#MyAppExeName}&quot;
Name: &quot;{group}\{cm:UninstallProgram,{#MyAppName}}&quot;; Filename: &quot;{uninstallexe}&quot;
Name: &quot;{commondesktop}\{#MyAppName}&quot;; Filename: &quot;{app}\{#MyAppExeName}&quot;; Tasks: desktopicon
Name: &quot;{userappdata}\Microsoft\Internet Explorer\Quick Launch\{#MyAppName}&quot;; Filename: &quot;{app}\{#MyAppExeName}&quot;; Tasks: quicklaunchicon

[Run]
Filename: &quot;{app}\{#MyAppExeName}&quot;; Description: &quot;{cm:LaunchProgram,{#StringChange(MyAppName, '&amp;amp;', '&amp;amp;&amp;amp;')}}&quot;; Flags: nowait postinstall skipifsilent

[Messages]
; Customized license agreement checkbox messages
LicenseAccepted=&amp;amp;Agree
LicenseNotAccepted=&amp;amp;Do Not Agree

[Code]
// I'm using horizontal top banner instead of logo
procedure InitializeWizard();
var
  BitmapImage: TBitmapImage;
begin
  ExtractTemporaryFile('TopBanner.bmp');
  BitmapImage := TBitmapImage.Create(WizardForm);
  BitmapImage.Parent := WizardForm.MainPanel;
  BitmapImage.Width := WizardForm.MainPanel.Width;
  BitmapImage.Height := WizardForm.MainPanel.Height;
  BitmapImage.Stretch := True;
  BitmapImage.AutoSize := False;
  BitmapImage.Bitmap.LoadFromFile(ExpandConstant('{tmp}\TopBanner.bmp'));

  WizardForm.WizardSmallBitmapImage.Visible := False;
  WizardForm.PageDescriptionLabel.Visible := True;
  WizardForm.PageNameLabel.Visible := True;

  WizardForm.PageDescriptionLabel.Color := TColor($E8E8E8);
  WizardForm.PageNameLabel.Color := TColor($E8E8E8);

  WizardForm.PageDescriptionLabel.Width :=
    WizardForm.PageDescriptionLabel.Width - ScaleX(60);
  WizardForm.PageNameLabel.Width :=
    WizardForm.PageNameLabel.Width - ScaleX(60);
end;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the script above, there are some common &lt;strong&gt;Flags&lt;/strong&gt; under &lt;code class=&quot;highlighter-rouge&quot;&gt;[Files]&lt;/code&gt; section and here what they mean:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ignoreversion&lt;/code&gt; - replace existing files regardless of their version number&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;onlyifdoesntexist&lt;/code&gt; - only install the file if it doesn’t already exist on the user’s system&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;recursesubdirs&lt;/code&gt; - use this when you use wildcard for the &lt;code class=&quot;highlighter-rouge&quot;&gt;Source&lt;/code&gt; as shown in the script above&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;createallsubdirs&lt;/code&gt; - create all subdirectories, and must be combined with &lt;code class=&quot;highlighter-rouge&quot;&gt;recursesubdirs&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;uninsneveruninstall&lt;/code&gt; - never remove the file during uninstallation&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;deleteafterinstall&lt;/code&gt; - delete file once the installation is completed/aborted&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For other available flags, you can refer to &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=filessection&quot;&gt;Inno Setup documentation here&lt;/a&gt; for more details. It’s too robust to explain everything here.&lt;/p&gt;

&lt;h3 id=&quot;implement-components-based-installation-in-your-installer&quot;&gt;Implement components-based installation in your installer&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/BeKgNvo.png&quot; alt=&quot;Components-based installation&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you want to design your app installer using components-based installation, you may need to modify the script and add two extra sections called &lt;code class=&quot;highlighter-rouge&quot;&gt;[Types]&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;[Components]&lt;/code&gt;. Check the provided example script below which taken from &lt;code class=&quot;highlighter-rouge&quot;&gt;Components.iss&lt;/code&gt; file that located in &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Program Files (x86)\Inno Setup 5\Examples&lt;/code&gt; folder.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program
DefaultGroupName=My Program
UninstallDisplayIcon={app}\MyProg.exe
OutputDir=userdocs:Inno Setup Examples Output

[Types]
Name: &quot;full&quot;; Description: &quot;Full installation&quot;
Name: &quot;compact&quot;; Description: &quot;Compact installation&quot;
Name: &quot;custom&quot;; Description: &quot;Custom installation&quot;; Flags: iscustom

[Components]
Name: &quot;program&quot;; Description: &quot;Program Files&quot;; Types: full compact custom; Flags: fixed
Name: &quot;help&quot;; Description: &quot;Help File&quot;; Types: full
Name: &quot;readme&quot;; Description: &quot;Readme File&quot;; Types: full
Name: &quot;readme\en&quot;; Description: &quot;English&quot;; Flags: exclusive
Name: &quot;readme\de&quot;; Description: &quot;German&quot;; Flags: exclusive

[Files]
Source: &quot;MyProg.exe&quot;; DestDir: &quot;{app}&quot;; Components: program
Source: &quot;MyProg.chm&quot;; DestDir: &quot;{app}&quot;; Components: help
Source: &quot;Readme.txt&quot;; DestDir: &quot;{app}&quot;; Components: readme\en; Flags: isreadme
Source: &quot;Readme-German.txt&quot;; DestName: &quot;Liesmich.txt&quot;; DestDir: &quot;{app}&quot;; Components: readme\de; Flags: isreadme

[Icons]
Name: &quot;{group}\My Program&quot;; Filename: &quot;{app}\MyProg.exe&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Meaning of the &lt;strong&gt;Flags&lt;/strong&gt; used:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fixed&lt;/code&gt; - usually used in the main program file where user cannot unselect that component&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exclusive&lt;/code&gt; - user only can select one of the exclusive components, mostly used for localized files&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;creating-prerequisites-for-your-installer&quot;&gt;Creating prerequisites for your installer&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;.NET Framework&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If your app requires particular .NET Framework to be installed as part of the prerequisites, there are few ways you can do with Inno Setup script. You either can;-&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;include or package together the offline installer of .NET Framework into your app installer, or&lt;/li&gt;
  &lt;li&gt;just check and if not installed, inform the user to download and install particular .NET Framework manually, and then abort your app installer.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can use the &lt;a href=&quot;http://jrsoftware.org/ishelp/topic_scriptcheck.htm&quot;&gt;Check&lt;/a&gt; parameter to run check if particular .NET Framework is installed.&lt;/p&gt;

&lt;p&gt;Inno Setup &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=scriptintro&quot;&gt;scripting&lt;/a&gt; is based on &lt;a href=&quot;https://en.wikipedia.org/wiki/Pascal_(programming_language)&quot;&gt;Pascal&lt;/a&gt; programming language which adds lots of new possibilities to customize your Setup or Uninstall at run-time.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Here’s how to include the offline installer of .NET Framework into your app installer&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Add a new &lt;code class=&quot;highlighter-rouge&quot;&gt;Source&lt;/code&gt; under the &lt;code class=&quot;highlighter-rouge&quot;&gt;[Files]&lt;/code&gt; section:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Files]
; .NET Framework v4.7.1 offline installer
Source: &quot;.\basic\dependencies\NDP471-KB4033342-x86-x64-AllOS-ENU.exe&quot;; DestDir: {tmp}; Flags: deleteafterinstall; AfterInstall: InstallFramework; Check: FrameworkIsNotInstalled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add these two code under &lt;code class=&quot;highlighter-rouge&quot;&gt;[Code]&lt;/code&gt; section:&lt;/p&gt;

&lt;div class=&quot;language-pascal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Check for installed .NET Framework 4.7.1 in the registry
// MSDN page: https://msdn.microsoft.com/en-us/library/hh925568.aspx
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FrameworkIsNotInstalled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;readVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cardinal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;               
  &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Release'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readVal&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;461308&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Create progress dialog for installing .NET Framework 4.7.1
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InstallFramework&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;StatusText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ResultCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;StatusText&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StatusLabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Caption&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StatusLabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Caption&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Installing .NET Framework 4.5.2. This might take a few minutes...'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProgressGauge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Style&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;npbstMarquee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;Exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExpandConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/passive /norestart'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SW_SHOW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ewWaitUntilTerminated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ResultCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ResultCode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;MsgBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.NET installation failed with code: '&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntToStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ResultCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Setup will now terminate.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mbError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MB_OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;DeleteFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExpandConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;Exterminate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StatusLabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Caption&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StatusText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProgressGauge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Style&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;npbstNormal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
       &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;DeleteFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExpandConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{tmp}\NDP471-KB4033342-x86-x64-AllOS-ENU.exe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ForceClose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Exterminate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ForceClose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;WizardForm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CancelButtonClick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CurPageID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Cancel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Confirm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Confirm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ForceClose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Here’s how you can just implement the checking and inform the user to download and install if particular .NET Framework is not installed&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Another way is to check the required .NET Framework at the beginning of installation, if not installed, inform the user to download and install the required .NET Framework. Check the code below how to implement it. The code below is taken from &lt;a href=&quot;http://www.kynosarges.de/DotNetVersion.html&quot;&gt;http://www.kynosarges.de/DotNetVersion.html&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-pascal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IsDotNetDetected&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cardinal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Indicates whether the specified version and service pack of the .NET Framework is installed.
//
// version -- Specify one of these strings for the required .NET Framework version:
//    'v1.1'          .NET Framework 1.1
//    'v2.0'          .NET Framework 2.0
//    'v3.0'          .NET Framework 3.0
//    'v3.5'          .NET Framework 3.5
//    'v4\Client'     .NET Framework 4.0 Client Profile
//    'v4\Full'       .NET Framework 4.0 Full Installation
//    'v4.5'          .NET Framework 4.5
//    'v4.5.1'        .NET Framework 4.5.1
//    'v4.5.2'        .NET Framework 4.5.2
//    'v4.6'          .NET Framework 4.6
//    'v4.6.1'        .NET Framework 4.6.1
//    'v4.6.2'        .NET Framework 4.6.2
//    'v4.7'          .NET Framework 4.7
//    'v4.7.1'        .NET Framework 4.7.1
//    'v4.7.2'        .NET Framework 4.7.2
//
// service -- Specify any non-negative integer for the required service pack level:
//    0               No service packs required
//    1, 2, etc.      Service pack 1, 2, etc. required
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serviceCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cardinal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// .NET 1.1 and 2.0 embed release number in version key
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'v1.1'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'v1.1.4322'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'v2.0'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'v2.0.50727'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// .NET 4.5 and newer install as update to .NET 4.0 Full
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'v4.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'v4\Full'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;'v4.5'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;378389&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;'v4.5.1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;378675&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 378758 on Windows 8 and older
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.5.2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;379893&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;'v4.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;393295&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 393297 on Windows 8.1 and older
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.6.1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;394254&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 394271 before Win10 November Update
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.6.2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;394802&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 394806 before Win10 Anniversary Update
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.7'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;460798&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 460805 before Win10 Creators Update
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.7.1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;461308&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 461310 before Win10 Fall Creators Update
&lt;/span&gt;          &lt;span class=&quot;s&quot;&gt;'v4.7.2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;461808&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 461814 before Win10 April 2018 Update
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// installation key group for all .NET versions
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SOFTWARE\Microsoft\NET Framework Setup\NDP\'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// .NET 3.0 uses value InstallSuccess in subkey Setup
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'v3.0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'\Setup'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'InstallSuccess'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Install'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// .NET 4.0 and newer use value Servicing instead of SP
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'v4'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Servicing'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serviceCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SP'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serviceCount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// .NET 4.5 and newer use additional value Release
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryDWordValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Release'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;release&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;versionRelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serviceCount&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InitializeSetup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IsDotNetDetected&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'v4.7.1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;MsgBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'EXIF Reader requires Microsoft .NET Framework 4.7.1.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;'Please use Windows Update to install this version,'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;'and then re-run the EXIF Reader setup program.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mbInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MB_OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-prevent-install-if-newer-version-already-installed&quot;&gt;How to prevent install if newer version already installed&lt;/h3&gt;

&lt;p&gt;In case you want to prevent install if newer version already installed in user PC, you can apply this code within &lt;code class=&quot;highlighter-rouge&quot;&gt;InitializeSetup&lt;/code&gt; function, so your installer wouldn’t downgrade existing installation.&lt;/p&gt;

&lt;p&gt;Add a custom message under &lt;code class=&quot;highlighter-rouge&quot;&gt;[CustomMessages]&lt;/code&gt; section:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[CustomMessages]
english.NewerVersionExists=A newer version of {#AppName} is already installed.%n%nInstaller version: {#AppVersion}%nCurrent version:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Apply this code under &lt;code class=&quot;highlighter-rouge&quot;&gt;[Code]&lt;/code&gt; section to check for existing installation version:&lt;/p&gt;

&lt;div class=&quot;language-pascal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Check for existing installation version
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InitializeSetup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegValueExists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKEY_LOCAL_MACHINE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#AppId}_is1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'DisplayVersion'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;RegQueryStringValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKEY_LOCAL_MACHINE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#AppId}_is1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'DisplayVersion'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'{#AppVersion}'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;MsgBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExpandConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{cm:NewerVersionExists} '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mbInformation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MB_OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-automatically-uninstall-previous-installed-version&quot;&gt;How to automatically uninstall previous installed version&lt;/h3&gt;

&lt;p&gt;Based on the solution from &lt;a href=&quot;https://stackoverflow.com/a/2099805&quot;&gt;Craig McQueen at StackOverflow&lt;/a&gt;, your installer can check if user already installed your app and if found, your installer will grab the &lt;code class=&quot;highlighter-rouge&quot;&gt;UninstallString&lt;/code&gt; from the registry and run the uninstallation command in silent mode.&lt;/p&gt;

&lt;div class=&quot;language-pascal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GetUninstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sUnInstPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sUnInstPath&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExpandConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Software\Microsoft\Windows\CurrentVersion\Uninstall\{#emit SetupSetting(&quot;AppId&quot;)}_is1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RegQueryStringValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKLM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'UninstallString'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;RegQueryStringValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HKCU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'UninstallString'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IsUpgrade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetUninstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UnInstallOldVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;iResultCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Return Values:
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 1 - uninstall string is empty
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 2 - error executing the UnInstallString
&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 3 - successfully executed the UnInstallString
&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// default return value
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// get the uninstall string of the old app
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GetUninstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RemoveQuotes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sUnInstallString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/SILENT /NORESTART /SUPPRESSMSGBOXES'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SW_HIDE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ewWaitUntilTerminated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iResultCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CurStepChanged&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CurStep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TSetupStep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CurStep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssInstall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsUpgrade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;UnInstallOldVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-kill-existing-running-services-before-re-install-or-upgrade&quot;&gt;How to kill existing running services before re-install (or upgrade)&lt;/h3&gt;

&lt;p&gt;To kill existing running services, what you need to do is to apply &lt;a href=&quot;https://www.kymoto.org/documentation/scriptstudio/index.html?common_beforeinstall.html&quot;&gt;BeforeInstall&lt;/a&gt; parameter at the service file you’re going to (re)install. Take a look on the example script below:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Files]
Source: &quot;.\bin\Service1.exe&quot;; DestDir: &quot;{app}&quot;; Flags: ignoreversion; BeforeInstall: TaskKill('Service1.exe')
Source: &quot;.\bin\Service2.exe&quot;; DestDir: &quot;{app}&quot;; Flags: ignoreversion; BeforeInstall: TaskKill('Service2.exe')

[Code]
procedure TaskKill(FileName: String);
var
  ResultCode: Integer;
begin
    Exec(ExpandConstant('taskkill.exe'), '/f /im ' + '&quot;' + FileName + '&quot;', '', SW_HIDE,
     ewWaitUntilTerminated, ResultCode);
end;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-associate-a-program-with-an-extension-during-installation&quot;&gt;How to associate a program with an extension during installation&lt;/h3&gt;

&lt;p&gt;Add a property as per below in &lt;code class=&quot;highlighter-rouge&quot;&gt;[Setup]&lt;/code&gt; section:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Setup]
ChangesAssociations = yes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will tell Explorer to refresh its file associations information at the end of the installation, and similarly for the uninstallation. Then, add these following registry keys:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Registry]
; Associate file extension &quot;.exif&quot; to my app program
Root: HKCR; Subkey: &quot;.exif&quot;; ValueData: &quot;{#MyAppName}&quot;; Flags: uninsdeletevalue; ValueType: string; ValueName: &quot;&quot;
Root: HKCR; Subkey: &quot;{#MyAppName}&quot;; ValueData: &quot;Program {#MyAppName}&quot;; Flags: uninsdeletekey; ValueType: string; ValueName: &quot;&quot;
Root: HKCR; Subkey: &quot;{#MyAppName}\DefaultIcon&quot;; ValueData: &quot;{app}\{#MyAppExeName},0&quot;; ValueType: string; ValueName: &quot;&quot;
Root: HKCR; Subkey: &quot;{#MyAppName}\shell\open\command&quot;; ValueData: &quot;&quot;&quot;{app}\{#MyAppExeName}&quot;&quot; &quot;&quot;%1&quot;&quot;&quot;; ValueType: string; ValueName: &quot;&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Wed, 23 May 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/create-windows-app-installer-using-inno-setup</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/create-windows-app-installer-using-inno-setup</guid>
        
        <category>Inno Setup</category>
        
        <category>Pascal</category>
        
        
      </item>
    
      <item>
        <title>Creating AI chatbot using RiveScript</title>
        <description>&lt;p&gt;Three years ago, I wrote &lt;a href=&quot;https://heiswayi.nrird.com/2015/experiment-with-ai-chatbot-app-development&quot;&gt;a blog post&lt;/a&gt; talking about how I started exploring and experimenting with AI chatbot application development. In the end I found myself likely interested more in building AI chatbots for the web. Basically when designing a chatbot, in order to have a natural human-like conversation, the chatbot needs a knowledgebase system that works like a brain to respond to particular conversation inputs.&lt;/p&gt;

&lt;p&gt;I remembered before I created my first AI chatbot web app known as &lt;a href=&quot;https://heiswayi.nrird.com/w4y1/&quot;&gt;W4Y1&lt;/a&gt;, I had been struggling to find a better chatbot interpreter engine that can provides easier way to program the bot brain. Then, I found one that is a quite good fit for my requirement known as &lt;a href=&quot;http://www.masswerk.at/elizabot/&quot;&gt;elizabot.js&lt;/a&gt;. So, I built my chatbot based on this JavaScript library. I liked this library because it uses JSON format for the knowledgebase markup language. Thus, it was easy for me to program my chatbot brain.&lt;/p&gt;

&lt;p&gt;After a while using elizabot.js, I started to feel that the knowledgebase markup language should be more simpler than JSON format. Without wasting my time to go into the source code and modify it, I opted to look for a better chatbot interpreter engine alternative. And then, I found two of them that can provide me a “more simpler” solution to program my bot brain - &lt;a href=&quot;https://github.com/BotML/botml-js&quot;&gt;BotML&lt;/a&gt; and &lt;a href=&quot;https://www.rivescript.com/&quot;&gt;RiveScript&lt;/a&gt;. After some researches, I decided to use &lt;strong&gt;RiveScript&lt;/strong&gt; since it has more supports for different programming languages, good documentations and active contributions from its community. So, I have developed two chatbot app projects that are based on RiveScript interpreter engine; &lt;em&gt;HelloBot&lt;/em&gt; and &lt;em&gt;hnbot&lt;/em&gt;.&lt;/p&gt;

&lt;h3 id=&quot;hellobot---ai-chatbot-web-app-built-using-jekyll&quot;&gt;HelloBot - AI chatbot web app built using Jekyll&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/tn3C7Bw.png&quot; alt=&quot;HelloBot - Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HelloBot is built using &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; and &lt;a href=&quot;https://github.com/aichaos/rivescript-js&quot;&gt;rivescript-js&lt;/a&gt; for the bot interpreter engine. HelloBot is live and currently being hosted using GitHub Pages for demo purpose. HelloBot contains terminal-like interface designed using &lt;a href=&quot;https://getbootstrap.com/&quot;&gt;Bootstrap&lt;/a&gt;, &lt;a href=&quot;https://terminal.jcubic.pl/&quot;&gt;jQueryTerminal&lt;/a&gt; and &lt;a href=&quot;https://github.com/jquery/jquery-mousewheel&quot;&gt;jquery-mousewheel&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://heiswayi.nrird.com/hellobot&quot;&gt;&lt;strong&gt;Demo&lt;/strong&gt;&lt;/a&gt; // &lt;a href=&quot;https://github.com/heiswayi/hellobot&quot;&gt;&lt;strong&gt;Source code on GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;hnbot---ai-chatbot-web-app-built-using-nodejs-and-socketio&quot;&gt;hnbot - AI chatbot web app built using Node.js and Socket.IO&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/tYLZEhZ.png&quot; alt=&quot;hnbot - Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;hnbot is using a similar interface design with HelloBot, and the only difference is that hnbot is built based on &lt;a href=&quot;https://nodejs.org/en/&quot;&gt;Node.js&lt;/a&gt; and &lt;a href=&quot;https://socket.io/&quot;&gt;Socket.IO&lt;/a&gt;. Also similarly to HelloBot, hnbot’s interpreter engine is based on &lt;a href=&quot;https://www.npmjs.com/package/rivescript&quot;&gt;RiveScript NPM package&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/heiswayi/hnbot&quot;&gt;&lt;strong&gt;Source code on GitHub&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To run the demo locally, you need Git and Node.js installed, then run following commands:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/heiswayi/hnbot.git
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;hnbot
npm install
npm start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sun, 06 May 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/creating-ai-chatbot-using-rivescript</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/creating-ai-chatbot-using-rivescript</guid>
        
        <category>Artificial Intelligence</category>
        
        <category>Chatbot</category>
        
        <category>Jekyll</category>
        
        <category>Node.js</category>
        
        
      </item>
    
      <item>
        <title>Dotfuscated Checker</title>
        <description>&lt;p&gt;&lt;strong&gt;Dotfuscated Checker&lt;/strong&gt; is a simple GUI tool I created with .NET C# and WPF to easily check if the required assemblies from the software build are obfuscated and digitally signed before they can be deployed for a production release. This tool may help Software Quality Assurance Engineers who work with .NET based projects to check for obfuscation at a glance. Other than obfuscation, you can check for digital signing too - no need to manually check File Properties for each of the assemblies.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This tool is only tested to work with .NET based assemblies which are being obfuscated using &lt;a href=&quot;https://www.preemptive.com/products/dotfuscator/overview&quot;&gt;Dotfuscator&lt;/a&gt; software. What this tool does is quite simple; loading the assemblies, check for the present of Dotfuscator attribute in each of the assemblies and check for digital signing too.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;screenshot-v10&quot;&gt;Screenshot (v1.0)&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/2iYCNYO.png&quot; alt=&quot;Dotfuscated Checker v1.0&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;downloads&quot;&gt;Downloads&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.dropbox.com/s/8lss51zhhx0p4xq/DotfuscatedCheckerV1.zip?dl=0&quot;&gt;&lt;strong&gt;Dotfuscated Checker v1.0&lt;/strong&gt;&lt;/a&gt; (ZIP, 1.46 MB)&lt;/p&gt;

&lt;p&gt;Minimum prerequisite: &lt;a href=&quot;https://www.microsoft.com/en-us/download/details.aspx?id=49981&quot;&gt;.NET Framework 4.6.1&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 04 Mar 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/dotfuscated-checker</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/dotfuscated-checker</guid>
        
        <category>CSharp</category>
        
        <category>WPF</category>
        
        <category>Project</category>
        
        
      </item>
    
      <item>
        <title>SRT SubShifter</title>
        <description>&lt;p&gt;Whenever I am looking for subtitles file, sometimes I get the one that never synchronize well with the movie file I want to watch on my home TV. After I verify the subtitles with the movie, I have to go to a particular website to resync the subtitles by adjusting the time shift. Well, I can use a Python script or other script to locally resync the subtitles file, but I think I would prefer to use a simple GUI program to do that, faster and easier for me.&lt;/p&gt;

&lt;p&gt;So, I created this simple program called &lt;strong&gt;SRT SubShifter&lt;/strong&gt; in .NET C# using WPF code-behind to easily &lt;strong&gt;resync&lt;/strong&gt; the subtitles file.&lt;/p&gt;

&lt;h3 id=&quot;screenshot-v01&quot;&gt;Screenshot (v0.1)&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/5whUyC2.png&quot; alt=&quot;SRT SubShifter v0.1&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;source-code-and-download&quot;&gt;Source code and download&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/heiswayi/srt-subshifter&quot;&gt;&lt;strong&gt;View source code on GitHub&lt;/strong&gt;&lt;/a&gt; // &lt;a href=&quot;https://github.com/heiswayi/srt-subshifter/releases&quot;&gt;Download latest binary package&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Feb 2018 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2018/srt-subshifter</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2018/srt-subshifter</guid>
        
        <category>CSharp</category>
        
        <category>WPF</category>
        
        <category>Project</category>
        
        
      </item>
    
      <item>
        <title>Creating a minimalist web-based writing tool</title>
        <description>&lt;p&gt;This weekend, I have been spending some of my times creating a minimalist web-based tool called &lt;a href=&quot;https://nrird.xyz/document-writer&quot;&gt;&lt;strong&gt;Document Writer&lt;/strong&gt;&lt;/a&gt;. Document Writer is very simple web-based writing tool to easily write document by using a web browser and save the written document into a plain text, HTML or markdown format file.&lt;/p&gt;

&lt;p&gt;The &lt;strong&gt;reason&lt;/strong&gt; behind this web tool is because I need to write document easier and faster with the help of &lt;a href=&quot;https://www.tinymce.com/&quot;&gt;TinyMCE editor plugin&lt;/a&gt;, then I can save it into the format I needed (HTML or markdown, mostly), without the need for me to manually write the HTML code.&lt;/p&gt;

&lt;h3 id=&quot;screenshot&quot;&gt;Screenshot&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/3FRdl5R.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Web Address:&lt;/strong&gt; &lt;a href=&quot;https://nrird.xyz/document-writer&quot;&gt;https://nrird.xyz/document-writer&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;what-you-can-do-with-this-web-tool&quot;&gt;What you can do with this web tool?&lt;/h3&gt;

&lt;p&gt;Just by using your web browser, you can simply write something in the editor, craft your document, upload your image files and save it as a plain text, HTML or markdown format file into your local computer.&lt;/p&gt;

&lt;h3 id=&quot;how-this-web-tool-is-created-technically&quot;&gt;How this web tool is created, technically?&lt;/h3&gt;

&lt;p&gt;Document Writer is created using &lt;a href=&quot;https://getbootstrap.com/&quot;&gt;Bootstrap v4.0.0&lt;/a&gt; for the tool interface layout, &lt;a href=&quot;https://www.tinymce.com/&quot;&gt;TinyMCE’s JS editor plugin&lt;/a&gt; to provide a nice editor interface and toolbars for writing, &lt;a href=&quot;https://github.com/eligrey/FileSaver.js/&quot;&gt;FileSaver.js&lt;/a&gt; to save the written document into a local file, &lt;a href=&quot;http://momentjs.com/&quot;&gt;moment.js&lt;/a&gt; for auto-define filename if left blank, &lt;a href=&quot;https://github.com/domchristie/to-markdown&quot;&gt;to-markdown.js&lt;/a&gt; for converting HTML code into a markdown format, &lt;a href=&quot;http://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/&quot;&gt;htmLawed&lt;/a&gt; to tidy/auto-indent the HTML code that generated by TinyMCE plugin before saving into a HTML file and some custom scripts (jQuery &amp;amp; PHP) to handle AJAX or manage image upload service at server-side. Other that these, Document Writer also uses the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API&quot;&gt;Web Storage API&lt;/a&gt; for auto-save feature and recording of a list of uploaded image filenames into the server by the user.&lt;/p&gt;

&lt;p&gt;User can download all uploaded images as an archive (.zip) or delete all the image files immediately from the server. However, each files stored on the server will be automatically deleted after 24 hours of creation time.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;If you have any inquiry such as a question to ask, problem/bug to report, idea or suggestion related to this web tool, feel free to send me an email at &lt;a href=&quot;mailto:hnrird@gmail.com&quot;&gt;hnrird@gmail.com&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 26 Nov 2017 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2017/creating-minimalist-web-based-writing-tool-document-writer</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2017/creating-minimalist-web-based-writing-tool-document-writer</guid>
        
        <category>PHP</category>
        
        <category>JavaScript</category>
        
        <category>AJAX</category>
        
        <category>jQuery</category>
        
        <category>Project</category>
        
        
      </item>
    
      <item>
        <title>DevOps and Build Automation Presentation</title>
        <description>&lt;p&gt;When I was working as &lt;em&gt;Build and Release Engineer&lt;/em&gt;, I had been given a chance to give a talk session to my software team on &lt;em&gt;DevOps and Build Automation&lt;/em&gt; which titled &lt;strong&gt;“Introduction to DevOps &amp;amp; Build Automation Update”&lt;/strong&gt;. Here’s the embedded version of my presentation slides by &lt;a href=&quot;https://www.slideshare.net/HeiswayiNrird/devops-and-build-automation&quot;&gt;SlideShare&lt;/a&gt;:&lt;/p&gt;

&lt;iframe src=&quot;//www.slideshare.net/slideshow/embed_code/key/6b6CrQrQMjnm1Z&quot; width=&quot;595&quot; height=&quot;485&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;margin-top:20px;&quot; allowfullscreen=&quot;&quot;&gt; &lt;/iframe&gt;
</description>
        <pubDate>Wed, 04 Oct 2017 00:00:00 +0800</pubDate>
        <link>https://heiswayi.nrird.com/2017/devops-and-build-automation-presentation</link>
        <guid isPermaLink="true">https://heiswayi.nrird.com/2017/devops-and-build-automation-presentation</guid>
        
        <category>DevOps</category>
        
        <category>Build Automation</category>
        
        
      </item>
    
  </channel>
</rss>
