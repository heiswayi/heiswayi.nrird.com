<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title> Create MSI bootstrapper (setup.exe) using WiX Burn · heiswayi nrird •••</title><meta name="description" content=" Here&#39;s how I create a custom bootstrapper (setup.exe) for my MSI installer using Windows Installler (WiX) Burn. Full example source code provided. "/><meta name="keywords" content="wix toolset, windows installer, msi, windows installer xml, wix burn, installer bootstrapper, setup.exe"><meta name="author" content="Heiswayi Nrird"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:type" content="article"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="wix toolset, windows installer, msi, windows installer xml, wix burn, installer bootstrapper, setup.exe"><meta property="article:published_time" content="2018-05-29 00:00:00 +0800"><meta property="og:url" content="https://heiswayi.nrird.com/2018/create-msi-bootstrapper-using-wix-burn"><meta property="og:title" content=" Create MSI bootstrapper (setup.exe) using WiX Burn · heiswayi nrird ••• "><meta property="og:image" content="https://heiswayi.nrird.com/assets/logo.png"><meta property="og:description" content=" Here&#39;s how I create a custom bootstrapper (setup.exe) for my MSI installer using Windows Installler (WiX) Burn. Full example source code provided. "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:title" content=" Create MSI bootstrapper (setup.exe) using WiX Burn · heiswayi nrird ••• "><meta name="twitter:description" content=" Here&#39;s how I create a custom bootstrapper (setup.exe) for my MSI installer using Windows Installler (WiX) Burn. Full example source code provided. "><meta name="twitter:image:src" content="https://heiswayi.nrird.com/assets/logo.png"><meta itemprop="name" content=" Create MSI bootstrapper (setup.exe) using WiX Burn · heiswayi nrird ••• "><meta itemprop="description" content=" Here&#39;s how I create a custom bootstrapper (setup.exe) for my MSI installer using Windows Installler (WiX) Burn. Full example source code provided. "><meta itemprop="image" content="https://heiswayi.nrird.com/assets/logo.png"><link rel="canonical" href="https://heiswayi.nrird.com/2018/create-msi-bootstrapper-using-wix-burn"><link rel="alternate" type="application/rss+xml" title="RSS" href="https://heiswayi.nrird.com/feed.xml"><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="><link rel="stylesheet" href="https://heiswayi.nrird.com/assets/css/main.css?20180603"> <script src="https://heiswayi.nrird.com/assets/js/modernizr.custom.js"></script> <!--[if lt IE 9]> <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script> <script src="https://heiswayi.nrird.com/assets/js/rem.min.js"></script> <![endif]--> <a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"> <canvas id="canvas" style="width:100%;height:100%;max-height:230px;position:absolute;z-index:1;opacity:0.5"></canvas><div class="container"><h2 class="masthead-title"> <a href="https://heiswayi.nrird.com" title="heiswayi nrird •••" class="title">heiswayi nrird <span class="dot-red">•</span><span class="dot-yellow">•</span><span class="dot-green">•</span></a> <small>Between coding and random stuffs </small></h2><div class="footer-social-links"> <a href="http://heiswayi.github.io/feed.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a> <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a> <!--<a href="https://www.facebook.com/heiswayi.nrird" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>--> <!--<a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>--> <a href="http://heiswayi.github.io/my-repos/" title="GitHub Repositories" target="_blank"><i class="fa fa-github-alt"></i></a> <a href="http://heiswayi.github.io/my-gists/" title="GitHub Gists" target="_blank"><i class="fa fa-code"></i></a> <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a> <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a> <a href="http://jsfiddle.net/user/heiswayi/" title="JSFiddle" target="_blank"><i class="fa fa-jsfiddle"></i></a></div><div class="nav"><ul class="top-menu"><li><a href="https://heiswayi.nrird.com/" title="Home"><i class="fa fa-home"></i></a><li><a href="https://heiswayi.nrird.com/about">About</a> <!--<li><a href="/resume">Resume <i class="fa fa-external-link-square"></i></a>--><li><a href="https://heiswayi.nrird.com/projects" class="bg-red"><i class="fa fa-space-shuttle" aria-hidden="true"></i> Projects</a><li><a href="https://heiswayi.nrird.com/tagged">Tags</a><li><a href="https://heiswayi.github.io/photography">Photography <i class="fa fa-external-link-square"></i></a><li><a href="https://heiswayi.nrird.com/reminder">Reminder</a></ul></div></div></div><div id="content" class="container content"><div class="post"><div class="post-top-meta"> <!--<div class="edit-this-page"><a href="https://github.com/heiswayi/heiswayi.github.io/blob/master/_posts/2018/2018-05-29-create-msi-bootstrapper-using-wix-burn.md">Edit this page</a></div>--><div class="post-date">May 29, 2018</div><h1 class="post-title">Create MSI bootstrapper (setup.exe) using WiX Burn</h1></div><p>In my previous blog post “<a href="https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset">Create a basic MSI installer using WiX Toolset</a>”, I have shared about how I created a basic <code class="highlighter-rouge">.msi</code> installer using WiX toolset for my app deployment. And today, I’m going to share how I create a bootstrapper i.e. setup.exe using WiX to chain the installations that are packaged as <code class="highlighter-rouge">*.msi</code>. One of the reasons you need a bootstrapper is because there is only one instance of <code class="highlighter-rouge">.msi</code> can be run at a time. Using a bootstrapper, you can install the required prerequisites for your app deployment, e.g. .NET Framework.<p>Example of my bootstrapper UI <img src="https://i.imgur.com/G6mL3rE.png" alt="Example of my bootstrapper UI" /><h3 id="example-of-project-files-structure-for-creating-the-bootstrapper">Example of project files structure for creating the bootstrapper</h3><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;root&gt;
├── bootstrapper_res\
|   ├── banner.png
|   ├── ClassicTheme.wxl
|   └── ClassicTheme.xml
├── prereq\
|   └── NDP471-KB4033344-Web.exe
├── Bootstrapper.wxs
├── MakeBootstrapper.bat
├── myAppSetup.msi
├── ...
</code></pre></div></div><p>Folders:<ul><li><code class="highlighter-rouge">bootstrapper_res</code> - Contains graphic resource and theme files for my WiX bootstrapper UI<li><code class="highlighter-rouge">prereq</code> - Contains necessary prerequisites to be bundled into my bootstrapper</ul><p>WiX project files:<ul><li><code class="highlighter-rouge">Bootstrapper.wxs</code> - Main file for generating the bootstrapper (<code class="highlighter-rouge">*.exe</code> file)<li><code class="highlighter-rouge">MakeBootstrapper.bat</code> - Batch script to compile <code class="highlighter-rouge">Bootstrapper.wxs</code> file<li><code class="highlighter-rouge">myAppSetup.msi</code> - Example of <code class="highlighter-rouge">.msi</code> installer file for my app installation<li><code class="highlighter-rouge">banner.png</code>, <code class="highlighter-rouge">ClassicTheme.wxl</code> &amp; <code class="highlighter-rouge">ClassicTheme.xml</code> - Modified theme for customizing the bootstrapper interface (<a href="https://github.com/heiswayi/wix-msi/tree/master/exe-bootstrapper/bootstrapper_res">Check this GitHub repo for the source code</a>)</ul><h3 id="bootstrapper-source-code">Bootstrapper source code</h3><p><em>Bootstrapper.wxs</em><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Wix</span>
    <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/wix/2006/wi"</span>
    <span class="na">xmlns:bal=</span><span class="s">"http://schemas.microsoft.com/wix/BalExtension"</span>
    <span class="na">xmlns:util=</span><span class="s">"http://schemas.microsoft.com/wix/UtilExtension"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Bundle</span> <span class="na">Name=</span><span class="s">"MiniAppKiller Bundle"</span> 
        <span class="na">Version=</span><span class="s">"!(bind.packageVersion.MainPackage)"</span> 
        <span class="na">Manufacturer=</span><span class="s">"Heiswayi Nrird"</span> 
        <span class="na">UpgradeCode=</span><span class="s">"56888B11-D5D0-4068-8E94-39E696DAD1D4"</span> 
        <span class="na">Copyright=</span><span class="s">"(C) 2018 Heiswayi Nrird"</span> 
        <span class="na">IconSourceFile=</span><span class="s">"images/app.ico"</span> 
        <span class="na">AboutUrl=</span><span class="s">"https://heiswayi.nrird.com"</span>
        <span class="na">Compressed=</span><span class="s">"yes"</span><span class="nt">&gt;</span>
        
        <span class="c">&lt;!-- Layout setup --&gt;</span>
        <span class="nt">&lt;BootstrapperApplicationRef</span> <span class="na">Id=</span><span class="s">"WixStandardBootstrapperApplication.HyperlinkLicense"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;bal:WixStandardBootstrapperApplication</span> 
                <span class="na">LicenseUrl=</span><span class="s">"https://heiswayi.nrird.com"</span>
                <span class="na">LogoFile=</span><span class="s">"bootstrapper_res/banner.png"</span>
                <span class="na">ThemeFile=</span><span class="s">"bootstrapper_res/ClassicTheme.xml"</span>
                <span class="na">LocalizationFile=</span><span class="s">"bootstrapper_res/ClassicTheme.wxl"</span>
                <span class="na">LicenseFile=</span><span class="s">"app\Eula-en.rtf"</span>
                <span class="na">SuppressOptionsUI=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/BootstrapperApplicationRef&gt;</span>

        <span class="nt">&lt;util:RegistrySearch</span> <span class="na">Root=</span><span class="s">"HKLM"</span> 
            <span class="na">Key=</span><span class="s">"SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full"</span> 
            <span class="na">Value=</span><span class="s">"Version"</span> 
            <span class="na">Variable=</span><span class="s">"Net4FullVersion"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;util:RegistrySearch</span> <span class="na">Root=</span><span class="s">"HKLM"</span> 
            <span class="na">Key=</span><span class="s">"SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full"</span> 
            <span class="na">Value=</span><span class="s">"Version"</span> 
            <span class="na">Variable=</span><span class="s">"Net4x64FullVersion"</span> 
            <span class="na">Win64=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
        
        <span class="nt">&lt;Chain</span> <span class="na">DisableSystemRestore=</span><span class="s">"yes"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;ExePackage</span> <span class="na">Id=</span><span class="s">"Net471"</span> 
                <span class="na">Name=</span><span class="s">"Microsoft .NET Framework 4.7.1 Web Installer"</span> 
                <span class="na">Cache=</span><span class="s">"no"</span> 
                <span class="na">Compressed=</span><span class="s">"yes"</span> 
                <span class="na">PerMachine=</span><span class="s">"yes"</span> 
                <span class="na">Permanent=</span><span class="s">"yes"</span> 
                <span class="na">Vital=</span><span class="s">"yes"</span>
                <span class="na">InstallCommand=</span><span class="s">"/passive /norestart"</span>
                <span class="na">SourceFile=</span><span class="s">"prereq\NDP471-KB4033344-Web.exe"</span>
                <span class="na">DetectCondition=</span><span class="s">"(Net4FullVersion = &amp;quot;4.7.2558&amp;quot;) AND (NOT VersionNT64 OR (Net4x64FullVersion = &amp;quot;4.7.2558&amp;quot;))"</span>
                <span class="na">InstallCondition=</span><span class="s">"(VersionNT &gt;= v6.0 OR VersionNT64 &gt;= v6.0) AND (NOT (Net4FullVersion = &amp;quot;4.7.2558&amp;quot; OR Net4x64FullVersion = &amp;quot;4.7.2558&amp;quot;))"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;RollbackBoundary</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;MsiPackage</span> <span class="na">Id=</span><span class="s">"MainPackage"</span> 
                <span class="na">SourceFile=</span><span class="s">"setup-1.0.msi"</span> 
                <span class="na">DisplayInternalUI=</span><span class="s">"yes"</span> 
                <span class="na">Compressed=</span><span class="s">"yes"</span> 
                <span class="na">Vital=</span><span class="s">"yes"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Chain&gt;</span>
    <span class="nt">&lt;/Bundle&gt;</span>
<span class="nt">&lt;/Wix&gt;</span>
</code></pre></div></div><p>For more detailed on other available element properties, please take a look on <a href="http://wixtoolset.org/documentation/manual/v3/xsd/wix/bundle.html">WiX Bundle Element documentation here</a>.<h3 id="batch-script-for-compiling-the-wix-project">Batch script for compiling the WiX project</h3><p>These are the WiX toolset that I use in the script below:-<ul><li><strong>candle.exe</strong> - To generate <code class="highlighter-rouge">*.wixobj</code> file<li><strong>light.exe</strong> - To compile <code class="highlighter-rouge">*.wixobj</code> and generate the bootstrapper file (<code class="highlighter-rouge">*.exe</code>).</ul><p><em>MakeBootstrapper.bat</em><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@echo off

<span class="s2">"%WIX%bin</span><span class="se">\c</span><span class="s2">andle.exe"</span> <span class="s2">"Bootstrapper.wxs"</span> <span class="nt">-out</span> <span class="s2">"_Bootstrapper.wixobj"</span> <span class="nt">-ext</span> WixNetFxExtension <span class="nt">-ext</span> WixBalExtension <span class="nt">-ext</span> WixUtilExtension <span class="nt">-nologo</span>
<span class="s2">"%WIX%bin</span><span class="se">\l</span><span class="s2">ight.exe"</span> <span class="s2">"_Bootstrapper.wixobj"</span> <span class="nt">-out</span> <span class="s2">"Bootstrapper.exe"</span> <span class="nt">-ext</span> WixNetFxExtension <span class="nt">-ext</span> WixBalExtension <span class="nt">-ext</span> WixUtilExtension <span class="nt">-nologo</span>
</code></pre></div></div><h3 id="more-screenshots-of-my-bootstrapper">More screenshots of my bootstrapper</h3><p>Installing the packages <img src="https://i.imgur.com/0dMOkiD.png" alt="Installing the packages" /><p>When user cancelled installation <img src="https://i.imgur.com/3Ou5t8d.png" alt="When user cancelled installtion" /><h3 id="extra-good-readings-and-references">Extra good readings and references</h3><ul><li><a href="http://makemsi-manual.dennisbareis.com/bootstrapper_exe_programs.htm">Windows Installer Basics: Bootstrapper EXE Programs</a><li><a href="https://www.joyofsetup.com/tag/best-practices/">Joy of Setup - Best Practices</a><li><a href="https://www.symantec.com/connect/articles/understanding-difference-between-exe-and-msi">Understanding the Difference Between .EXE and .MSI</a><li><a href="https://www.ghacks.net/2009/03/23/msi-or-exe-setup/">hould you run MSI or EXE Setup files?</a><li>And a lot more… the rest are on Google in case you don’t know :P</ul><div class="tagged"> <a href="https://heiswayi.nrird.com/tagged#wix-toolset"><i class="fa fa-hashtag muted" aria-hidden="true"></i>WiX Toolset</a> <a href="https://heiswayi.nrird.com/tagged#windows-installer"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Windows Installer</a> <a href="https://heiswayi.nrird.com/tagged#msi"><i class="fa fa-hashtag muted" aria-hidden="true"></i>MSI</a></div><div id="disqus" style="margin-top:2em"><div id="disqus_thread"></div><script> var disqus_config = function() { this.page.url = "https://heiswayi.nrird.com/2018/create-msi-bootstrapper-using-wix-burn"; this.page.identifier = "/2018/create-msi-bootstrapper-using-wix-burn"; }; (function() { var d = document, s = d.createElement('script'); s.src = '//hnbloggithub.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="footer"><div class="copyright"><i class="fa fa-copyright"></i> 2015 - 2018 Heiswayi Nrird // <a href="https://heiswayi.nrird.com/cookie-policy">Cookie Policy</a> // <a href="https://heiswayi.github.io/feed.xml">RSS</a></div></div><script> // Line numbering for code block (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-58296043-7', 'auto'); ga('send', 'pageview'); </script>
