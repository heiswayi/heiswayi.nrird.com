<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js" itemscope itemtype="http://schema.org/WebPage"><link href="http://gmpg.org/xfn/11" rel="profile"><meta charset="UTF-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title> Create a basic MSI installer using WiX Toolset · heiswayi nrird •••</title><meta name="description" content=" Here&#39;s how I create a basic MSI installer for my application using Windows Installler XML (WiX) Toolset. Full example source code provided. "/><meta name="keywords" content="wix toolset, windows installer, msi, windows installer xml"><meta name="author" content="Heiswayi Nrird"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta property="og:type" content="article"><meta property="article:author" content="Heiswayi Nrird"><meta property="article:section" content=""><meta property="article:tag" content="wix toolset, windows installer, msi, windows installer xml"><meta property="article:published_time" content="2018-05-27 00:00:00 +0800"><meta property="og:url" content="https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset"><meta property="og:title" content=" Create a basic MSI installer using WiX Toolset · heiswayi nrird ••• "><meta property="og:image" content="https://heiswayi.nrird.com/assets/logo.png"><meta property="og:description" content=" Here&#39;s how I create a basic MSI installer for my application using Windows Installler XML (WiX) Toolset. Full example source code provided. "><meta property="og:site_name" content="Heiswayi Nrird"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@heiswayi"><meta name="twitter:title" content=" Create a basic MSI installer using WiX Toolset · heiswayi nrird ••• "><meta name="twitter:description" content=" Here&#39;s how I create a basic MSI installer for my application using Windows Installler XML (WiX) Toolset. Full example source code provided. "><meta name="twitter:image:src" content="https://heiswayi.nrird.com/assets/logo.png"><meta itemprop="name" content=" Create a basic MSI installer using WiX Toolset · heiswayi nrird ••• "><meta itemprop="description" content=" Here&#39;s how I create a basic MSI installer for my application using Windows Installler XML (WiX) Toolset. Full example source code provided. "><meta itemprop="image" content="https://heiswayi.nrird.com/assets/logo.png"><link rel="canonical" href="https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset"><link rel="alternate" type="application/rss+xml" title="RSS" href="https://heiswayi.nrird.com/feed.xml"><link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="><link rel="stylesheet" href="https://heiswayi.nrird.com/assets/css/main.css?20180603"> <script src="https://heiswayi.nrird.com/assets/js/modernizr.custom.js"></script> <!--[if lt IE 9]> <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script> <script src="https://heiswayi.nrird.com/assets/js/rem.min.js"></script> <![endif]--> <a href="#content" class="skip">Skip to content</a><div class="wrap"><div class="masthead"> <canvas id="canvas" style="width:100%;height:100%;max-height:230px;position:absolute;z-index:1;opacity:0.5"></canvas><div class="container"><h2 class="masthead-title"> <a href="https://heiswayi.nrird.com" title="heiswayi nrird •••" class="title">heiswayi nrird <span class="dot-red">•</span><span class="dot-yellow">•</span><span class="dot-green">•</span></a> <small>Between coding and random stuffs </small></h2><div class="footer-social-links"> <a href="http://heiswayi.github.io/feed.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a> <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a> <!--<a href="https://www.facebook.com/heiswayi.nrird" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>--> <!--<a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>--> <a href="http://heiswayi.github.io/my-repos/" title="GitHub Repositories" target="_blank"><i class="fa fa-github-alt"></i></a> <a href="http://heiswayi.github.io/my-gists/" title="GitHub Gists" target="_blank"><i class="fa fa-code"></i></a> <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a> <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a> <a href="http://jsfiddle.net/user/heiswayi/" title="JSFiddle" target="_blank"><i class="fa fa-jsfiddle"></i></a></div><div class="nav"><ul class="top-menu"><li><a href="https://heiswayi.nrird.com/" title="Home"><i class="fa fa-home"></i></a><li><a href="https://heiswayi.nrird.com/about">About</a> <!--<li><a href="/resume">Resume <i class="fa fa-external-link-square"></i></a>--><li><a href="https://heiswayi.nrird.com/projects" class="bg-red"><i class="fa fa-space-shuttle" aria-hidden="true"></i> Projects</a><li><a href="https://heiswayi.nrird.com/tagged">Tags</a><li><a href="https://heiswayi.github.io/photography">Photography <i class="fa fa-external-link-square"></i></a><li><a href="https://heiswayi.nrird.com/reminder">Reminder</a></ul></div></div></div><div id="content" class="container content"><div class="post"><div class="post-top-meta"> <!--<div class="edit-this-page"><a href="https://github.com/heiswayi/heiswayi.github.io/blob/master/_posts/2018/2018-05-27-create-basic-msi-installer-using-wix-toolset.md">Edit this page</a></div>--><div class="post-date">May 27, 2018</div><h1 class="post-title">Create a basic MSI installer using WiX Toolset</h1></div><p><img src="https://i.imgur.com/9RPzlsd.png" alt="Welcome dialog" /><p>I have been working with Windows-based installation development for some time, and for some software projects that required simple (read: file copy), deployment and no prerequisites installation, I preferred to create a basic <code class="highlighter-rouge">.msi</code> installer. And to do that, my first go-to tool is <a href="http://wixtoolset.org/">WiX Toolset</a>.<p>Windows Installer XML (WiX) Toolset is a Microsoft open source project used to create the Office 2007 installer. WiX includes some advanced capabilities, but it has a steep learning curve even though the scripting language is XML-based. It took me some time to learn both technologies (WiX and Windows Installer itself), but it’s worth spending the time.<p>There are some advantages working with WiX toolset for creating Windows app installer and here are some of them that I can highlight based on my personal experience, in case you are new to WiX toolset:<ul><li>Source code in XML format, better clarity, easy to modify and debug.<li>Fresh clean <code class="highlighter-rouge">.msi</code> installer, no extra stuffs embedded, smaller file size.<li>Everything can be done using command-line, easy to integrated into CI build.<li>Easy to source-control and edit using any code editor.<li>Good community support and a lot of examples. (You get one here too!)</ul><p>Here I would like to share example of my WiX project. Hopefully it could help for those who are looking to get started with WiX toolset, or for those may need to see more examples of WiX-based projects for personal reference.<h3 id="example-of-my-wix-project-files-structure">Example of my WiX project files structure</h3><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;root&gt;
├── app\
|   ├── config.ini
|   ├── Eula-en.rtf
|   ├── filters.txt
|   └── MiniAppKiller.exe
├── images\
|   ├── app.ico
|   ├── Dialog.bmp
|   └── TopBanner.bmp
├── MakeInstaller.bat
├── Product.Loc-en.wxl
├── Product.Var.wxi
└── Poduct.wxs
</code></pre></div></div><p>Folders:<ul><li><code class="highlighter-rouge">app</code> - Contains my application files to be installed<li><code class="highlighter-rouge">images</code> - Contains graphic resource for customizing the installer UI.</ul><p>WiX project files:<ul><li><code class="highlighter-rouge">Product.wxs</code> - Main file<li><code class="highlighter-rouge">Product.Var.wxi</code> - Variables file. Included automatically into the main file during compile time.<li><code class="highlighter-rouge">Product.Loc-en.wxl</code> - Localization file for custom strings used in the main file<li><code class="highlighter-rouge">MakeInstaller.bat</code> - The batch script to compile WiX project files</ul><h3 id="preprocessor-variables-file">Preprocessor variables file</h3><p><em>Product.Var.wxi</em><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Include&gt;</span>
    <span class="c">&lt;!-- #### USER-DEFINED VARIABLES THAT DEFINED DURING BUILD #### --&gt;</span>
    <span class="cp">&lt;?define AppVersion="$(var.BUILD_VERSION)" ?&gt;</span>
    <span class="c">&lt;!-- Upgrade code HAS to be the same for all updates. Once you've chosen it, don't change it. --&gt;</span>
    <span class="cp">&lt;?define UpgradeCode="$(var.BUILD_GUID)" ?&gt;</span>
    <span class="c">&lt;!-- Project directory --&gt;</span>
    <span class="cp">&lt;?define ProjectDir="$(var.BUILD_PROJECTDIR)" ?&gt;</span>

    <span class="c">&lt;!-- #### USER-DEFINED VARIABLES #### --&gt;</span>
    <span class="c">&lt;!-- Set to 1 if you want to enable major upgrade --&gt;</span>
    <span class="cp">&lt;?define EnableMajorUpgrade="1" ?&gt;</span>
    <span class="cp">&lt;?define AppExeName="MiniAppKiller.exe" ?&gt;</span>
    <span class="c">&lt;!-- App Info --&gt;</span>
    <span class="c">&lt;!-- The URL for Add/Remove Programs --&gt;</span>
    <span class="cp">&lt;?define InfoURL="https://heiswayi.nrird.com/" ?&gt;</span>
    <span class="c">&lt;!-- If your app supports both platform (x86 &amp; x64), you have to create separate MSI. --&gt;</span>
    <span class="cp">&lt;?define Platform="x86" ?&gt;</span>
    <span class="c">&lt;!-- App Icon --&gt;</span>
    <span class="cp">&lt;?define AppIconSource="images\app.ico" ?&gt;</span>
    <span class="c">&lt;!-- Other resources --&gt;</span>
    <span class="c">&lt;!-- TopBanner.bmp: 499x58 px --&gt;</span>
    <span class="cp">&lt;?define ImageTopBannerSource="images\TopBanner.bmp" ?&gt;</span>
    <span class="c">&lt;!-- Dialog.bmp: 499x301 px; Graphical area: 165x301 px --&gt;</span>
    <span class="cp">&lt;?define ImageDialogSource="images\Dialog.bmp" ?&gt;</span>
    <span class="c">&lt;!-- GUIDs --&gt;</span>
    <span class="cp">&lt;?define GuidInstallLocation="3F638FF4-C84D-480F-83B8-31CCE0C10617" ?&gt;</span>
    <span class="cp">&lt;?define GuidApplicationShortcut="433B5301-96B9-4FD4-BD86-2A54FB5B9570" ?&gt;</span>
    <span class="cp">&lt;?define GuidApplicationShortcutDesktop="00EA4184-52A8-478D-8A89-47892454B0DD" ?&gt;</span>
    <span class="cp">&lt;?define GuidProductId="9996A526-5535-4DEB-BB56-B4D84BA96E38" ?&gt;</span>

    <span class="c">&lt;!-- #### DO NOT EDIT ANYTHING BELOW THIS LINE #### --&gt;</span>
    <span class="cp">&lt;?if $(var.EnableMajorUpgrade) = 1 ?&gt;</span>
        <span class="cp">&lt;?define ProductId = "*" ?&gt;</span>
    <span class="cp">&lt;?else ?&gt;</span>
        <span class="cp">&lt;?define ProductId = "$(var.GuidProductId)" ?&gt;</span>
    <span class="cp">&lt;?endif ?&gt;</span>
    <span class="cp">&lt;?if $(var.Platform) = x64 ?&gt;</span>
        <span class="cp">&lt;?define Win64 = "yes" ?&gt;</span>
        <span class="cp">&lt;?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?&gt;</span>
        <span class="cp">&lt;?define MainExeSourcePath = "$(var.ProjectDir)\$(var.AppExeName)" ?&gt;</span>
    <span class="cp">&lt;?else ?&gt;</span>
        <span class="cp">&lt;?define Win64 = "no" ?&gt;</span>
        <span class="cp">&lt;?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?&gt;</span>
        <span class="cp">&lt;?define MainExeSourcePath = "$(var.ProjectDir)\$(var.AppExeName)" ?&gt;</span>
    <span class="cp">&lt;?endif ?&gt;</span>
<span class="nt">&lt;/Include&gt;</span>
</code></pre></div></div><p><strong>Note:</strong> <code class="highlighter-rouge">BUILD_VERSION</code>, <code class="highlighter-rouge">BUILD_GUID</code> and <code class="highlighter-rouge">BUILD_PROJECTDIR</code> are preprocessor variables that will be used in <code class="highlighter-rouge">MakeInstaller.bat</code> file to compile the WiX files.<h3 id="main-wix-file">Main WiX file</h3><p>Below is the source code for my main WiX file to create a <code class="highlighter-rouge">.msi</code> installer. In this file, I have combined the code for my installer UI which includes <strong>few custom dialogs</strong>:<ul><li>Custom license agreement dialog<li>Custom upgrade dialog<li>Custom install dir dialog (for Desktop shortcut option checkbox)</ul><p><img src="https://i.imgur.com/FPHfm08.png" alt="Create Desktop shortcut option" /><p>Following are the <strong>extra features other the defaults</strong> that have been implemented into the source code:<ul><li>Detect for minimum .NET Framework and OS version.<li>Detect if newer version is installed, and abort the installation.<li>Detect if older version is installed, show Upgrade Welcome Dialog, and skip License Agreement Dialog.<li>Prompt user to close if the application executable file is running during upgrade.<li>Create registry to memorize the installation directory path.<li>Create Start Menu and Desktop shortcut. Desktop shortcut is optional, user can choose to not create it.</ul><p><em>Product.wxs</em><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="c">&lt;!-- Add xmlns:util namespace definition to be able to use stuff from WixUtilExtension.dll --&gt;</span>
<span class="nt">&lt;Wix</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/wix/2006/wi"</span> <span class="na">xmlns:util=</span><span class="s">"http://schemas.microsoft.com/wix/UtilExtension"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- Include defined variables --&gt;</span>
    <span class="cp">&lt;?include Product.Var.wxi ?&gt;</span>
    <span class="c">&lt;!-- The upgrade code must never change as long as the product lives! --&gt;</span>
    <span class="c">&lt;!-- Product IDs must be autogenerated (*) or else major upgrades will not work --&gt;</span>
    <span class="nt">&lt;Product</span> <span class="na">Id=</span><span class="s">"$(var.ProductId)"</span> <span class="na">Name=</span><span class="s">"!(loc.ApplicationName)"</span> <span class="na">Language=</span><span class="s">"!(loc.Language)"</span> <span class="na">Version=</span><span class="s">"$(var.AppVersion)"</span> <span class="na">Manufacturer=</span><span class="s">"!(loc.ManufacturerName)"</span> <span class="na">UpgradeCode=</span><span class="s">"$(var.UpgradeCode)"</span> <span class="nt">&gt;</span>
        <span class="c">&lt;!-- Package IDs are valid for a single package version only - they are autogenerated by WiX --&gt;</span>
        <span class="c">&lt;!-- Let's require Windows Installer 4.0 (included in Vista) --&gt;</span>
        <span class="c">&lt;!-- And ALWAYS install per machine!!! --&gt;</span>
        <span class="nt">&lt;Package</span> <span class="na">Id=</span><span class="s">"*"</span> <span class="na">InstallerVersion=</span><span class="s">"400"</span> <span class="na">Compressed=</span><span class="s">"yes"</span> <span class="na">InstallPrivileges=</span><span class="s">"elevated"</span> <span class="na">InstallScope=</span><span class="s">"perMachine"</span>  <span class="na">Description=</span><span class="s">"!(loc.ProductDescription)"</span> <span class="na">Comments=</span><span class="s">"!(loc.Comments) $(var.AppVersion)"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- Define icons (ID should not be longer than 18 chars and must end with ".exe") --&gt;</span>
        <span class="nt">&lt;Icon</span> <span class="na">Id=</span><span class="s">"AppIcon.exe"</span> <span class="na">SourceFile=</span><span class="s">"$(var.AppIconSource)"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- We do not have more than one medium (Floppy, CD, ...). Everything in one file. --&gt;</span>
        <span class="nt">&lt;Media</span> <span class="na">Id=</span><span class="s">"1"</span> <span class="na">Cabinet=</span><span class="s">"media1.cab"</span> <span class="na">EmbedCab=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- Upgrade settings --&gt;</span>
        <span class="nt">&lt;Upgrade</span> <span class="na">Id=</span><span class="s">"$(var.UpgradeCode)"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;UpgradeVersion</span> <span class="na">OnlyDetect=</span><span class="s">"yes"</span> <span class="na">Minimum=</span><span class="s">"$(var.AppVersion)"</span> <span class="na">IncludeMinimum=</span><span class="s">"no"</span> <span class="na">Property=</span><span class="s">"NEWER_VERSION_FOUND"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;UpgradeVersion</span> <span class="na">Minimum=</span><span class="s">"0.0.0.0"</span> <span class="na">IncludeMinimum=</span><span class="s">"yes"</span> <span class="na">Maximum=</span><span class="s">"$(var.AppVersion)"</span> <span class="na">IncludeMaximum=</span><span class="s">"no"</span> <span class="na">Property=</span><span class="s">"OLDER_VERSION_FOUND"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/Upgrade&gt;</span>

        <span class="c">&lt;!-- License agreement text: dummy. Real text is set in WXS file --&gt;</span>
        <span class="c">&lt;!--&lt;WixVariable Id="WixUILicenseRtf" Value="dummy" /&gt;--&gt;</span>
        <span class="c">&lt;!-- UI customization --&gt;</span>
        <span class="nt">&lt;WixVariable</span> <span class="na">Id=</span><span class="s">"WixUIBannerBmp"</span> <span class="na">Value=</span><span class="s">"$(var.ImageTopBannerSource)"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;WixVariable</span> <span class="na">Id=</span><span class="s">"WixUIDialogBmp"</span> <span class="na">Value=</span><span class="s">"$(var.ImageDialogSource)"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Binary</span> <span class="na">Id=</span><span class="s">"imageDialog"</span> <span class="na">SourceFile=</span><span class="s">"$(var.ImageDialogSource)"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- Set properties for Add/Remove Programs --&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"ARPPRODUCTICON"</span> <span class="na">Value=</span><span class="s">"AppIcon.exe"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"ARPHELPLINK"</span> <span class="na">Value=</span><span class="s">"$(var.InfoURL)"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- Remove repair --&gt;</span>
        <span class="c">&lt;!--&lt;Property Id="ARPNOREPAIR" Value="yes" Secure="yes" /&gt;--&gt;</span>
        <span class="c">&lt;!-- Remove modify --&gt;</span>
        <span class="c">&lt;!--&lt;Property Id="ARPNOMODIFY" Value="yes" Secure="yes" /&gt;--&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"WIXUI_INSTALLDIR"</span> <span class="na">Value=</span><span class="s">"INSTALLDIR"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"DialogBitmap"</span><span class="nt">&gt;</span>imageDialog<span class="nt">&lt;/Property&gt;</span>
        <span class="c">&lt;!-- Determine the directory of a previous installation (if one exists). If not INSTALLDIR stays empty --&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"INSTALLDIR"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;RegistrySearch</span> <span class="na">Id=</span><span class="s">"DetermineInstallLocation"</span> <span class="na">Type=</span><span class="s">"raw"</span> <span class="na">Root=</span><span class="s">"HKLM"</span> <span class="na">Key=</span><span class="s">"Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)"</span> <span class="na">Name=</span><span class="s">"InstallLocation"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/Property&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"UpgradeDlgHasShown"</span> <span class="na">Value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"ADDDESKTOPSHORTCUT"</span> <span class="na">Value=</span><span class="s">"1"</span><span class="nt">/&gt;</span> 

        <span class="c">&lt;!-- Reference the global NETFRAMEWORK35 property to check if it exists --&gt;</span>
        <span class="nt">&lt;PropertyRef</span> <span class="na">Id=</span><span class="s">"NETFRAMEWORK35"</span><span class="nt">/&gt;</span>    
        <span class="c">&lt;!-- 
        Startup conditions that checks if .Net Framework 3.5 is installed or if 
        we're running the OS higher than Windows XP SP2.
        If not the installation is aborted.
        By doing the (Installed OR ...) property means that this condition will only 
        be evaluated if the app is being installed and not on uninstall or changing
        --&gt;</span>
        <span class="nt">&lt;Condition</span> <span class="na">Message=</span><span class="s">"!(loc.DotNetFrameworkNeeded)"</span><span class="nt">&gt;</span>
            <span class="cp">&lt;![CDATA[Installed OR NETFRAMEWORK35]]&gt;</span>
        <span class="nt">&lt;/Condition&gt;</span>
        <span class="nt">&lt;Condition</span> <span class="na">Message=</span><span class="s">"!(loc.AppNotSupported)"</span><span class="nt">&gt;</span>
            <span class="cp">&lt;![CDATA[Installed OR ((VersionNT &gt;= 501 AND ServicePackLevel &gt;= 2) OR (VersionNT &gt;= 502))]]&gt;</span>
        <span class="nt">&lt;/Condition&gt;</span>

        <span class="c">&lt;!-- Set up ARPINSTALLLOCATION property (http://blogs.technet.com/b/alexshev/archive/2008/02/09/from-msi-to-wix-part-2.aspx) --&gt;</span>
        <span class="nt">&lt;CustomAction</span> <span class="na">Id=</span><span class="s">"SetARPINSTALLLOCATION"</span> <span class="na">Property=</span><span class="s">"ARPINSTALLLOCATION"</span> <span class="na">Value=</span><span class="s">"[INSTALLDIR]"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- Save the command line value INSTALLDIR and restore it later in the sequence or it will be overwritten by the value saved to the registry during an upgrade --&gt;</span>
        <span class="c">&lt;!-- http://robmensching.com/blog/posts/2010/5/2/the-wix-toolsets-remember-property-pattern/ --&gt;</span>
        <span class="nt">&lt;CustomAction</span> <span class="na">Id=</span><span class="s">'SaveCmdLineValueINSTALLDIR'</span> <span class="na">Property=</span><span class="s">'CMDLINE_INSTALLDIR'</span> <span class="na">Value=</span><span class="s">'[INSTALLDIR]'</span> <span class="na">Execute=</span><span class="s">'firstSequence'</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;CustomAction</span> <span class="na">Id=</span><span class="s">'SetFromCmdLineValueINSTALLDIR'</span> <span class="na">Property=</span><span class="s">'INSTALLDIR'</span> <span class="na">Value=</span><span class="s">'[CMDLINE_INSTALLDIR]'</span> <span class="na">Execute=</span><span class="s">'firstSequence'</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;CustomAction</span> <span class="na">Id=</span><span class="s">"NewerVersionFound"</span> <span class="na">Error=</span><span class="s">"!(loc.NewerVersionInstalled)"</span> <span class="nt">/&gt;</span>

        <span class="c">&lt;!-- UI Sequence --&gt;</span>
        <span class="nt">&lt;InstallUISequence&gt;</span>
            <span class="c">&lt;!-- Check for newer versions with FindRelatedProducts and execute the custom action after it --&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">"NewerVersionFound"</span> <span class="na">After=</span><span class="s">"FindRelatedProducts"</span><span class="nt">&gt;</span>
                <span class="cp">&lt;![CDATA[NEWER_VERSION_FOUND]]&gt;</span>
            <span class="nt">&lt;/Custom&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">'SaveCmdLineValueINSTALLDIR'</span> <span class="na">Before=</span><span class="s">'AppSearch'</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">'SetFromCmdLineValueINSTALLDIR'</span> <span class="na">After=</span><span class="s">'AppSearch'</span><span class="nt">&gt;</span>CMDLINE_INSTALLDIR<span class="nt">&lt;/Custom&gt;</span>
        <span class="nt">&lt;/InstallUISequence&gt;</span>
        
        <span class="c">&lt;!-- Exec Sequence --&gt;</span>
        <span class="c">&lt;!-- This is the main installer sequence run when the product is actually installed --&gt;</span>
        <span class="nt">&lt;InstallExecuteSequence&gt;</span>
            <span class="c">&lt;!-- Check for newer versions with FindRelatedProducts and execute the custom action after it --&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">"NewerVersionFound"</span> <span class="na">After=</span><span class="s">"FindRelatedProducts"</span><span class="nt">&gt;</span>
                <span class="cp">&lt;![CDATA[NEWER_VERSION_FOUND]]&gt;</span>
            <span class="nt">&lt;/Custom&gt;</span>
            <span class="c">&lt;!-- Remove the previous versions of the product --&gt;</span>
            <span class="nt">&lt;RemoveExistingProducts</span> <span class="na">After=</span><span class="s">"InstallInitialize"</span><span class="nt">/&gt;</span>
            <span class="c">&lt;!-- WixCloseApplications is a built in custom action that uses util:CloseApplication below --&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">"WixCloseApplications"</span> <span class="na">Before=</span><span class="s">"InstallInitialize"</span> <span class="nt">/&gt;</span>
            <span class="c">&lt;!-- Determine the install location after the install path has been validated by the installer --&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">"SetARPINSTALLLOCATION"</span> <span class="na">After=</span><span class="s">"InstallValidate"</span><span class="nt">&gt;&lt;/Custom&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">'SaveCmdLineValueINSTALLDIR'</span> <span class="na">Before=</span><span class="s">'AppSearch'</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Custom</span> <span class="na">Action=</span><span class="s">'SetFromCmdLineValueINSTALLDIR'</span> <span class="na">After=</span><span class="s">'AppSearch'</span><span class="nt">&gt;</span>CMDLINE_INSTALLDIR<span class="nt">&lt;/Custom&gt;</span>
        <span class="nt">&lt;/InstallExecuteSequence&gt;</span>

        <span class="c">&lt;!-- This will ask the user to close the app if it's running while upgrading --&gt;</span>
        <span class="nt">&lt;util:CloseApplication</span> <span class="na">Id=</span><span class="s">"CloseApp"</span> <span class="na">CloseMessage=</span><span class="s">"no"</span> <span class="na">Description=</span><span class="s">"!(loc.CloseRunningApp)"</span> <span class="na">ElevatedCloseMessage=</span><span class="s">"no"</span> <span class="na">RebootPrompt=</span><span class="s">"no"</span> <span class="na">Target=</span><span class="s">"$(var.AppExeName)"</span> <span class="nt">/&gt;</span>
        
        <span class="c">&lt;!-- Outermost folder (kind of virtual). Fixed entry. --&gt;</span>
        <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"TARGETDIR"</span> <span class="na">Name=</span><span class="s">"SourceDir"</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- We start building our directory structure here --&gt;</span>
            <span class="c">&lt;!-- "ProgramFilesFolder" is a variable containing the absolute path. --&gt;</span>
            <span class="c">&lt;!-- For a list of folder variables, see: http://msdn.microsoft.com/en-us/library/aa372057%28VS.85%29.aspx --&gt;</span>
            <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"$(var.PlatformProgramFilesFolder)"</span><span class="nt">&gt;</span>
                <span class="c">&lt;!-- All folders from here on are relative to their parent. --&gt;</span>
                <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"MyProgramFiles"</span> <span class="na">Name=</span><span class="s">"!(loc.ManufacturerName)"</span><span class="nt">&gt;</span>
                    <span class="c">&lt;!-- INSTALLDIR is a property name. We need it later for the UI (to be able to change the install dir. --&gt;</span>
                    <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"INSTALLDIR"</span> <span class="na">Name=</span><span class="s">"!(loc.ApplicationName)"</span><span class="nt">&gt;&lt;/Directory&gt;</span>
                <span class="nt">&lt;/Directory&gt;</span>
            <span class="nt">&lt;/Directory&gt;</span>
            <span class="c">&lt;!-- Registry entries --&gt;</span>
            <span class="nt">&lt;Component</span> <span class="na">Id=</span><span class="s">"RegValInstallLocation_comp"</span> <span class="na">Guid=</span><span class="s">"$(var.GuidInstallLocation)"</span><span class="nt">&gt;</span>
                <span class="c">&lt;!-- Do NOT use the application's default registry key here, because THIS key will be removed on uninstall
                 (important when installing a newer version, because that is uninstall followed by install) --&gt;</span>
                <span class="nt">&lt;RegistryKey</span> <span class="na">Root=</span><span class="s">"HKLM"</span> <span class="na">Key=</span><span class="s">"Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;RegistryValue</span> <span class="na">Name=</span><span class="s">"InstallLocation"</span> <span class="na">Value=</span><span class="s">"[INSTALLDIR]"</span> <span class="na">Type=</span><span class="s">"string"</span> <span class="na">KeyPath=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;/RegistryKey&gt;</span>
            <span class="nt">&lt;/Component&gt;</span>
            <span class="c">&lt;!-- Shortcut folders --&gt;</span>
            <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"ProgramMenuFolder"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"ApplicationProgramsFolder"</span> <span class="na">Name=</span><span class="s">"!(loc.ApplicationName)"</span> <span class="nt">/&gt;&lt;/Directory&gt;</span>
            <span class="nt">&lt;Directory</span> <span class="na">Id=</span><span class="s">"DesktopFolder"</span> <span class="na">Name=</span><span class="s">"Desktop"</span><span class="nt">&gt;&lt;/Directory&gt;</span>
        <span class="nt">&lt;/Directory&gt;</span>
        <span class="c">&lt;!-- Shortcut components --&gt;</span>
        <span class="nt">&lt;DirectoryRef</span> <span class="na">Id=</span><span class="s">"ApplicationProgramsFolder"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Component</span> <span class="na">Id=</span><span class="s">"ApplicationShortcut"</span> <span class="na">Guid=</span><span class="s">"$(var.GuidApplicationShortcut)"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Shortcut</span> <span class="na">Id=</span><span class="s">"ApplicationStartMenuShortcut"</span> <span class="na">Name=</span><span class="s">"!(loc.ApplicationName)"</span> <span class="na">Description=</span><span class="s">"!(loc.ProductDescription)"</span> <span class="na">Target=</span><span class="s">"[INSTALLDIR]$(var.AppExeName)"</span> <span class="na">WorkingDirectory=</span><span class="s">"INSTALLFOLDER"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;RemoveFolder</span> <span class="na">Id=</span><span class="s">"RemoveApplicationProgramsFolder"</span> <span class="na">Directory=</span><span class="s">"ApplicationProgramsFolder"</span> <span class="na">On=</span><span class="s">"uninstall"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;RegistryValue</span> <span class="na">Root=</span><span class="s">"HKCU"</span> <span class="na">Key=</span><span class="s">"Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)"</span> <span class="na">Name=</span><span class="s">"installed"</span> <span class="na">Type=</span><span class="s">"integer"</span> <span class="na">Value=</span><span class="s">"1"</span> <span class="na">KeyPath=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/Component&gt;</span>
        <span class="nt">&lt;/DirectoryRef&gt;</span>
        <span class="nt">&lt;DirectoryRef</span> <span class="na">Id=</span><span class="s">"DesktopFolder"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Component</span> <span class="na">Id=</span><span class="s">"ApplicationShortcutDesktop"</span> <span class="na">Guid=</span><span class="s">"$(var.GuidApplicationShortcutDesktop)"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Shortcut</span> <span class="na">Id=</span><span class="s">"ApplicationDesktopShortcut"</span> <span class="na">Name=</span><span class="s">"!(loc.ApplicationName)"</span> <span class="na">Description=</span><span class="s">"!(loc.ProductDescription)"</span> <span class="na">Target=</span><span class="s">"[INSTALLDIR]$(var.AppExeName)"</span> <span class="na">WorkingDirectory=</span><span class="s">"INSTALLFOLDER"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;RemoveFolder</span> <span class="na">Id=</span><span class="s">"RemoveDesktopFolder"</span> <span class="na">Directory=</span><span class="s">"DesktopFolder"</span> <span class="na">On=</span><span class="s">"uninstall"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;RegistryValue</span> <span class="na">Root=</span><span class="s">"HKCU"</span> <span class="na">Key=</span><span class="s">"Software\!(loc.ManufacturerName)\InstalledProducts\!(loc.ApplicationName)"</span> <span class="na">Name=</span><span class="s">"installed"</span> <span class="na">Type=</span><span class="s">"integer"</span> <span class="na">Value=</span><span class="s">"1"</span> <span class="na">KeyPath=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Condition&gt;</span>ADDDESKTOPSHORTCUT<span class="nt">&lt;/Condition&gt;</span>
            <span class="nt">&lt;/Component&gt;</span>
        <span class="nt">&lt;/DirectoryRef&gt;</span>
        <span class="c">&lt;!-- Features define which parts of the application can be installed in a custom installation --&gt;</span>
        <span class="nt">&lt;Feature</span> <span class="na">Id=</span><span class="s">"Complete"</span> <span class="na">Title=</span><span class="s">"!(loc.ApplicationName)"</span> <span class="na">Description=</span><span class="s">"!(loc.FeatureCompleteDescription)"</span> <span class="na">Display=</span><span class="s">"expand"</span> <span class="na">Level=</span><span class="s">"1"</span> <span class="na">ConfigurableDirectory=</span><span class="s">"INSTALLDIR"</span><span class="nt">&gt;</span>
            <span class="c">&lt;!-- A feature block for the main (GUI) program and all its dependencies --&gt;</span>
            <span class="nt">&lt;Feature</span> <span class="na">Id=</span><span class="s">"MainProgram"</span> <span class="na">Title=</span><span class="s">"!(loc.FeatureMainProgramTitle)"</span> <span class="na">Description=</span><span class="s">"!(loc.FeatureMainProgramDescription)"</span> <span class="na">Level=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                <span class="c">&lt;!-- Installation folder: Generated automatically by heat.exe --&gt;</span>
                <span class="nt">&lt;ComponentGroupRef</span> <span class="na">Id=</span><span class="s">"INSTALLDIR_comp"</span> <span class="nt">/&gt;</span>
                <span class="c">&lt;!-- Registry entries --&gt;</span>
                <span class="nt">&lt;ComponentRef</span> <span class="na">Id=</span><span class="s">"RegValInstallLocation_comp"</span> <span class="nt">/&gt;</span>
                <span class="c">&lt;!-- Shortcuts --&gt;</span>
                <span class="nt">&lt;ComponentRef</span> <span class="na">Id=</span><span class="s">"ApplicationShortcut"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;ComponentRef</span> <span class="na">Id=</span><span class="s">"ApplicationShortcutDesktop"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/Feature&gt;</span>
        <span class="nt">&lt;/Feature&gt;</span>
        <span class="nt">&lt;UI</span> <span class="na">Id=</span><span class="s">"MyWixUI"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;TextStyle</span> <span class="na">Id=</span><span class="s">"WixUI_Font_Normal"</span> <span class="na">FaceName=</span><span class="s">"Tahoma"</span> <span class="na">Size=</span><span class="s">"8"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;TextStyle</span> <span class="na">Id=</span><span class="s">"WixUI_Font_Bigger"</span> <span class="na">FaceName=</span><span class="s">"Tahoma"</span> <span class="na">Size=</span><span class="s">"12"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;TextStyle</span> <span class="na">Id=</span><span class="s">"WixUI_Font_Title"</span> <span class="na">FaceName=</span><span class="s">"Tahoma"</span> <span class="na">Size=</span><span class="s">"9"</span> <span class="na">Bold=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"DefaultUIFont"</span> <span class="na">Value=</span><span class="s">"WixUI_Font_Normal"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">"WixUI_Mode"</span> <span class="na">Value=</span><span class="s">"InstallDir"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"BrowseDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"DiskCostDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"ErrorDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"FatalError"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"FilesInUse"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"MsiRMFilesInUse"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"PrepareDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"ProgressDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"ResumeDlg"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;DialogRef</span> <span class="na">Id=</span><span class="s">"UserExit"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Dialog</span> <span class="na">Id=</span><span class="s">"CustomLicenseAgreementDlg"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"270"</span> <span class="na">Title=</span><span class="s">"!(loc.LicenseAgreementDlg_Title)"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"LicenseAcceptedCheckBox"</span> <span class="na">Type=</span><span class="s">"CheckBox"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"207"</span> <span class="na">Width=</span><span class="s">"330"</span> <span class="na">Height=</span><span class="s">"18"</span> <span class="na">CheckBoxValue=</span><span class="s">"1"</span> <span class="na">Property=</span><span class="s">"LicenseAccepted"</span> <span class="na">Text=</span><span class="s">"!(loc.LicenseAgreementDlgLicenseAcceptedCheckBox)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Back"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"180"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUIBack)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Next"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"236"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Default=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUINext)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"SpawnWaitDialog"</span> <span class="na">Value=</span><span class="s">"WaitForCostingDlg"</span><span class="nt">&gt;</span>CostingComplete = 1<span class="nt">&lt;/Publish&gt;</span>
                    <span class="nt">&lt;Condition</span> <span class="na">Action=</span><span class="s">"disable"</span><span class="nt">&gt;</span>
                        <span class="cp">&lt;![CDATA[LicenseAccepted &lt;&gt; "1"]]&gt;</span>
                    <span class="nt">&lt;/Condition&gt;</span>
                    <span class="nt">&lt;Condition</span> <span class="na">Action=</span><span class="s">"enable"</span><span class="nt">&gt;</span>LicenseAccepted = "1"<span class="nt">&lt;/Condition&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Cancel"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"304"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Cancel=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUICancel)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"CancelDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BannerBitmap"</span> <span class="na">Type=</span><span class="s">"Bitmap"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"0"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"44"</span> <span class="na">TabSkip=</span><span class="s">"no"</span> <span class="na">Text=</span><span class="s">"!(loc.LicenseAgreementDlgBannerBitmap)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"LicenseText"</span> <span class="na">Type=</span><span class="s">"ScrollableText"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"60"</span> <span class="na">Width=</span><span class="s">"330"</span> <span class="na">Height=</span><span class="s">"140"</span> <span class="na">Sunken=</span><span class="s">"yes"</span> <span class="na">TabSkip=</span><span class="s">"no"</span><span class="nt">&gt;</span>
                    <span class="c">&lt;!-- This is the original line --&gt;</span>
                    <span class="c">&lt;!--&lt;Text SourceFile="!(wix.WixUILicenseRtf=$(var.LicenseRtf))" /&gt;--&gt;</span>
                    <span class="c">&lt;!-- To enable EULA localization we change it to this: --&gt;</span>
                    <span class="nt">&lt;Text</span> <span class="na">SourceFile=</span><span class="s">"$(var.ProjectDir)\!(loc.LicenseRtf)"</span> <span class="nt">/&gt;</span>
                    <span class="c">&lt;!-- In each of the localization files (wxl) put a line like this:
            &lt;String Id="LicenseRtf" Overridable="yes"&gt;EULA_en-us.rtf&lt;/String&gt;--&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Print"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"112"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUIPrint)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"DoAction"</span> <span class="na">Value=</span><span class="s">"WixUIPrintEula"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BannerLine"</span> <span class="na">Type=</span><span class="s">"Line"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"44"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BottomLine"</span> <span class="na">Type=</span><span class="s">"Line"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"234"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Description"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"25"</span> <span class="na">Y=</span><span class="s">"23"</span> <span class="na">Width=</span><span class="s">"340"</span> <span class="na">Height=</span><span class="s">"15"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.LicenseAgreementDlgDescription)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Title"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"15"</span> <span class="na">Y=</span><span class="s">"6"</span> <span class="na">Width=</span><span class="s">"200"</span> <span class="na">Height=</span><span class="s">"15"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.LicenseAgreementDlgTitle)"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/Dialog&gt;</span>

            <span class="nt">&lt;Dialog</span> <span class="na">Id=</span><span class="s">"CustomUpgradeDlg"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"270"</span> <span class="na">Title=</span><span class="s">"!(loc.UpgradeWelcomeDlgTitle)"</span> <span class="na">NoMinimize=</span><span class="s">"yes"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Back"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"180"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Disabled=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUIBack)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"WelcomeDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Next"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"236"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Default=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUINext)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"VerifyReadyDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Property=</span><span class="s">"UpgradeDlgHasShown"</span> <span class="na">Value=</span><span class="s">"1"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Cancel"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"304"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Cancel=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUICancel)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"CancelDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Bitmap"</span> <span class="na">Type=</span><span class="s">"Bitmap"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"0"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"234"</span> <span class="na">TabSkip=</span><span class="s">"no"</span> <span class="na">Text=</span><span class="s">"[DialogBitmap]"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BottomLine"</span> <span class="na">Type=</span><span class="s">"Line"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"234"</span> <span class="na">Width=</span><span class="s">"374"</span> <span class="na">Height=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Description"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"135"</span> <span class="na">Y=</span><span class="s">"70"</span> <span class="na">Width=</span><span class="s">"220"</span> <span class="na">Height=</span><span class="s">"30"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Text&gt;</span>!(loc.UpgradeWelcomeDlgMessage)<span class="nt">&lt;/Text&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Title"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"135"</span> <span class="na">Y=</span><span class="s">"20"</span> <span class="na">Width=</span><span class="s">"220"</span> <span class="na">Height=</span><span class="s">"60"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Text&gt;</span>{\WixUI_Font_Bigger}!(loc.UpgradeWelcomeDlgHeaderTitle)<span class="nt">&lt;/Text&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>
            <span class="nt">&lt;/Dialog&gt;</span>

            <span class="nt">&lt;Dialog</span> <span class="na">Id=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"270"</span> <span class="na">Title=</span><span class="s">"!(loc.InstallDirDlg_Title)"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Next"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"236"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Default=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUINext)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Back"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"180"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUIBack)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Cancel"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"304"</span> <span class="na">Y=</span><span class="s">"243"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Cancel=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.WixUICancel)"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Publish</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"CancelDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
                <span class="nt">&lt;/Control&gt;</span>

                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Description"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"25"</span> <span class="na">Y=</span><span class="s">"23"</span> <span class="na">Width=</span><span class="s">"280"</span> <span class="na">Height=</span><span class="s">"15"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.InstallDirDlgDescription)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Title"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"15"</span> <span class="na">Y=</span><span class="s">"6"</span> <span class="na">Width=</span><span class="s">"200"</span> <span class="na">Height=</span><span class="s">"15"</span> <span class="na">Transparent=</span><span class="s">"yes"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.InstallDirDlgTitle)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BannerBitmap"</span> <span class="na">Type=</span><span class="s">"Bitmap"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"0"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"44"</span> <span class="na">TabSkip=</span><span class="s">"no"</span> <span class="na">Text=</span><span class="s">"!(loc.InstallDirDlgBannerBitmap)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BannerLine"</span> <span class="na">Type=</span><span class="s">"Line"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"44"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"BottomLine"</span> <span class="na">Type=</span><span class="s">"Line"</span> <span class="na">X=</span><span class="s">"0"</span> <span class="na">Y=</span><span class="s">"234"</span> <span class="na">Width=</span><span class="s">"370"</span> <span class="na">Height=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>

                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"FolderLabel"</span> <span class="na">Type=</span><span class="s">"Text"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"60"</span> <span class="na">Width=</span><span class="s">"290"</span> <span class="na">Height=</span><span class="s">"30"</span> <span class="na">NoPrefix=</span><span class="s">"yes"</span> <span class="na">Text=</span><span class="s">"!(loc.InstallDirDlgFolderLabel)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"Folder"</span> <span class="na">Type=</span><span class="s">"PathEdit"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"100"</span> <span class="na">Width=</span><span class="s">"320"</span> <span class="na">Height=</span><span class="s">"18"</span> <span class="na">Property=</span><span class="s">"WIXUI_INSTALLDIR"</span> <span class="na">Indirect=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"ChangeFolder"</span> <span class="na">Type=</span><span class="s">"PushButton"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"120"</span> <span class="na">Width=</span><span class="s">"56"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Text=</span><span class="s">"!(loc.InstallDirDlgChange)"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Control</span> <span class="na">Id=</span><span class="s">"DesktopShortcutCheckBox"</span> <span class="na">Type=</span><span class="s">"CheckBox"</span> <span class="na">X=</span><span class="s">"20"</span> <span class="na">Y=</span><span class="s">"160"</span> <span class="na">Width=</span><span class="s">"290"</span> <span class="na">Height=</span><span class="s">"17"</span> <span class="na">Property=</span><span class="s">"ADDDESKTOPSHORTCUT"</span> <span class="na">CheckBoxValue=</span><span class="s">"1"</span> <span class="na">Text=</span><span class="s">"!(loc.CreateDesktopShortcutCheckboxText)"</span><span class="nt">/&gt;</span> 
            <span class="nt">&lt;/Dialog&gt;</span>

            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"WelcomeDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomLicenseAgreementDlg"</span><span class="nt">&gt;</span>NOT Installed<span class="nt">&lt;/Publish&gt;</span>

            <span class="c">&lt;!--&lt;Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg"&gt;(Installed AND PATCH) OR WIX_UPGRADE_DETECTED&lt;/Publish&gt;--&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"WelcomeDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomUpgradeDlg"</span><span class="nt">&gt;</span>(Installed AND PATCH) OR OLDER_VERSION_FOUND<span class="nt">&lt;/Publish&gt;</span>

            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomLicenseAgreementDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"WelcomeDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomLicenseAgreementDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomInstallDirDlg"</span><span class="nt">&gt;</span>LicenseAccepted = "1"<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomLicenseAgreementDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"SetTargetPath"</span> <span class="na">Value=</span><span class="s">"[WIXUI_INSTALLDIR]"</span> <span class="na">Order=</span><span class="s">"1"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"DoAction"</span> <span class="na">Value=</span><span class="s">"WixUIValidatePath"</span> <span class="na">Order=</span><span class="s">"2"</span><span class="nt">&gt;</span>NOT WIXUI_DONTVALIDATEPATH<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"InvalidDirDlg"</span> <span class="na">Order=</span><span class="s">"3"</span><span class="nt">&gt;</span>
                <span class="cp">&lt;![CDATA[NOT WIXUI_DONTVALIDATEPATH AND WIXUI_INSTALLDIR_VALID&lt;&gt;"1"]]&gt;</span>
            <span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"VerifyReadyDlg"</span> <span class="na">Order=</span><span class="s">"4"</span><span class="nt">&gt;</span>WIXUI_DONTVALIDATEPATH OR WIXUI_INSTALLDIR_VALID="1"<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"ChangeFolder"</span> <span class="na">Property=</span><span class="s">"_BrowseProperty"</span> <span class="na">Value=</span><span class="s">"[WIXUI_INSTALLDIR]"</span> <span class="na">Order=</span><span class="s">"1"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"ChangeFolder"</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"BrowseDlg"</span> <span class="na">Order=</span><span class="s">"2"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"VerifyReadyDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"BrowseDlg"</span> <span class="na">Control=</span><span class="s">"OK"</span> <span class="na">Event=</span><span class="s">"DoAction"</span> <span class="na">Value=</span><span class="s">"WixUIValidatePath"</span> <span class="na">Order=</span><span class="s">"3"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"BrowseDlg"</span> <span class="na">Control=</span><span class="s">"OK"</span> <span class="na">Event=</span><span class="s">"SpawnDialog"</span> <span class="na">Value=</span><span class="s">"InvalidDirDlg"</span> <span class="na">Order=</span><span class="s">"4"</span><span class="nt">&gt;</span>
                <span class="cp">&lt;![CDATA[WIXUI_INSTALLDIR_VALID&lt;&gt;"1"]]&gt;</span>
            <span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"VerifyReadyDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomInstallDirDlg"</span> <span class="na">Order=</span><span class="s">"1"</span><span class="nt">&gt;</span>NOT Installed<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"VerifyReadyDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"MaintenanceTypeDlg"</span> <span class="na">Order=</span><span class="s">"2"</span><span class="nt">&gt;</span>Installed<span class="nt">&lt;/Publish&gt;</span>
            
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"VerifyReadyDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"CustomUpgradeDlg"</span> <span class="na">Order=</span><span class="s">"2"</span><span class="nt">&gt;</span>UpgradeDlgHasShown = "1"<span class="nt">&lt;/Publish&gt;</span>

            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"MaintenanceWelcomeDlg"</span> <span class="na">Control=</span><span class="s">"Next"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"MaintenanceTypeDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"MaintenanceTypeDlg"</span> <span class="na">Control=</span><span class="s">"RepairButton"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"VerifyReadyDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"MaintenanceTypeDlg"</span> <span class="na">Control=</span><span class="s">"RemoveButton"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"VerifyReadyDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"MaintenanceTypeDlg"</span> <span class="na">Control=</span><span class="s">"Back"</span> <span class="na">Event=</span><span class="s">"NewDialog"</span> <span class="na">Value=</span><span class="s">"MaintenanceWelcomeDlg"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
            <span class="nt">&lt;Publish</span> <span class="na">Dialog=</span><span class="s">"ExitDialog"</span> <span class="na">Control=</span><span class="s">"Finish"</span> <span class="na">Event=</span><span class="s">"EndDialog"</span> <span class="na">Value=</span><span class="s">"Return"</span> <span class="na">Order=</span><span class="s">"999"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/Publish&gt;</span>
        <span class="nt">&lt;/UI&gt;</span>
        <span class="nt">&lt;UIRef</span> <span class="na">Id=</span><span class="s">"WixUI_Common"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/Product&gt;</span>
<span class="nt">&lt;/Wix&gt;</span>
</code></pre></div></div><p>Example of license agreement dialog <img src="https://i.imgur.com/sXeMVyS.png" alt="License agreement dialog" /><p>Example of upgrade welcome dialog when found existing version already installed <img src="https://i.imgur.com/WaHqBhg.png" alt="Upgrade welcome dialog" /><h3 id="localization-file">Localization file</h3><p><em>Product.Loc-en.wxl</em><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;WixLocalization</span> <span class="na">Culture=</span><span class="s">"en-us"</span> <span class="na">Codepage=</span><span class="s">"1252"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/wix/2006/localization"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"Language"</span><span class="nt">&gt;</span>1033<span class="nt">&lt;/String&gt;</span>
    <span class="c">&lt;!-- Supported language and codepage codes can be found here: http://www.tramontana.co.hu/wix/lesson2.php#2.4 --&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"ApplicationName"</span><span class="nt">&gt;</span>MiniAppKiller<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"ManufacturerName"</span><span class="nt">&gt;</span>Heiswayi Nrird<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"ProductDescription"</span><span class="nt">&gt;</span>Process killer<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"Comments"</span><span class="nt">&gt;</span>Installs MiniAppKiller<span class="nt">&lt;/String&gt;</span>

    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"LicenseRtf"</span> <span class="na">Overridable=</span><span class="s">"yes"</span><span class="nt">&gt;</span>Eula-en.rtf<span class="nt">&lt;/String&gt;</span>

    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"AppNotSupported"</span><span class="nt">&gt;</span>This application is is not supported on your current OS. Minimal OS supported is Windows XP SP2<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"DotNetFrameworkNeeded"</span><span class="nt">&gt;</span>.NET Framework 3.5 is required. Please install the .NET Framework then run this installer again.<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"NewerVersionInstalled"</span><span class="nt">&gt;</span>A newer version of !(loc.ApplicationName) is already installed.<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"CloseRunningApp"</span><span class="nt">&gt;</span>!(loc.ApplicationName) is running. You need to close it first!<span class="nt">&lt;/String&gt;</span>

    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"FeatureCompleteDescription"</span><span class="nt">&gt;</span>The complete package.<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"FeatureMainProgramDescription"</span><span class="nt">&gt;</span>The main version including all dependencies.<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"FeatureMainProgramTitle"</span><span class="nt">&gt;</span>Main program<span class="nt">&lt;/String&gt;</span>

    <span class="c">&lt;!--&lt;String Id="LicenseAgreementDlgLicenseAcceptedCheckBox"&gt;Agree&lt;/String&gt;--&gt;</span>

    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"UpgradeWelcomeDlgTitle"</span><span class="nt">&gt;</span>!(loc.ApplicationName) Setup<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"UpgradeWelcomeDlgHeaderTitle"</span><span class="nt">&gt;</span>A previous version of !(loc.ApplicationName) is detected<span class="nt">&lt;/String&gt;</span>
    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"UpgradeWelcomeDlgMessage"</span><span class="nt">&gt;</span>The setup will perform an upgrade of !(loc.ApplicationName). Click Next to proceed with the upgrade or Cancel to exit the setup.<span class="nt">&lt;/String&gt;</span>

    <span class="nt">&lt;String</span> <span class="na">Id=</span><span class="s">"CreateDesktopShortcutCheckboxText"</span><span class="nt">&gt;</span>Create a shortcut on Desktop<span class="nt">&lt;/String&gt;</span>
<span class="nt">&lt;/WixLocalization&gt;</span>
</code></pre></div></div><h3 id="batch-script-for-compiling-the-wix-project">Batch script for compiling the WiX project</h3><p>These are the WiX toolset that I use in the script below:-<ul><li><strong>heat.exe</strong> - To automatically harvest my application files and generate a collection of <code class="highlighter-rouge">&lt;Component&gt;</code> elements and <code class="highlighter-rouge">&lt;ComponentGroup&gt;</code> that will be used in <em>Product.wxs</em> file under <code class="highlighter-rouge">&lt;Feature&gt;</code> element. Output from this tool is <em>Product.Files.wxs</em> file.<li><strong>candle.exe</strong> - To generate <code class="highlighter-rouge">*.wixobj</code> file with some preprocessor variables.<li><strong>light.exe</strong> - To compile <code class="highlighter-rouge">*.wixobj</code> and localization file using WiX extensions and generate <code class="highlighter-rouge">*.msi</code> file.</ul><p><em>MakeInstaller.bat</em><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@echo off

<span class="nb">set </span><span class="nv">projectDir</span><span class="o">=</span><span class="nb">.</span>

rem Automatically generated fragment file <span class="k">for </span>application files
<span class="s2">"%WIX%bin</span><span class="se">\h</span><span class="s2">eat.exe"</span> dir <span class="s2">"app"</span> <span class="nt">-cg</span> INSTALLDIR_comp <span class="nt">-gg</span> <span class="nt">-scom</span> <span class="nt">-sreg</span> <span class="nt">-sfrag</span> <span class="nt">-srd</span> <span class="nt">-dr</span> INSTALLDIR <span class="nt">-var</span> var.ProjectDir <span class="nt">-out</span> <span class="s2">"Product.Files.wxs"</span>
<span class="s2">"%WIX%bin</span><span class="se">\c</span><span class="s2">andle.exe"</span> <span class="s2">"Product.Files.wxs"</span> <span class="nt">-out</span> <span class="s2">"_Product.Files.wixobj"</span> <span class="nt">-dProjectDir</span><span class="o">=</span><span class="s2">"%projectDir%</span><span class="se">\a</span><span class="s2">pp"</span>

rem Create setup-1.0.msi
<span class="s2">"%WIX%bin</span><span class="se">\c</span><span class="s2">andle.exe"</span> <span class="s2">"Product.wxs"</span> <span class="nt">-out</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-dBUILD_GUID</span><span class="o">=</span><span class="s2">"2BEA883D-BB4C-4A70-B668-88AA54025F5A"</span> <span class="nt">-dBUILD_VERSION</span><span class="o">=</span><span class="s2">"1.0.0.0"</span> <span class="nt">-dBUILD_PROJECTDIR</span><span class="o">=</span><span class="s2">"%projectDir%</span><span class="se">\a</span><span class="s2">pp"</span> <span class="nt">-ext</span> WixUtilExtension <span class="nt">-nologo</span>
<span class="s2">"%WIX%bin</span><span class="se">\l</span><span class="s2">ight.exe"</span> <span class="s2">"_Product.Files.wixobj"</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-loc</span> <span class="s2">"Product.Loc-en.wxl"</span> <span class="nt">-cultures</span>:en-US <span class="nt">-ext</span> WixUtilExtension <span class="nt">-ext</span> WixUIExtension <span class="nt">-ext</span> WixNetFxExtension <span class="nt">-out</span> <span class="s2">"setup-1.0.msi"</span> <span class="nt">-nologo</span>

rem Create setup-1.1.msi
<span class="s2">"%WIX%bin</span><span class="se">\c</span><span class="s2">andle.exe"</span> <span class="s2">"Product.wxs"</span> <span class="nt">-out</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-dBUILD_GUID</span><span class="o">=</span><span class="s2">"2BEA883D-BB4C-4A70-B668-88AA54025F5A"</span> <span class="nt">-dBUILD_VERSION</span><span class="o">=</span><span class="s2">"1.1.0.0"</span> <span class="nt">-dBUILD_PROJECTDIR</span><span class="o">=</span><span class="s2">"%projectDir%</span><span class="se">\a</span><span class="s2">pp"</span> <span class="nt">-ext</span> WixUtilExtension <span class="nt">-nologo</span>
<span class="s2">"%WIX%bin</span><span class="se">\l</span><span class="s2">ight.exe"</span> <span class="s2">"_Product.Files.wixobj"</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-loc</span> <span class="s2">"Product.Loc-en.wxl"</span> <span class="nt">-cultures</span>:en-US <span class="nt">-ext</span> WixUtilExtension <span class="nt">-ext</span> WixUIExtension <span class="nt">-ext</span> WixNetFxExtension <span class="nt">-out</span> <span class="s2">"setup-1.1.msi"</span> <span class="nt">-nologo</span>

rem Create setup-2.0.msi
<span class="s2">"%WIX%bin</span><span class="se">\c</span><span class="s2">andle.exe"</span> <span class="s2">"Product.wxs"</span> <span class="nt">-out</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-dBUILD_GUID</span><span class="o">=</span><span class="s2">"2BEA883D-BB4C-4A70-B668-88AA54025F5A"</span> <span class="nt">-dBUILD_VERSION</span><span class="o">=</span><span class="s2">"2.0.0.0"</span> <span class="nt">-dBUILD_PROJECTDIR</span><span class="o">=</span><span class="s2">"%projectDir%</span><span class="se">\a</span><span class="s2">pp"</span> <span class="nt">-ext</span> WixUtilExtension <span class="nt">-nologo</span>
<span class="s2">"%WIX%bin</span><span class="se">\l</span><span class="s2">ight.exe"</span> <span class="s2">"_Product.Files.wixobj"</span> <span class="s2">"_Product.wixobj"</span> <span class="nt">-loc</span> <span class="s2">"Product.Loc-en.wxl"</span> <span class="nt">-cultures</span>:en-US <span class="nt">-ext</span> WixUtilExtension <span class="nt">-ext</span> WixUIExtension <span class="nt">-ext</span> WixNetFxExtension <span class="nt">-out</span> <span class="s2">"setup-2.0.msi"</span> <span class="nt">-nologo</span>
</code></pre></div></div><p>Here’s the final project files structure after I run <code class="highlighter-rouge">MakeInstaller.bat</code>:<p><img src="https://i.imgur.com/2tFxHpB.png" alt="Project files structure after compile" /><p>Example of my MSI installer in action <img src="https://i.imgur.com/DZAhwKu.png" alt="Installing action" /><h3 id="wix-references">WiX references</h3><p>This project is done based on <strong>WiX v3.11</strong> (<a href="https://github.com/wixtoolset/wix3">GitHub</a>) at the time I’m writing this blog post. If you need to customize your installer UI or to support multiple localizations, you can refer to <a href="https://github.com/wixtoolset/wix3/tree/develop/src/ext/UIExtension/wixlib">this repository</a> on GitHub for the source code references.<div class="tagged"> <a href="https://heiswayi.nrird.com/tagged#wix-toolset"><i class="fa fa-hashtag muted" aria-hidden="true"></i>WiX Toolset</a> <a href="https://heiswayi.nrird.com/tagged#windows-installer"><i class="fa fa-hashtag muted" aria-hidden="true"></i>Windows Installer</a> <a href="https://heiswayi.nrird.com/tagged#msi"><i class="fa fa-hashtag muted" aria-hidden="true"></i>MSI</a></div><div id="disqus" style="margin-top:2em"><div id="disqus_thread"></div><script> var disqus_config = function() { this.page.url = "https://heiswayi.nrird.com/2018/create-basic-msi-installer-using-wix-toolset"; this.page.identifier = "/2018/create-basic-msi-installer-using-wix-toolset"; }; (function() { var d = document, s = d.createElement('script'); s.src = '//hnbloggithub.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="footer"><div class="copyright"><i class="fa fa-copyright"></i> 2015 - 2018 Heiswayi Nrird // <a href="https://heiswayi.nrird.com/cookie-policy">Cookie Policy</a> // <a href="https://heiswayi.github.io/feed.xml">RSS</a></div></div><script> // Line numbering for code block (function() { var pre = document.getElementsByTagName('pre'), pl = pre.length; for (var i = 0; i < pl; i++) { pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>'; var num = pre[i].innerHTML.split(/\n/).length; for (var j = 0; j < (num - 1); j++) { var line_num = pre[i].getElementsByTagName('span')[0]; line_num.innerHTML += '<span>' + (j + 1) + '</span>'; } } })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-58296043-7', 'auto'); ga('send', 'pageview'); </script>
